{"Title": "Citrix Virtual Apps and Desktop 7.x Linux Virtual Delivery Agent Security Technical Implementation Guide", "Description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.", "Version": "1", "Release": "1 ", "BenchmarkDate": "28 Jan 2021", "ReleaseInfo": "Release: 1 Benchmark Date: 28 Jan 2021", "Source": "STIG.DOD.MIL", "Notice": "terms-of-use", "Rules": [{"VulnID": "V-234255", "RuleID": "SV-234255r628796_rule", "StigID": "LVDA-VD-000005", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000001", "RuleTitle": "The application must limit the number of concurrent sessions to three.", "Description": "<VulnDiscussion>Application management includes the ability to control the number of users and user sessions that utilize an application. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to DoS attacks.\n\nThis requirement may be met via the application or by utilizing information system session control provided by a web server with specialized session management capabilities. If it has been specified that this requirement will be handled by the application, the capability to limit the maximum number of concurrent single user sessions must be designed and built into the application. \n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Application management includes the ability to control the number of users and user sessions that utilize an application. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to DoS attacks.\n\nThis requirement may be met via the application or by utilizing information system session control provided by a web server with specialized session management capabilities. If it has been specified that this requirement will be handled by the application, the capability to limit the maximum number of concurrent single user sessions must be designed and built into the application. \n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Open Citrix Studio, select \"Policy Panel\", check for Computer Policies. \n\nMaximum number of sessions (MaximumNumberOfSessions) policy is \"ENABLED\" and explicitly applied to Linux Desktop/Application Delivery Groups.\n\nIf Maximum Number of Sessions policy is \"DISABLED\" or limit not set to \"3\", this is a finding.", "FixText": "Open Citrix Studio, select \"Policy Panel\", check for Computer Policies.\n\nMaximum number of sessions (MaximumNumberOfSessions) policy set to \"ENABLED\" and limit set to \"3\".", "CCI": "CCI-000054"}, {"VulnID": "V-234256", "RuleID": "SV-234256r628796_rule", "StigID": "LVDA-VD-000015", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000003", "RuleTitle": "The application must initiate a session lock after a 15-minute period of inactivity.", "Description": "<VulnDiscussion>A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their application session prior to vacating the vicinity, applications need to be able to identify when a user's application session has idled and take action to initiate the session lock.\n\nThe session lock is implemented at the point where session activity can be determined and/or controlled. This is typically at the operating system-level and results in a system lock, but may be at the application-level where the application interface window is secured instead.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their application session prior to vacating the vicinity, applications need to be able to identify when a user's application session has idled and take action to initiate the session lock.\n\nThe session lock is implemented at the point where session activity can be determined and/or controlled. This is typically at the operating system-level and results in a system lock, but may be at the application-level where the application interface window is secured instead.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "All timer values are defined in the registration table. Retrieve current value using the following command:\n\n/opt/Citrix/VDA/bin/ctxreg,\n\n/opt/Citrix/VDA/bin/ctxreg dump |grep MaxIdleTime\n\nIf MaxIdleTime is not set to \"15 minutes\" or less, this is a finding.", "FixText": "Set value for Idle Timer\n/opt/Citrix/VDA/bin/ctxreg update -k \"HKLM\\System\\CurrentControlSet\\Control\\Citrix\\WinStations\\cgp\" -v \"MaxIdleTime\" -d \"0x0000000F\" \n/opt/Citrix/VDA/bin/ctxreg update -k \"HKLM\\System\\CurrentControlSet\\Control\\Citrix\\WinStations\\tcp\" -v \"MaxIdleTime\" -d \"0x0000000F\" \n/opt/Citrix/VDA/bin/ctxreg update -k \"HKLM\\System\\CurrentControlSet\\Control\\Citrix\\WinStations\\ssl\" -v \"MaxIdleTime\" -d \"0x0000000F\" \nwhere \"0x0000000F\" is hexadecimal for 15", "CCI": "CCI-000057"}, {"VulnID": "V-234257", "RuleID": "SV-234257r628796_rule", "StigID": "LVDA-VD-000030", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000014", "RuleTitle": "Citrix Linux Virtual Delivery Agent must implement DoD-approved encryption.", "Description": "<VulnDiscussion>Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session. \n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. \n \nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection thereby providing a degree of confidentiality. The encryption strength of mechanism is selected based on the security categorization of the information.\n\nSatisfies: SRG-APP-000014, SRG-APP-000015, SRG-APP-000039, SRG-APP-000219, SRG-APP-000439, SRG-APP-000440, SRG-APP-000441, SRG-APP-000442</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session. \n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. \n \nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection thereby providing a degree of confidentiality. The encryption strength of mechanism is selected based on the security categorization of the information.\n\nSatisfies: SRG-APP-000014, SRG-APP-000015, SRG-APP-000039, SRG-APP-000219, SRG-APP-000439, SRG-APP-000440, SRG-APP-000441, SRG-APP-000442", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "On the Delivery Controller, ensure the SSL encryption has been enabled for the delivery group (HdxSslEnabled:True) and the Delivery Controller uses FQDN of Linux VDA to contact target Linux VDA (DnsResolutionEnabled:True). \n\nExecute the following commands in a PowerShell window on the Delivery Controller:\n# Asnp citrix.*\n# Get-BrokerAccessPolicyRule \u2013DesktopGroupName \u2018<GROUPNAME>\u2019 | format-list HdxSslEnabled\nWhere <GROUPNAME> is the target Delivery Group name.\n\nOn Linux VDA, check the following:\nCheck if SSL listener is up and running; run following command: \n# netstat -lptn|grep ctxhdx\nto see that the ctxhdx process is listening on an SSL port (443, by default).\n\nIf, on the Delivery Controller, HdxSslEnabled is not set to \"true\", this is a finding. \nIf, on the Delivery Controller, DnsResolutionEnabled is not set to \"true\", this is a finding.\nIf, on the Linux VDS, the ctxhdx process is not listening on an SSL port (443 by default, or other approved port), this is a finding.", "FixText": "To enable TLS encryption on the Linux VDA, a server certificate must be installed on the Citrix Broker (DDC), each Linux VDA server and root certificates must be installed on each Linux VDA server and client per DoD guidelines.\nOn the Linux VDA, use the enable_vdassl.sh tool to enable (or disable) TLS encryption. The tool is located in the /opt/Citrix/VDA/sbin directory. For information about options available in the tool, run the /opt/Citrix/VDA/sbin/enable_vdassl.sh -help command.\n\nTo enable TLS 1.2 on Linux VDA OS - # /opt/Citrix/VDA/bin/ctxreg update -k \"HKLM\\System\\CurrentControlSet\\Control\\Citrix\\WinStations\\ssl\" -v \"SSLMinVersion\" -d 0x00000004\nTo enable GOV ciphersuites only:\n# /opt/Citrix/VDA/bin/ctxreg update -k \"HKLM\\System\\CurrentControlSet\\Control\\Citrix\\WinStations\\ssl\" -v \"SSLCipherSuite\" -d 0x00000001\nthes restart service\n# sudo /sbin/service ctxhdx restart \n[root@ LVDA]# sudo /sbin/service ctxhdx restart", "CCI": "CCI-000068,CCI-001184,CCI-001414,CCI-001453,CCI-002418,CCI-002420,CCI-002421,CCI-002422"}, {"VulnID": "V-234258", "RuleID": "SV-234258r628796_rule", "StigID": "LVDA-VD-000270", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000141", "RuleTitle": "The application must be configured to disable non-essential capabilities.", "Description": "<VulnDiscussion>It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of non-essential capabilities include, but are not limited to, advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission but cannot be disabled.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of non-essential capabilities include, but are not limited to, advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission but cannot be disabled.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Run the following command on a client to disable the CEIP:\n/opt/Citrix/VDA/bin/ctxreg update -k \"HKEY_LOCAL_MACHINE\\ SOFTWARE\\Citrix\\CEIP\" -v \"CEIPSwitch\" -d \"1\"\n\nIf CEIPSwitch is not set to \"1\", this is a finding.\n\nRun the following command on a client to disable Google Analytics:\n/opt/Citrix/VDA/bin/ctxreg update -k \"HKEY_LOCAL_MACHINE\\ SOFTWARE\\Citrix\\CEIP\" -v \"GASwitch\" -d \"1\"\n\nIf GASwitch is not set to \"1\", this is a finding.", "FixText": "Set the value of CEIPSwitch to \"1\" (Disabled).\n\nSet the value of GASwitch to \"1\" (Disabled).", "CCI": "CCI-000381"}, {"VulnID": "V-234259", "RuleID": "SV-234259r628796_rule", "StigID": "LVDA-VD-000275", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000142", "RuleTitle": "Citrix Linux Virtual Delivery Agent (LVDA) must be configured to prohibit or restrict the use of ports, as defined in the PPSM CAL and vulnerability assessments.", "Description": "<VulnDiscussion>In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "On Delivery Controllers, verify that only approved ports are used. \n\n1. Open a command prompt.\n2. Navigate to the Citrix install directory Program Files\\Citrix\\Broker\\Service\n3. Enter \"BrokerService.exe /Show\" to display the currently used ports.\n\nIf an unapproved port is used, this is a finding.", "FixText": "To change the VDA registration port from the default \"80\", create the Citrix Machine Policy and update the DDCs, as explained below:\n1. Create a new Citrix Machine policy or edit an existing one.\n2. Navigate to the Settings tab and select \"Control Registration Port\".\n3. Update the Value to reflect the new port.\n4. Select \"OK\".\n5. Restart all desktops and wait until all the desktops report as Unregistered.\n6. Update the DDCs VDA registration Port.\n7. Restart all desktops and verify that all VDAs register successfully.", "CCI": "CCI-000382"}, {"VulnID": "V-234260", "RuleID": "SV-234260r628796_rule", "StigID": "LVDA-VD-000970", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000427", "RuleTitle": "Citrix Linux Virtual Delivery Agent must only allow the use of DoD PKI established certificate authorities for verification of the establishment of protected sessions.", "Description": "<VulnDiscussion>Untrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DoD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DoD-approved CA, trust of this CA has not been established.\n\nThe DoD will only accept PKI certificates obtained from a DoD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates. \n\nThis requirement focuses on communications protection for the application session rather than for the network packet.\n\nThis requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Untrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DoD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DoD-approved CA, trust of this CA has not been established.\n\nThe DoD will only accept PKI certificates obtained from a DoD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates. \n\nThis requirement focuses on communications protection for the application session rather than for the network packet.\n\nThis requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Verify the correct server certificate issued by authorized certificate authority is installed on Linux VDA.\nNavigate to folder /root/myCert/myCA/certs/ and examine certificates.\nIf the certificates are not issued by the DoD or approved CA, this is a finding.", "FixText": "A server certificate must be installed on each Linux VDA server and root certificates must be installed on each Linux VDA server and client.\nObtain server certificates in PEM format and root certificates in CRT format from a trusted CA. A server certificate contains the following sections:\n- Certificate\n- Unencrypted private key\n- Intermediate certificates (optional)\n\nAfter obtaining required certificates, customers need to install them as follows:\nUpload server and CA certificates into Linux VDA server, which will be used in \u201cStep 2: Enable SSL encryption on Linux VDA\u201d. For example, put server.pem (name of server certificate) and myca.crt (name of CA certificate) to folder /root/myCert/myCA/certs/.\n\nDownload the CA certificate (myca.crt as an example) to client host and import it into system Certificate Store on the \u201cTrusted Root Certification Authorities\u201d folder. Refer to \"Importing Trusted CA Certificates into the Windows Certificate Store\" for the instructions. Note: Ensure the client host is able to resolve the FQDN of Linux VDA; otherwise, the connection cannot be established.", "CCI": "CCI-002470"}]}