{
    "Title": "VMware Horizon 7.13 Client Security Technical Implementation Guide",
    "Description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.",
    "Version": "1",
    "Release": "1 ",
    "BenchmarkDate": "13 Jul 2021",
    "ReleaseInfo": "Release: 1 Benchmark Date: 13 Jul 2021",
    "Source": "STIG.DOD.MIL",
    "Notice": "terms-of-use",
    "Rules": [
        {
            "VulnID": "V-246875",
            "RuleID": "SV-246875r768585_rule",
            "StigID": "HRZC-7X-000001",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The Horizon Client must not send anonymized usage data.",
            "Description": "<VulnDiscussion>By default, the Horizon Client collects anonymized data from the client systems to help improve software and hardware compatibility. To eliminate any possibility of sensitive DoD configurations being known to unauthorized parties, even when anonymized, this setting must be disabled.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By default, the Horizon Client collects anonymized data from the client systems to help improve software and hardware compatibility. To eliminate any possibility of sensitive DoD configurations being known to unauthorized parties, even when anonymized, this setting must be disabled.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration. Double-click the \"Allow data sharing\" setting.\n\nIf \"Allow data sharing\" is set to \"Enabled\" or \"Not Configured\", this is a finding.",
            "FixText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration. Double-click the \"Allow data sharing\" setting.\n\nMake sure the setting is \"Disabled\". Click \"OK\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-246876",
            "RuleID": "SV-246876r768588_rule",
            "StigID": "HRZC-7X-000002",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The Horizon Client must not connect to servers without fully verifying the server certificate.",
            "Description": "<VulnDiscussion>Preventing the disclosure of transmitted information requires that the application server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission.  This is usually achieved through the use of Transport Layer Security (TLS).\n\nThe Horizon Client connects to the Connection Server, UAG or other gateway via a TLS connection. This initial connection must be trusted, otherwise the sensitive information flowing over the tunnel could potentially be open to interception. The Horizon Client can be configured to ignore any certificate validation errors, warn or fail. By default, the Client will warn and let the user decide to proceed or not. This decision must not be left to the end user. In a properly configured, enterprise environment, there should be no trouble with the presented certificate. On the other hand, a TLS connection could be easily intercepted and middle-manned with the assumption that a user will just click away any errors.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Preventing the disclosure of transmitted information requires that the application server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission.  This is usually achieved through the use of Transport Layer Security (TLS).\n\nThe Horizon Client connects to the Connection Server, UAG or other gateway via a TLS connection. This initial connection must be trusted, otherwise the sensitive information flowing over the tunnel could potentially be open to interception. The Horizon Client can be configured to ignore any certificate validation errors, warn or fail. By default, the Client will warn and let the user decide to proceed or not. This decision must not be left to the end user. In a properly configured, enterprise environment, there should be no trouble with the presented certificate. On the other hand, a TLS connection could be easily intercepted and middle-manned with the assumption that a user will just click away any errors.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Certificate verification mode\".\n\nIf \"Certificate verification mode\" is \"Not Configured\" or \"Disabled\", this is a finding.\n\nIf \"Certificate verification mode\" is not set to \"Full Security\", this is a finding.",
            "FixText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Certificate verification mode\".\n\nMake sure the setting is \"Enabled\".\n\nIn the dropdown below \"Certificate verification mode\", select \"Full Security\". Click \"OK\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-246877",
            "RuleID": "SV-246877r768591_rule",
            "StigID": "HRZC-7X-000003",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The Horizon Client must not show the Log in as current user option.",
            "Description": "<VulnDiscussion>The Horizon Connection Server STIG disabled the \"Log in as current user\" option, for reasons described there. Displaying this option and allowing users to select it would lead to unnecessary confusion and therefore must be disabled.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The Horizon Connection Server STIG disabled the \"Log in as current user\" option, for reasons described there. Displaying this option and allowing users to select it would lead to unnecessary confusion and therefore must be disabled.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Display option to Log in as current user\".\n\nIf \"Display option to Log in as current user\" is not set to \"Disabled\", this is a finding.",
            "FixText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Display option to Log in as current user\".\n\nMake sure the setting is \"Disabled\". Click \"OK\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-246878",
            "RuleID": "SV-246878r768594_rule",
            "StigID": "HRZC-7X-000004",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The Horizon Client must not ignore certificate revocation problems.",
            "Description": "<VulnDiscussion>When the Horizon Client connects to the server, by default, the server TLS certificate will be validated on the client side. If the revocation status cannot be determined or if the certificate is revoked, the connection will fail due to an untrusted connection. This default behavior can be overridden, however, to ignore revocation errors and proceed with revoked or certificates of unknown status. The default, secure, configuration must be validated and maintained.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When the Horizon Client connects to the server, by default, the server TLS certificate will be validated on the client side. If the revocation status cannot be determined or if the certificate is revoked, the connection will fail due to an untrusted connection. This default behavior can be overridden, however, to ignore revocation errors and proceed with revoked or certificates of unknown status. The default, secure, configuration must be validated and maintained.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Ignore certificate revocation problems\".\n\nIf \"Ignore certificate revocation problems\" is set to \"Enabled\", this is a finding.",
            "FixText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Ignore certificate revocation problems\".\n\nMake sure the setting is \"Disabled\". Click \"OK\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-246879",
            "RuleID": "SV-246879r768597_rule",
            "StigID": "HRZC-7X-000005",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The Horizon Client must require TLS connections.",
            "Description": "<VulnDiscussion>In older versions of Horizon, before 5.0, remote desktop connections could be established without TLS encryption. In order to protect data-in-transit when potentially connecting to very old Horizon servers, TLS tunnels must be mandated. The default configuration attempts TLS but will fall back to no encryption if it is not supported. This must be corrected and maintained over time.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "In older versions of Horizon, before 5.0, remote desktop connections could be established without TLS encryption. In order to protect data-in-transit when potentially connecting to very old Horizon servers, TLS tunnels must be mandated. The default configuration attempts TLS but will fall back to no encryption if it is not supported. This must be corrected and maintained over time.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Enable SSL encrypted framework channel\".\n\nIf \"Enable SSL encrypted framework channel\" is set to \"Disabled\" or \"Not Configured\", this is a finding.\n\nIn the dropdown beneath \"Enable SSL encrypted framework channel\", if \"Enforce\" is not selected, this is a finding.",
            "FixText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Enable SSL encrypted framework channel\".\n\nMake sure the setting is \"Enabled\".\n\nIn the dropdown beneath \"Enable SSL encrypted framework channel\", select \"Enforce\". Click \"OK\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-246880",
            "RuleID": "SV-246880r768600_rule",
            "StigID": "HRZC-7X-000006",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The Horizon Client must use approved ciphers.",
            "Description": "<VulnDiscussion>The Horizon Client disables the older TLS v1.0 protocol and the SSL v2 and SSL v3 protocols by default. TLS v1.1 is still enabled in the default configuration, despite known shortcomings, for the sake of backward compatibility with older servers and clients. The Horizon Connection Server STIG mandates TLS v1.2 in order to protect sensitive data-in-flight and the Client must follow suite.\n\nNote: Mandating TLS 1.2 may affect certain thin and zero clients. Test and implement carefully.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The Horizon Client disables the older TLS v1.0 protocol and the SSL v2 and SSL v3 protocols by default. TLS v1.1 is still enabled in the default configuration, despite known shortcomings, for the sake of backward compatibility with older servers and clients. The Horizon Connection Server STIG mandates TLS v1.2 in order to protect sensitive data-in-flight and the Client must follow suite.\n\nNote: Mandating TLS 1.2 may affect certain thin and zero clients. Test and implement carefully.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Configures SSL protocols and cryptographic algorithms\".\n\nIf \"Configures SSL protocols and cryptographic algorithms\" is set to \"Disabled\" or \"Not Configured\", this is a finding.\n\nIf the field beneath \"Configures SSL protocols and cryptographic algorithms\", is not set to \"TLSv1.2:!aNULL:kECDH+AESGCM:ECDH+AESGCM:RSA+AESGCM:kECDH+AES:ECDH+AES:RSA+AES\", this is a finding.",
            "FixText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Configures SSL protocols and cryptographic algorithms\".\n\nMake sure the setting is \"Enabled\".\n\nIn the field beneath \"Configures SSL protocols and cryptographic algorithms\", type the following:\n\nTLSv1.2:!aNULL:kECDH+AESGCM:ECDH+AESGCM:RSA+AESGCM:kECDH+AES:ECDH+AES:RSA+AES\n\nClick \"OK\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-246881",
            "RuleID": "SV-246881r768603_rule",
            "StigID": "HRZC-7X-000007",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The Horizon Client must not allow command line credentials.",
            "Description": "<VulnDiscussion>The Horizon Client has a number of command line options including authentication parameters, by default. This can include a smart card PIN, if so configured by the end user. This would normally be implemented by a script, which would mean plain text sensitive authenticators sitting on disk. Hard coding of credentials of any sort, but especially smart card PINs, must be explicitly disallowed.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The Horizon Client has a number of command line options including authentication parameters, by default. This can include a smart card PIN, if so configured by the end user. This would normally be implemented by a script, which would mean plain text sensitive authenticators sitting on disk. Hard coding of credentials of any sort, but especially smart card PINs, must be explicitly disallowed.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Allow command line credentials\".\n\nIf \"Allow command line credentials\" is \"Not Configured\" or \"Enabled\", this is a finding.",
            "FixText": "Ensure the vdm_agent*.admx templates are added. Open the \"Group Policy Management\" MMC snap-in. Open the site-specific GPO applying Horizon settings to the VDI desktops.\n\nNavigate to Computer Configuration >> Policies >> Administrative Templates >> VMware Horizon Client Configuration >> Security Settings. Double-click \"Allow command line credentials\".\n\nMake sure the setting is \"Disabled\". Click \"OK\".",
            "CCI": "CCI-000366"
        }
    ]
}