{"Title": "Microsoft SCOM Security Technical Implementation Guide", "Description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.", "Version": "1", "Release": "1 ", "BenchmarkDate": "09 Mar 2021", "ReleaseInfo": "Release: 1 Benchmark Date: 09 Mar 2021", "Source": "STIG.DOD.MIL", "Notice": "terms-of-use", "Rules": [{"VulnID": "V-237423", "RuleID": "SV-237423r643915_rule", "StigID": "SCOM-AC-000001", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000317-NDM-000282", "RuleTitle": "Members of the SCOM Administrators Group must be reviewed to ensure access is still required.", "Description": "<VulnDiscussion>When people leave their roles, their group memberships are often times not updated.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "When people leave their roles, their group memberships are often times not updated.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "From Active Directory Users and Computers, search for the group containing SCOM administrators. Review the users who are listed in this group. If any user in this group is no longer with the organization, no longer requires SCOM administration rights, or is no longer in a SCOM administration role within the organization, this is a finding.", "FixText": "From Active Directory Users and Computers, search for the group containing SCOM administrators. Double-click on the group and select the members tab. For each user that no longer needs rights, select the account and click the Remove button. Click OK once finished.", "CCI": "CCI-002142"}, {"VulnID": "V-237424", "RuleID": "SV-237424r643918_rule", "StigID": "SCOM-AC-000002", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000033-NDM-000212", "RuleTitle": "Manually configured SCOM Run As accounts must be set to More Secure distribution.", "Description": "<VulnDiscussion>The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. A SCOM Run As account creates an interactive log on session to perform its tasks. The interactive session could allow an attacker to harvest and reuse these credentials. The SCOM less-secure distribution option configures a Run As account to run on every SCOM agent within the environment, making it easier for an attacker to compromise a critical account. \n\nThe use of the SCOM \"More Secure\" option restricts Run As accounts to specific systems. This restricts a compromised account to a specific set of systems limiting the ability of an attacker to move laterally within the network. A less secure distribution means that if any server running a SCOM agent is compromised, then the accounts credentials may be reused by an attacker.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. A SCOM Run As account creates an interactive log on session to perform its tasks. The interactive session could allow an attacker to harvest and reuse these credentials. The SCOM less-secure distribution option configures a Run As account to run on every SCOM agent within the environment, making it easier for an attacker to compromise a critical account. \n\nThe use of the SCOM \"More Secure\" option restricts Run As accounts to specific systems. This restricts a compromised account to a specific set of systems limiting the ability of an attacker to move laterally within the network. A less secure distribution means that if any server running a SCOM agent is compromised, then the accounts credentials may be reused by an attacker.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Review the account distribution settings on the SCOM Management server.\n\nOpen the Operations Console and select the Administration workspace.\n\nUnder Run As Configuration, select Accounts.\n\nDouble-click on each account listed under the Windows type and select the distribution tab (note that the network system and local system accounts do not need to be checked).\n\nIf any Run As account is set to the \"less secure\" distribution option, this is a finding.", "FixText": "Open the Operations Console and select the Administration workspace.\n\nUnder Run As Configuration, select Accounts.\n\nDouble-click on the account(s) in question. Click the Distribution tab. Click the \"More Secure\" radio button and then click the \"Add\" button next to the green plus sign. In the filter by section, type the computer name(s) for each computer that is required to use the Run As account and click \"Search\". Double-click on the account in the available users section to add it to the selected users section. Click OK when finished.\n\nNote: If the Run As account in question is not assigned to any run-as profile, it is recommended that the Run As account be deleted.", "CCI": "CCI-000213"}, {"VulnID": "V-237425", "RuleID": "SV-237425r643921_rule", "StigID": "SCOM-AC-000003", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000033-NDM-000212", "RuleTitle": "SCOM Run As accounts used to manage Linux/UNIX endpoints must be configured for least privilege.", "Description": "<VulnDiscussion>The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. A SCOM Run As account must only have the level of privileges required to perform the defined SCOM actions. An account with full administrative (SUDO) privileges could be used to breach security boundaries and compromise the endpoint.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. A SCOM Run As account must only have the level of privileges required to perform the defined SCOM actions. An account with full administrative (SUDO) privileges could be used to breach security boundaries and compromise the endpoint.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "If the Microsoft SCOM environment is not used to monitor Linux/UNIX endpoints, this check is Not Applicable.\n\nReview the account permission settings on the SCOM Management server.\n\nLog on to a subset of Linux or UNIX servers being monitored by SCOM and look at the Sudoers file. Verify that the SCOM account does not have Sudo all permissions. Alternatively, the following command can be run from the machine \"sudo -l -U <Run As account Name>\".\n\nIf any Run As account used for Linux\\UNIX endpoint management has the SUDO ALL permissions, this is a finding.", "FixText": "Configure the permissions on the Run As accounts used on Linux/UNIX endpoints to remove the SUDO ALL permissions. This will be dependent on the specific versions and flavor of the Linux/UNIX operating systems in question. \n\nMicrosoft's least privilege recommendations for supported versions can be found at the following location: https://social.technet.microsoft.com/wiki/contents/articles/7375.scom-configuring-sudo-elevation-for-UNIX-and-linux-monitoring.aspx.", "CCI": "CCI-000213"}, {"VulnID": "V-237426", "RuleID": "SV-237426r643924_rule", "StigID": "SCOM-AC-000004", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000033-NDM-000212", "RuleTitle": "The Microsoft SCOM Agent Action Account must be a local system account.", "Description": "<VulnDiscussion>The SCOM agent action account is the account agent used to perform tasks on an individual machine. By default, the action agent account is the local system account, but this can be configured to run as a service account. In that scenario, the account will be running locally in memory and could be used by an attacker to laterally move throughout an environment. Using the local system account limits the ability to laterally traverse within the environment if a specific endpoint is compromised.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "The SCOM agent action account is the account agent used to perform tasks on an individual machine. By default, the action agent account is the local system account, but this can be configured to run as a service account. In that scenario, the account will be running locally in memory and could be used by an attacker to laterally move throughout an environment. Using the local system account limits the ability to laterally traverse within the environment if a specific endpoint is compromised.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "From the SCOM console, go to the administration workspace. \n\nUnder Run As Configuration, select Profiles.\n\nDouble-click on the Default Action Account in the center pane. From the box that appears, select the Run As accounts link.\n\nUnder the Account Name column, verify that ONLY management servers are running with a specified user account. All other accounts should say Local System Action Account.\n\nIf any non-management servers have a specific user account listed, this is a finding.\n\nElevate to a CAT I if the specified account is a local administrator on other systems. This can be downgraded to CAT III if the agent action account has been restricted from logging on to all other systems except the monitored endpoint, as the risk of credential leakage has been sufficiently mitigated.", "FixText": "From the SCOM console, go to the administration workspace. Under Run As Configuration, select Profiles.\n\nDouble-click on the Default Action Account in the center pane. From the box that appears, select the Run As accounts link.\n\nClick on each non-management server that is configured with a Run As account and click Edit. From the box that appears, select \"Local System Account\" in the Run As account drop down. Click OK. \n\nClick Save once finished with all systems.", "CCI": "CCI-000213"}, {"VulnID": "V-237427", "RuleID": "SV-237427r643927_rule", "StigID": "SCOM-AC-000005", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000033-NDM-000212", "RuleTitle": "The Microsoft SCOM Run As accounts must only use least access permissions.", "Description": "<VulnDiscussion>The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. Run As Accounts are interactive logon sessions on a system. An attacker who has compromised one of those systems could potentially reuse the credentials of a Run As account on another system.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. Run As Accounts are interactive logon sessions on a system. An attacker who has compromised one of those systems could potentially reuse the credentials of a Run As account on another system.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Obtain the User ID(s) in SCOM:\n\nOpen the Operations Console and select the Administration workspace.\n\nUnder Run As Configuration, select Accounts. \n\nDouble-click on each account listed under the Windows type and select the credentials tab (note that the network system and local system accounts do not need to be checked). Note the Username and domain name. Click on the Distribution tab and note the computer names that the account is distributed to.\n\nValidate Permissions in Active Directory:\n\nFor each SCOM Run As account, open the Active Directory Users and Computers MMC and if necessary connect to the appropriate domain. Right-click on the domain and select \"Find\". In the \"Name\" field, type the User ID and click \"Find Now\". The account will appear in the results below. Double-click on the account and select the \"Member Of\" tab.\n\nReview the groups listed. If any group listed is an administrator on any system other than the systems the account is distributed to, this is a finding.\n\nIf the account is part of Domain Administrators or Enterprise Administrators, elevate to CAT I.", "FixText": "Create an active directory group in which the account is a member. Assign this group the appropriate permissions on only the servers that need this account. Remove the Run As account from all additional administrative AD groups.", "CCI": "CCI-000213"}, {"VulnID": "V-237428", "RuleID": "SV-237428r643930_rule", "StigID": "SCOM-AC-000006", "Severity": "low", "Cat": "CAT III", "Classification": "", "GroupTitle": "SRG-APP-000033-NDM-000212", "RuleTitle": "The Microsoft SCOM administration console must only be installed on Management Servers and hardened Privileged Access Workstations.", "Description": "<VulnDiscussion>The Microsoft SCOM management servers are considered high value IT resources where compromise would cause a significant impact to the organization. The Operations Manager console contains APIs that an attacker can use to decrypt Run As accounts or install malicious management packs. If a SCOM console sits on a Tier 2 device, an attacker could use the administrator's alternate credentials to exploit SCOM. A Privileged Admin Workstation (PAW) device provides configuration and installation requirements for dedicated Windows workstations used exclusively for remote administrative management of designated high-value IT resources.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "The Microsoft SCOM management servers are considered high value IT resources where compromise would cause a significant impact to the organization. The Operations Manager console contains APIs that an attacker can use to decrypt Run As accounts or install malicious management packs. If a SCOM console sits on a Tier 2 device, an attacker could use the administrator's alternate credentials to exploit SCOM. A Privileged Admin Workstation (PAW) device provides configuration and installation requirements for dedicated Windows workstations used exclusively for remote administrative management of designated high-value IT resources.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "If the SCOM console is installed on a Terminal Server within a dedicated hardened management forest, this check is Not Applicable.\n\nIf the console is installed on a general purpose device and the user is NOT a SCOM administrator, this is not a finding. Examples would be individuals in the Network Operations Center (NOC) who only respond to alerts.\n\nFrom the SCOM Administrator(s) productivity workstation (i.e. it has internet, or office applications), check for the presence of the operations console. This can be done by clicking the windows button and typing \"Operations\" in the search bar. \n\nIf the console is installed on a general purpose device and the user is NOT a SCOM administrator, this is not a finding. Examples would be individuals in the Network Operations Center (NOC) who only respond to alerts.\n\nIf the Operations console appears, this is a finding.", "FixText": "Remove any SCOM consoles from productivity workstations.", "CCI": "CCI-000213"}, {"VulnID": "V-237429", "RuleID": "SV-237429r643933_rule", "StigID": "SCOM-AC-000007", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000033-NDM-000212", "RuleTitle": "The Microsoft SCOM Service Accounts and Run As accounts must not be granted enterprise or domain level administrative privileges.", "Description": "<VulnDiscussion>The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. A SCOM Run As account must only have the level of privileges required to perform the defined SCOM actions. An account with full administrative at the domain or enterprise level could be used to breach security boundaries and compromise the endpoint.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "The Microsoft SCOM privileged Run As accounts are used to execute work flow tasks on target endpoints. A SCOM Run As account must only have the level of privileges required to perform the defined SCOM actions. An account with full administrative at the domain or enterprise level could be used to breach security boundaries and compromise the endpoint.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Obtain the User ID(s) for the appropriate accounts in SCOM:\n\nOpen the Operations Console and select the Administration workspace.\n\nUnder Run As Configuration, select Accounts.\n\nDouble-click on each account listed under the Windows type and select the credentials tab (note that the network system and local system accounts do not need to be checked). Note the Username and domain name. Open Active Directory Users and Computers.\n\nDetermine rights in Active Directory:\n\nReview the Domain Admins, Administrators (in AD), Enterprise Admins, Schema Admins groups, and any group that is a member of these groups.\n\nIf a SCOM Run-As account or Service account is a member of any of these groups, this is a finding.", "FixText": "Remove the service accounts from these groups and grant appropriate permissions to them. SCOM service account permission documentation can be found at this link: https://kevinholman.com/2019/03/08/scom-2016-security-account-matrix/. Run As accounts that are not being used as SCOM service accounts should be configured to least privileges as well.", "CCI": "CCI-000213"}, {"VulnID": "V-237430", "RuleID": "SV-237430r643936_rule", "StigID": "SCOM-AC-000008", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000033-NDM-000212", "RuleTitle": "SCOM SQL Management must be configured to use least privileges.", "Description": "<VulnDiscussion>Microsoft SCOM's SQL management requires a Run as solution because the local system account will not have the required permissions to monitor SQL.\n\nIf the Run As account is created with elevated database privileges on the SQL endpoint, this can be used to modify SQL databases, breach security boundaries, or otherwise compromise the endpoint.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Microsoft SCOM's SQL management requires a Run as solution because the local system account will not have the required permissions to monitor SQL.\n\nIf the Run As account is created with elevated database privileges on the SQL endpoint, this can be used to modify SQL databases, breach security boundaries, or otherwise compromise the endpoint.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "If the Microsoft SQL management packs for SCOM are not imported, this check is Not Applicable.\n\nDetermine which SQL Servers are managed by SCOM:\n\nFrom the Operations Console, click on the Monitoring workspace. In the left pane, expand the \"Microsoft SQL Servers folder\" and click on the Computers icon (note older versions of this management pack may be version specific). Make note of the servers listed.\n\nLog on to SQL Server Management Studio and connect to servers being managed in SCOM. Expand the Security Tab and select Logins. \n\nVerify that NT System\\Authority, NT Service\\HealthService, or the SQL Run As account has not been granted System Admin privileges (SA rights).\n\nIf the any of these accounts have been granted SA privileges, this is a finding.", "FixText": "Configure the NT System\\Authority or SCOM Run As accounts for least privileges as described in the documentation for the SCOM SQL management pack. The documentation can be found with the management pack download, and permissions may vary depending on the version of the SQL management pack being used. Generally speaking, the account used for monitoring will need to view server state, view any definition, and view any database.\n\nAdditional information on this topic can be found at this location along with a management pack that can automate this process: https://kevinholman.com/2016/08/25/sql-mp-run-as-accounts-no-longer-required/", "CCI": "CCI-000213"}, {"VulnID": "V-237431", "RuleID": "SV-237431r643939_rule", "StigID": "SCOM-AU-000001", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000516-NDM-000340", "RuleTitle": "The Microsoft SCOM server must back up audit records at least every seven days onto a different system or system component than the system or component being audited.", "Description": "<VulnDiscussion>Protection of log data includes assuring log data is not accidentally lost or deleted. Regularly backing up audit records to a different system or onto separate media than the system being audited helps to assure, in the event of a catastrophic system failure, the audit records will be retained.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Protection of log data includes assuring log data is not accidentally lost or deleted. Regularly backing up audit records to a different system or onto separate media than the system being audited helps to assure, in the event of a catastrophic system failure, the audit records will be retained.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Determine if the security logs as well as the Operations Manager logs on the SCOM management server are being ingested by a tool such as Splunk, ArcSite, or Azure Log Analytics. \n\nIf no effort is being made to retain log data on the SCOM server, this is a finding.", "FixText": "Establish and implement a process for keeping the Security Log as well as the Operations Manager log. Most DoD enclaves are already running tools such as Splunk or Azure Log Analytics. It is important that these logs be ingested by these tools.", "CCI": "CCI-000366"}, {"VulnID": "V-237432", "RuleID": "SV-237432r643942_rule", "StigID": "SCOM-CM-000001", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000516-NDM-000351", "RuleTitle": "The Microsoft SCOM server must be running Windows operating system that supports modern security features such as virtualization based security.", "Description": "<VulnDiscussion>Network devices running older but supported operating systems lack modern security features that mitigate attack surfaces. Attackers face a higher level of complexity to overcome during a compromise attempt.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Network devices running older but supported operating systems lack modern security features that mitigate attack surfaces. Attackers face a higher level of complexity to overcome during a compromise attempt.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Check the operating system version.\n\nFrom the SCOM management servers, type winver and press enter. If the operating system is not Windows Server 2016 or later, this is a finding.", "FixText": "Upgrade the network device to an operating that supports modern security features such as virtualization based security.", "CCI": "CCI-000366"}, {"VulnID": "V-237433", "RuleID": "SV-237433r643945_rule", "StigID": "SCOM-CM-000002", "Severity": "low", "Cat": "CAT III", "Classification": "", "GroupTitle": "SRG-APP-000516-NDM-000340", "RuleTitle": "SCOM unsealed management packs must be backed up regularly.", "Description": "<VulnDiscussion>SCOM's configuration information is stored within unsealed management packs. Even without SQL backups, a catastrophic failure to SCOM can be recovered from quickly if the unsealed management packs have been backed up.\n\nSatisfies: SRG-APP-000516-NDM-000340, SRG-APP-000516-NDM-000341</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "SCOM's configuration information is stored within unsealed management packs. Even without SQL backups, a catastrophic failure to SCOM can be recovered from quickly if the unsealed management packs have been backed up.\n\nSatisfies: SRG-APP-000516-NDM-000340, SRG-APP-000516-NDM-000341", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "There is more than one way to configure this, and it will be at an administrator's discretion. \n\nOpen task scheduler and check for the presence of a scheduled task to back up unsealed management packs. If present, review the script to determine where backups are being stored. \n\nVerify that the unsealed management packs are being saved to the location specified in the task and that the location is being backed up regularly. \n\nAlternatively, several free management packs do exist to automate this process within SCOM, or an administrator could automate this with their own custom management pack or using an orchestration tool such as System Center Orchestrator. \n\nThis is not a finding if an administrator can show that one of these is installed/configured and that unsealed management packs are being written to the configured location.\n\nIf unsealed management packs are not being exported to disk and backed up, this is a finding.", "FixText": "The quickest solution available is to download the management pack referenced in this article and configure it accordingly: https://kevinholman.com/2017/07/07/scom-2012-and-2016-unsealed-mp-backup/\n\nUltimately, this is an organizational decision as to how the administrator would like to proceed.", "CCI": "CCI-000366,CCI-000537,CCI-000539"}, {"VulnID": "V-237434", "RuleID": "SV-237434r643948_rule", "StigID": "SCOM-CM-000003", "Severity": "low", "Cat": "CAT III", "Classification": "", "GroupTitle": "SRG-APP-000516-NDM-000344", "RuleTitle": "If a certificate is used for the SCOM web console, this certificate must be generated by a DoD CA or CA approved by the organization.", "Description": "<VulnDiscussion>Web certificates should always be signed by a trusted signer and never self-signed.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Web certificates should always be signed by a trusted signer and never self-signed.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "From the web console server, open IIS. Right-click on the Default Website and choose Edit Bindings. Select the https binding and click edit. Click View to view the certificate being used to protect the website. If the certificate is not issued by a DoD CA or a trusted internal CA, this is a finding.", "FixText": "Issue a web corticated from a trusted internal CA server as this will be required for https protocols to function properly. It will need to be installed on the server in advance.\n\nFrom the SCOM web console server, open IIS. Right-click on the Default Website and choose edit bindings. Click on the https binding and click edit. For the SSL certificate drop down, choose the new certificate. Click OK. Test https access to the SCOM web console and troubleshoot if connectivity is not working. Once connectivity is established, delete the http binding.", "CCI": "CCI-000366,CCI-001159"}, {"VulnID": "V-237435", "RuleID": "SV-237435r643951_rule", "StigID": "SCOM-IA-000001", "Severity": "low", "Cat": "CAT III", "Classification": "", "GroupTitle": "SRG-APP-000395-NDM-000310", "RuleTitle": "The Microsoft SCOM SNMP Monitoring in SCOM must use SNMP V3.", "Description": "<VulnDiscussion>SNMP Versions 1 and 2 do not use a FIPS-validated Keyed-Hash message Authentication Code (HMAC). SCOM has the capability of monitoring all versions of SNMP. As such, SNMP 1 and 2 monitoring should only be done if the device being monitored does not support SNMP V3.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "SNMP Versions 1 and 2 do not use a FIPS-validated Keyed-Hash message Authentication Code (HMAC). SCOM has the capability of monitoring all versions of SNMP. As such, SNMP 1 and 2 monitoring should only be done if the device being monitored does not support SNMP V3.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "From the SCOM Console, select the Administration workspace.\n\nNavigate to Run As Configuration and select Accounts.\n\nReview all of the listed Accounts.\n\nIf any account is listed under the \"Community String\" type, this is a finding.", "FixText": "Create SNMP V3 Run As accounts and use these to monitor network devices:\n\nNote that for this to work, SNMP V3 must be set up on the network device being monitored and some of the configuration info for this account must be obtained from that device.\n\nFrom the SCOM Operations Console, select the Administration workspace, expand Run As Configuration, and select Accounts. Right-click and choose \"Create Run As accounts\". Click \"Next\" at the first screen and in the Run As account type, choose SNMP V3 account. Give it an appropriate display name and complete the wizard supplying the relevant information from the monitored network device(s).", "CCI": "CCI-001967"}, {"VulnID": "V-237436", "RuleID": "SV-237436r643954_rule", "StigID": "SCOM-IA-000002", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000080-NDM-000345", "RuleTitle": "The Microsoft SCOM server must use an active directory group that contains authorized members of the SCOM Administrators Role Group.", "Description": "<VulnDiscussion>During the initial installation, SCOM grants the Builtin\\Administrators group administrator rights to the application. This configuration will allow any local administrator to the SCOM server to have full administrative rights into SCOM.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "During the initial installation, SCOM grants the Builtin\\Administrators group administrator rights to the application. This configuration will allow any local administrator to the SCOM server to have full administrative rights into SCOM.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Open the Operations Console and select the Administrative workspace.\n\nIn the left pane, expand Security and select User Roles. In the center pane, double-click on Operations Manager Administrators.\n\nIf Builtin\\Administrators is listed, this is a finding.", "FixText": "From Active Directory Users and Computers, create a group following the organizational naming standards for SCOM Administrators. Add the SCOM service accounts to this group along with any user's administrative account that is required to administer SCOM. Make note of the group name.\n\nLog on to the SCOM console with an administrative account. Select the Administration workspace. Expand Security and click User Roles. From the center pane, double-click on Operations Manager Administrators.\n\nClick the Add button and type the name of the group created above and click Check Names. The name should validate. Click OK.\n\nThe new group should now be added to the Operations Manager Administrators role. Click on Builtin\\Administrators and click Remove. Click OK.", "CCI": "CCI-002041"}, {"VulnID": "V-237437", "RuleID": "SV-237437r643957_rule", "StigID": "SCOM-IA-000003", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000080-NDM-000345", "RuleTitle": "The default Builtin\\Administrators group must be removed from the SCOM Administrators Role Group.", "Description": "<VulnDiscussion>SCOM servers with default well-known operating system groups defined the SCOM Administrators Global Group may allow a local administrator access to privileged SCOM access.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "SCOM servers with default well-known operating system groups defined the SCOM Administrators Global Group may allow a local administrator access to privileged SCOM access.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "Review the SCOM Administrators Global Group and verify that the Built-in\\Administrators Group is not a member.\n\nIf the Built-in\\Administrators group is a member, this is a finding.", "FixText": "Remove the Built-in\\Administrators group from the SCOM Administrators Role Group.", "CCI": "CCI-002041"}, {"VulnID": "V-237438", "RuleID": "SV-237438r643960_rule", "StigID": "SCOM-MA-000001", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000412-NDM-000331", "RuleTitle": "The SCOM Web Console must be configured for HTTPS.", "Description": "<VulnDiscussion>HTTP sessions are sent in clear text and can allow a man in the middle to recon the environment. The web console itself does not allow for administrative actions, so most of the risk associated with http authentication is inherently mitigated. However, this would allow an attacker to intercept SCOM web-console traffic for reconnaissance purposes.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "HTTP sessions are sent in clear text and can allow a man in the middle to recon the environment. The web console itself does not allow for administrative actions, so most of the risk associated with http authentication is inherently mitigated. However, this would allow an attacker to intercept SCOM web-console traffic for reconnaissance purposes.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "This check is Not Applicable if the SCOM web console is not installed.\n\nFrom the SCOM web console server, open IIS. Right-click on the Default Website and choose edit bindings. Examine the bindings for the web console and verify that only https is an option. If http is present or if there is no https binding, this is a finding.", "FixText": "Issue a web corticated from a trusted internal CA server, as this will be required for https protocols to function properly. It will need to be installed on the server in advance.\n\nFrom the SCOM web console server, open IIS. \n\nRight-click on the Default Website and choose edit bindings. \n\nClick the Add button. \n\nUnder type, select https and enter the appropriate host name in the host name field. \n\nFor the SSL certificate drop down, choose the certificate that was installed. Click OK. \n\nTest https access to the SCOM web console and troubleshoot if connectivity is not working. \n\nOnce connectivity is established, delete the http binding.", "CCI": "CCI-003123"}, {"VulnID": "V-237439", "RuleID": "SV-237439r643963_rule", "StigID": "SCOM-SC-000001", "Severity": "high", "Cat": "CAT I", "Classification": "", "GroupTitle": "SRG-APP-000224-NDM-000270", "RuleTitle": "All SCOM servers must be configured for FIPS 140-2 compliance.", "Description": "<VulnDiscussion>Unapproved mechanisms used for authentication to the cryptographic module are not validated and therefore cannot be relied on to provide confidentiality or integrity, and DoD data may be compromised. FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. However, authentication algorithms must configure security processes to use only FIPS-approved and NIST-recommended authentication algorithms.\n\nSCOM is FIPS-compliant out of the box with the exception of the Web Console.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "Unapproved mechanisms used for authentication to the cryptographic module are not validated and therefore cannot be relied on to provide confidentiality or integrity, and DoD data may be compromised. FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. However, authentication algorithms must configure security processes to use only FIPS-approved and NIST-recommended authentication algorithms.\n\nSCOM is FIPS-compliant out of the box with the exception of the Web Console.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "From a SCOM Management server, open the registry editor. Navigate to the following key:\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy\n\nVerify that the \"Enabled\" key is set to 1.\n\nIf the \"Enabled\" key is not set to 1 or is not present, this is a finding.\n\nFrom a command prompt, open the following file with notepad: C:\\Windows\\Micosoft.NET\\Framework]v2.0.50727\\CONFIG\\machine.config. Immediately following the <ConfigSection>, look for <cryptographySettings>. \n\nIf the <cryptographySettings> section does not exist under <ConfigSection> of the machine.config file, this is a finding.", "FixText": "From a SCOM Management server, open the registry editor. Navigate to the following key:\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy\n\nDouble-click on \"Enabled\" and set the value to 1.\n\nNote that many organizations use a GPO to accomplish this task. Older versions of SCOM may require additional configuration. That is documented here: https://nathangau.wordpress.com/2016/12/02/scom-2012-webconsole-and-fips-compatibility/", "CCI": "CCI-000803,CCI-001188"}, {"VulnID": "V-237440", "RuleID": "SV-237440r643966_rule", "StigID": "SCOM-SC-000002", "Severity": "medium", "Cat": "CAT II", "Classification": "", "GroupTitle": "SRG-APP-000435-NDM-000315", "RuleTitle": "A host-based firewall must be configured on the SCOM management servers.", "Description": "<VulnDiscussion>To prevent a DDoS, a firewall that inspects and drops packets must be configured.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>", "VulnDiscussion": "To prevent a DDoS, a firewall that inspects and drops packets must be configured.", "FalsePositives": "", "FalseNegatives": "", "Documentable": "false", "Mitigations": "", "SeverityOverrideGuidance": "", "PotentialImpacts": "", "ThirdPartyTools": "", "MitigationControl": "", "Responsibility": "", "IAControls": "", "CheckText": "The steps in this check will vary based on the host-based firewall being used in the environment. \n\nFor Windows Firewall, type wf.msc. \n\nVerify that the firewall is set to On. \n\nClick on Inbound rules and verify that there are no any-any allow rules in any profile. \n\nIf McAfee is installed, it will be visible in the system tray. Verify with a McAfee administrator that there are no any-any rules allowing full access. \n\nIf no host-based firewall is installed, or a host-based firewall is configured to allow all traffic inbound, this is a finding.", "FixText": "Configure a host-based firewall based on the organization's standards. A full list of ports needed for SCOM to function properly can be found here: https://docs.microsoft.com/en-us/system-center/scom/plan-security-config-firewall?view=sc-om-2019.", "CCI": "CCI-002385"}]}