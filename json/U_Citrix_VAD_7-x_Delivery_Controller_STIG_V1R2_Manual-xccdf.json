{
    "Title": "Citrix Virtual Apps and Desktop 7.x Delivery Controller Security Technical Implementation Guide",
    "Description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.",
    "Version": "1",
    "Release": "2 ",
    "BenchmarkDate": "27 Jan 2022",
    "ReleaseInfo": "Release: 2 Benchmark Date: 27 Jan 2022",
    "Source": "STIG.DOD.MIL",
    "Notice": "terms-of-use",
    "Rules": [
        {
            "VulnID": "V-234565",
            "RuleID": "SV-234565r810853_rule",
            "StigID": "CVAD-DC-000030",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-APP-000014",
            "RuleTitle": "Citrix Delivery Controller must implement DoD-approved encryption.",
            "Description": "<VulnDiscussion>Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session. \n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. \n \nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection, thereby providing a degree of confidentiality. The encryption strength of mechanism is selected based on the security categorization of the information.\n\nSatisfies: SRG-APP-000014, SRG-APP-000015, SRG-APP-000039, SRG-APP-000142, SRG-APP-000172, SRG-APP-000219, SRG-APP-000224, SRG-APP-000416, SRG-APP-000439, SRG-APP-000440, SRG-APP-000441, SRG-APP-000442, SRG-APP-000514</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session. \n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. \n \nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection, thereby providing a degree of confidentiality. The encryption strength of mechanism is selected based on the security categorization of the information.\n\nSatisfies: SRG-APP-000014, SRG-APP-000015, SRG-APP-000039, SRG-APP-000142, SRG-APP-000172, SRG-APP-000219, SRG-APP-000224, SRG-APP-000416, SRG-APP-000439, SRG-APP-000440, SRG-APP-000441, SRG-APP-000442, SRG-APP-000514",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Enforcement is via TLS encryption. To verify, open the Registry Editor on each Delivery Controller and find the following key name: HKEY_LOCAL_MACHINE\\SOFTWARE\\Citrix\\DesktopServer \n\n1. Verify that the XmlServicesSslPort registry key exists with the correct value for SSL port. By default, it is set to \"443\".\n2. Verify XmlServicesEnableNonSsl is set to \"0\".\n3. Verify the corresponding registry value to ignore HTTPS traffic, XmlServicesEnableSsl, is not set to \"0\".\n\nIf \"XmlServicesSslPort\" is not set to the desired port, this is a finding.\n\nIf \"XmlServicesEnableNonSsl\" is not set to \"0\", this is a finding.\n\nIf XmlServicesEnableSsl is not set to \"1\", this is a finding.\n\nTo verify the FIPS Cipher Suites used:\n1. From the Group Policy Management Console, go to Computer Configuration >> Administrative Templates >> Networks >> SSL Configuration Settings.\n2. Double-click \"SSL Cipher Suite Order\" and verify the \"Enabled\" option is checked. \n3. Verify the correct Cipher Suites are listed in the correct order per current DoD guidelines.\n\nIf the \"Enabled\" option is not checked or the correct Cipher Suites are not listed in the correct order per current DoD guidelines, this is a finding.",
            "FixText": "Obtain and install root certificate(s) for server certificates installed on VDAs, SQL Server(s), Storefront, and VM Host (VMware VCenter, Hyper-V, XenServer).\n\nTo install a TLS server certificate on the Delivery Controller without IIS:\n1. Log on to each Delivery Controller with a domain account that has Administrator rights.\n2. Obtain a TLS server certificate and install it on the Delivery Controller, and assign it to a port using netsh, using Microsoft server instructions.\n3. Configure the Delivery Controller with the certificate.\n\nTo install a TLS server certificate on the Delivery Controller with IIS:\n1. Add the server certificate per the Microsoft server instructions.\n2. From IIS Manager, select the IIS site on which HTTPS will be enabled and select \"Bindings\" under \"Edit Site\".\n3. Click \"Add\", select \"Type\" as https, and port number as \"443\". Select the SSL Certificate that was installed and click \"OK\".\n\nTo configure the Delivery Controller to use the no configured TLS port:\n1. Change the XML TLS service port use the following command:\nBrokerService \u2013WiSslPort <port number>\n2. Open the Registry Editor on the CVAD Controller and find the following key name:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Citrix\\DesktopServer\n3. Verify that the \"XmlServicesSslPort\" DWORD value exists with the correct value for SSL port. By default, it is set to \"443\". If it does not exist, add it.\n4. Verify that the \"XmlServicesEnableSsl\" DWORD value exists and is set to \"1\". If it does not exist, add it.\n5. Reboot the Delivery Controller to ensure all changes take effect.\n\nPerform the following only after ensuring all references to the Delivery Controllers on StoreFront servers and gateway proxy devices are set to use https and working. This includes STA references. Now disable non-TLS communication with the XML port.\n1. Open the Registry Editor on the CVAD Controller and find the following key name:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Citrix\\DesktopServer\n2. Add the DWORD value \"XmlServicesEnableNonSsl\" and set it to \"1\".\n3. Reboot the Delivery Controller.\n\nIf XmlServicesEnableSsl is not set to \"1\", this is a finding.\n\nNotes:\nIf the XML service port number on the Delivery Controller needs to be changed, update the IIS port number as well under \"Bindings\" to match the new value.\n\nTo change the default VDA registration port:\n1. Log on to the Delivery Controller server with a domain account that has Administrator rights.\n2. Open the command prompt window and type these commands:\n%SystemDrive%\nCd %ProgramFiles%\\Citrix\\Broker\\Service\nBrokerService.exe \u2013VDAport 8888\n3. Launch Server Manager from the Start menu.\n4. In the Server Manager, go to the \"Local Server\" properties window and edit the \"Windows Firewall\" setting. Click \"Advanced Settings\".\n5. Click \"Inbound Rules\".\n6. Create a new inbound rule with the following settings:\na) In the Rule type screen, click \"Port\". Click \"Next\".\nb) In the Protocol and Ports screen, select \"Specific local ports\" and type \"8888\". Click \"Next\".\nc) In the Action screen, accept the default value \"Allow the connection\" and click \"Next\".\nd) In the Profile screen, accept the default values and click \"Next\".\ne) In the Name screen, type a name for the rule (example: Citrix VDA Registration Port) and click \"Finish\".\n\nTo configure the SSL Cipher Suite Order Group Policy setting manually, follow these steps:\n1. At a command prompt, enter \"gpedit.msc\", and press \"Enter\". The Local Group Policy Editor is displayed.\n2. Go to Computer Configuration >> Administrative Templates >> Network >> SSL Configuration Settings.\n3. Under SSL Configuration Settings, select \"SSL Cipher Suite Order\".\n4. In the SSL Cipher Suite Order pane, scroll to the bottom. Follow the instructions that are labeled \"How to modify this setting\".",
            "CCI": "CCI-000068,CCI-000197,CCI-000382,CCI-001184,CCI-001188,CCI-001414,CCI-001453,CCI-002418,CCI-002420,CCI-002421,CCI-002422,CCI-002450"
        },
        {
            "VulnID": "V-234567",
            "RuleID": "SV-234567r615790_rule",
            "StigID": "CVAD-DC-000270",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000141",
            "RuleTitle": "Citrix Delivery Controller must be configured to disable non-essential capabilities.",
            "Description": "<VulnDiscussion>It is detrimental for applications to provide or install by default functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of non-essential capabilities include but are not limited to advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "It is detrimental for applications to provide or install by default functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of non-essential capabilities include but are not limited to advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Verify Citrix Customer Experience Improvement Program (CEIP) - PHONE HOME is disabled on Delivery Controller.\n\n1. Launch Studio.\n2. Select \"Configuration\" in the left navigation pane.\n3. Select the Support tab.\n4. Verify CEIP is disabled.\n\nIf CEIP is not disabled, this is a finding.",
            "FixText": "To disable Citrix CEIP - Phone Home:\n1. Launch Studio.\n2. Select \"Configuration\" in the left navigation pane.\n3. Select the Support tab.\n4. Follow the prompts to end participation in CEIP.\n\nThis prevents automatic upload of installation experience metrics that are collected locally during installation.\nVADServerStartup.exe /components \"CONTROLLER,DESKTOPSTUDIO\"\n/disableexperiencemetrics /exclude \"Smart Tools Agent\" /nosql\n/quiet /verboselog /noreboot",
            "CCI": "CCI-000381"
        },
        {
            "VulnID": "V-234569",
            "RuleID": "SV-234569r615793_rule",
            "StigID": "CVAD-DC-001235",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "Citrix Delivery Controller must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.",
            "Description": "<VulnDiscussion>Configuring the application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. \n\nConfiguration settings are the set of parameters that can be changed that affects the security posture and/or functionality of the system. Security-related parameters are parameters impacting the security state of the application, including the parameters required to satisfy other security control requirements.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Configuring the application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. \n\nConfiguration settings are the set of parameters that can be changed that affects the security posture and/or functionality of the system. Security-related parameters are parameters impacting the security state of the application, including the parameters required to satisfy other security control requirements.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "To verify that Citrix Delivery Controller and all other infrastructure server components are installable and manageable by authorized administrative accounts, the following policies must be modified:\n\nGo to Computer Configuration Policies >> Windows Settings >> Security Settings >> Local Policies/User Rights Assignment.\n\nVerify policy settings \"Allow log on locally\" and \"Shut down the system\" are both set to the global security group name containing the XenApp or CVAD administrators.\n\nIf they are not, this is a finding.",
            "FixText": "To ensure that Citrix Delivery Controller and all other infrastructure server components are installable and manageable by authorized administrative accounts, the following policies must be modified:\n\nGo to Computer Configuration Policies >> Windows Settings >> Security Settings >> Local Policies/User Rights Assignment.\n1. Edit \"Allow log on locally\".\n2. Edit \"Shut down the system\".\n3. Change both settings to the global security group name containing the XenApp or CVAD administrators.",
            "CCI": "CCI-000366"
        }
    ]
}