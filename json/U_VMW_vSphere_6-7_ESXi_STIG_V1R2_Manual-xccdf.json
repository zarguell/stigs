{
    "Title": "VMware vSphere 6.7 ESXi Security Technical Implementation Guide",
    "Description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.",
    "Version": "1",
    "Release": "2 ",
    "BenchmarkDate": "08 Feb 2022",
    "ReleaseInfo": "Release: 2 Benchmark Date: 08 Feb 2022",
    "Source": "STIG.DOD.MIL",
    "Notice": "terms-of-use",
    "Rules": [
        {
            "VulnID": "V-239258",
            "RuleID": "SV-239258r674703_rule",
            "StigID": "ESXI-67-000001",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000027-VMM-000080",
            "RuleTitle": "Access to the ESXi host must be limited by enabling Lockdown Mode.",
            "Description": "<VulnDiscussion>Enabling Lockdown Mode disables direct access to an ESXi host, requiring the host to be managed remotely from vCenter Server. This is done to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging on to a host directly. By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.\n\nSatisfies: SRG-OS-000027-VMM-000080, SRG-OS-000123-VMM-000620</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Enabling Lockdown Mode disables direct access to an ESXi host, requiring the host to be managed remotely from vCenter Server. This is done to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging on to a host directly. By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.\n\nSatisfies: SRG-OS-000027-VMM-000080, SRG-OS-000123-VMM-000620",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Security Profile. \n\nScroll down to \"Lockdown Mode\" and verify it is enabled (\"Normal\" or \"Strict\").\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Select Name,@{N=\"Lockdown\";E={$_.Extensiondata.Config.LockdownMode}}\n\nIf Lockdown Mode is disabled, this is a finding. \n\nFor environments that do not use vCenter server to manage ESXi, this is Not Applicable.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Security Profile. \n\nClick \"Edit\" in \"Lockdown Mode\" and enable (\"Normal\" or \"Strict\").\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\n$level = \"lockdownNormal\" OR \"lockdownStrict\"\n$vmhost = Get-VMHost -Name <hostname> | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.ChangeLockdownMode($level)\n\nNote: In Strict Lockdown Mode, the DCUI service is stopped. If the connection to vCenter Server is lost and the vSphere Client is no longer available, the ESXi host becomes inaccessible.",
            "CCI": "CCI-000054,CCI-001682"
        },
        {
            "VulnID": "V-239259",
            "RuleID": "SV-239259r674706_rule",
            "StigID": "ESXI-67-000002",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must verify the DCUI.Access list.",
            "Description": "<VulnDiscussion>Lockdown mode disables direct host access, requiring that administrators manage hosts from vCenter Server. However, if a host becomes isolated from vCenter Server, the administrator is locked out and can no longer manage the host. If using normal Lockdown Mode, avoid becoming locked out of an ESXi host that is running in Lockdown Mode by setting DCUI.Access to a list of highly trusted users who can override Lockdown Mode and access the DCUI. The DCUI is not running in strict Lockdown Mode.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Lockdown mode disables direct host access, requiring that administrators manage hosts from vCenter Server. However, if a host becomes isolated from vCenter Server, the administrator is locked out and can no longer manage the host. If using normal Lockdown Mode, avoid becoming locked out of an ESXi host that is running in Lockdown Mode by setting DCUI.Access to a list of highly trusted users who can override Lockdown Mode and access the DCUI. The DCUI is not running in strict Lockdown Mode.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "For environments that do not use vCenter server to manage ESXi, this is Not Applicable.\n\nFrom the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"DCUI.Access\" value and verify that only the root user is listed.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name DCUI.Access and verify it is set to root.\n\nIf the DCUI.Access is not restricted to root, this is a finding.\n\nNote: This list is only for local user accounts and should only contain the root user.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings.\n\nClick \"Edit\", select the \"DCUI.Access\" value, and configure it to root.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name DCUI.Access | Set-AdvancedSetting -Value \"root\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239260",
            "RuleID": "SV-239260r674709_rule",
            "StigID": "ESXI-67-000003",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must verify the exception users list for Lockdown Mode.",
            "Description": "<VulnDiscussion>In vSphere, users can be added to the Exception Users list from the vSphere Web Client. These users do not lose their permissions when the host enters Lockdown Mode. \n\nBefore adding service accounts such as a backup agent to the Exception Users list, verify that the list of users who are exempted from losing permissions is legitimate and as needed per the environment. Users who do not require special permissions should not be exempted from Lockdown Mode.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "In vSphere, users can be added to the Exception Users list from the vSphere Web Client. These users do not lose their permissions when the host enters Lockdown Mode. \n\nBefore adding service accounts such as a backup agent to the Exception Users list, verify that the list of users who are exempted from losing permissions is legitimate and as needed per the environment. Users who do not require special permissions should not be exempted from Lockdown Mode.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "For environments that do not use vCenter server to manage ESXi, this is Not Applicable.\n\nFrom the vSphere Client, select the ESXi host and go to Configure >> System >> Security Profile. \n\nUnder Lockdown Mode, review the Exception Users list.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following script:\n\n$vmhost = Get-VMHost | Get-View\n$lockdown = Get-View $vmhost.ConfigManager.HostAccessManager\n$lockdown.QueryLockdownExceptions()\n\nIf the Exception Users list contains accounts that do not require special permissions, this is a finding.\n\nNote: This list is not intended for system administrator accounts but for special circumstances such as a service account.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Security Profile. \n\nUnder \"Lockdown Mode\", click \"Edit\" and remove unnecessary users from the exceptions list.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239261",
            "RuleID": "SV-239261r674712_rule",
            "StigID": "ESXI-67-000004",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000032-VMM-000130",
            "RuleTitle": "Remote logging for ESXi hosts must be configured.",
            "Description": "<VulnDiscussion>Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host, it can more easily monitor all hosts with a single tool. It can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record.\n\nSatisfies: SRG-OS-000032-VMM-000130, SRG-OS-000342-VMM-001230, SRG-OS-000479-VMM-001990</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host, it can more easily monitor all hosts with a single tool. It can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record.\n\nSatisfies: SRG-OS-000032-VMM-000130, SRG-OS-000342-VMM-001230, SRG-OS-000479-VMM-001990",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Syslog.global.logHost\" value and verify it is set to a site-specific syslog server hostname.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost\n\nIf the \"Syslog.global.logHost\" setting is not set to a site-specific syslog server, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"Syslog.global.logHost\" value, and configure it to a site-specific syslog server.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logHost | Set-AdvancedSetting -Value \"<syslog server hostname>\"",
            "CCI": "CCI-000067,CCI-001851"
        },
        {
            "VulnID": "V-239262",
            "RuleID": "SV-239262r674715_rule",
            "StigID": "ESXI-67-000005",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000021-VMM-000050",
            "RuleTitle": "The ESXi host must enforce the limit of three consecutive invalid logon attempts by a user.",
            "Description": "<VulnDiscussion>By limiting the number of failed logon attempts, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Once the configured number of attempts is reached, the account is locked by the ESXi host.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By limiting the number of failed logon attempts, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Once the configured number of attempts is reached, the account is locked by the ESXi host.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings.\n\nSelect the \"Security.AccountLockFailures\" value and verify it is set to \"3\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures\n\nIf \"Security.AccountLockFailures\" is set to a value other than \"3\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings.\n\nClick \"Edit\", select the \"Security.AccountLockFailures\" value, and configure it to \"3\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures | Set-AdvancedSetting -Value 3",
            "CCI": "CCI-000044"
        },
        {
            "VulnID": "V-239263",
            "RuleID": "SV-239263r674718_rule",
            "StigID": "ESXI-67-000006",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000329-VMM-001180",
            "RuleTitle": "The ESXi host must enforce the unlock timeout of 15 minutes after a user account is locked out.",
            "Description": "<VulnDiscussion>By enforcing a reasonable unlock timeout after multiple failed logon attempts, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Users must wait for the timeout period to elapse before subsequent logon attempts are allowed.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By enforcing a reasonable unlock timeout after multiple failed logon attempts, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Users must wait for the timeout period to elapse before subsequent logon attempts are allowed.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Security.AccountUnlockTime\" value and verify it is set to \"900\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime\n\nIf the \"Security.AccountUnlockTime\" is set to a value other than \"900\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\" and select the \"Security.AccountUnlockTime\" value and configure it to \"900\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime | Set-AdvancedSetting -Value 900",
            "CCI": "CCI-002238"
        },
        {
            "VulnID": "V-239264",
            "RuleID": "SV-239264r674721_rule",
            "StigID": "ESXI-67-000007",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000023-VMM-000060",
            "RuleTitle": "The ESXi host must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system via the DCUI.",
            "Description": "<VulnDiscussion>Failure to display the DoD logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources.\n\nSatisfies: SRG-OS-000023-VMM-000060, SRG-OS-000024-VMM-000070</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Failure to display the DoD logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources.\n\nSatisfies: SRG-OS-000023-VMM-000060, SRG-OS-000024-VMM-000070",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Annotations.WelcomeMessage\" value and verify it contains the DoD logon banner to follow.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage\n\nCheck for either of the following logon banners based on the character limitations imposed by the system. An exact match of the text is required. If one of these banners is not displayed, this is a finding.\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests- -not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\n\nOR\n\nI've read & consent to terms in IS user agreem't.\n\nIf the DCUI logon screen does not display the DoD logon banner, this is a finding.",
            "FixText": "From a PowerCLI command prompt while connected to the ESXi host, copy the following contents into a script(.ps1 file) and run to set the DCUI screen to display the DoD logon banner:\n\n<script begin>\n\n$value = @\"\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{hostname} , {ip}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{esxproduct} {esxversion}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:yellow}{memory} RAM{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:black}{color:white}        {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  using this IS (which includes any device attached to this IS), you consent to the following conditions:                 {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law      {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          enforcement (LE), and counterintelligence (CI) investigations.                                                  {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       At any time, the USG may inspect and seize data stored on this IS.                                              {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       Communications using, or data stored on, this IS are not private, are subject to routine monitoring,            {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          interception, and search, and may be disclosed or used for any USG-authorized purpose.                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not     {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          for your personal benefit or privacy.                                                                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}  -       Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching    {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or monitoring of the content of privileged communications, or work product, related to personal representation  {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work       {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}          product are private and confidential. See User Agreement for details.                                           {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{align:left}{bgcolor:yellow}{color:black}                                                                                                                          {/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n{bgcolor:black} {/color}{align:left}{bgcolor:dark-grey}{color:white}  <F2> Accept Conditions and Customize System / View Logs{/align}{align:right}<F12> Accept Conditions and Shut Down/Restart  {bgcolor:black} {/color}{/color}{/bgcolor}{/align}\n{bgcolor:black} {/color}{bgcolor:dark-grey}{color:black}                                                                                                                          {/color}{/bgcolor}\n\"@\n\nGet-VMHost | Get-AdvancedSetting -Name Annotations.WelcomeMessage | Set-AdvancedSetting -Value $value\n\n<script end>",
            "CCI": "CCI-000048,CCI-000050"
        },
        {
            "VulnID": "V-239265",
            "RuleID": "SV-239265r674724_rule",
            "StigID": "ESXI-67-000008",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000023-VMM-000060",
            "RuleTitle": "The ESXi host must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system via SSH.",
            "Description": "<VulnDiscussion>Failure to display the DoD logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Failure to display the DoD logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Config.Etc.issue\" value and verify it is set to the DoD logon banner below.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.Etc.issue\n\nIf the \"Config.Etc.issue\" setting (/etc/issue file) does not contain the logon banner exactly as shown below, this is a finding.\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"Config.Etc.issue\" value, and set it to the following:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.Etc.issue | Set-AdvancedSetting -Value \"<insert logon banner>\"",
            "CCI": "CCI-000048"
        },
        {
            "VulnID": "V-239266",
            "RuleID": "SV-239266r674727_rule",
            "StigID": "ESXI-67-000009",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000023-VMM-000060",
            "RuleTitle": "The ESXi host SSH daemon must be configured with the DoD logon banner.",
            "Description": "<VulnDiscussion>The warning message reinforces policy awareness during the logon process and facilitates possible legal action against attackers. Alternatively, systems whose ownership should not be obvious should ensure usage of a banner that does not provide easy attribution.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The warning message reinforces policy awareness during the logon process and facilitates possible legal action against attackers. Alternatively, systems whose ownership should not be obvious should ensure usage of a banner that does not provide easy attribution.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^Banner\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"Banner /etc/issue\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nBanner /etc/issue",
            "CCI": "CCI-000048"
        },
        {
            "VulnID": "V-239267",
            "RuleID": "SV-239267r674730_rule",
            "StigID": "ESXI-67-000010",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000033-VMM-000140",
            "RuleTitle": "The ESXi host SSH daemon must use DoD-approved encryption to protect the confidentiality of remote access sessions.",
            "Description": "<VulnDiscussion>Approved algorithms should impart some level of confidence in their implementation. Limit the ciphers to algorithms that are FIPS approved. Counter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Approved algorithms should impart some level of confidence in their implementation. Limit the ciphers to algorithms that are FIPS approved. Counter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "To verify that only FIPS-approved ciphers are in use, run the following command from an SSH session connected to the ESXi host, or from the ESXi shell: \n\n# grep -i \"^FipsMode\" /etc/ssh/sshd_config\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\n$esxcli = Get-EsxCli -v2\n$esxcli.system.security.fips140.ssh.get.invoke()\n\nIf there is no output or the output is not exactly \"FipsMode yes\" over SSH, or enabled is not \"true\" over PowerCLI, this is a finding.",
            "FixText": "Limit the ciphers to FIPS-approved algorithms.\n\nFrom an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\": \n\nFipsMode yes\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\n$esxcli = Get-EsxCli -v2\n$arguments = $esxcli.system.security.fips140.ssh.set.CreateArgs()\n$arguments.enable = $true\n$esxcli.system.security.fips140.ssh.set.Invoke($arguments)",
            "CCI": "CCI-000068"
        },
        {
            "VulnID": "V-239268",
            "RuleID": "SV-239268r674733_rule",
            "StigID": "ESXI-67-000012",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000107-VMM-000530",
            "RuleTitle": "The ESXi host SSH daemon must ignore .rhosts files.",
            "Description": "<VulnDiscussion>SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts. SSH can emulate the behavior of the obsolete rsh command in allowing users to enable insecure access to their accounts via \".rhosts\" files.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts. SSH can emulate the behavior of the obsolete rsh command in allowing users to enable insecure access to their accounts via \".rhosts\" files.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^IgnoreRhosts\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"IgnoreRhosts yes\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\": \n\nIgnoreRhosts yes",
            "CCI": "CCI-000767"
        },
        {
            "VulnID": "V-239269",
            "RuleID": "SV-239269r674736_rule",
            "StigID": "ESXI-67-000013",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not allow host-based authentication.",
            "Description": "<VulnDiscussion>SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts. SSH's cryptographic host-based authentication is more secure than \".rhosts\" authentication, since hosts are cryptographically authenticated. However, it is not recommended that hosts unilaterally trust one another, even within an organization.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts. SSH's cryptographic host-based authentication is more secure than \".rhosts\" authentication, since hosts are cryptographically authenticated. However, it is not recommended that hosts unilaterally trust one another, even within an organization.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^HostbasedAuthentication\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"HostbasedAuthentication no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\": \n\nHostbasedAuthentication no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239270",
            "RuleID": "SV-239270r674739_rule",
            "StigID": "ESXI-67-000014",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not permit root logins.",
            "Description": "<VulnDiscussion>Permitting direct root login reduces auditable information about who ran privileged commands on the system and also allows direct attack attempts on root's password.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Permitting direct root login reduces auditable information about who ran privileged commands on the system and also allows direct attack attempts on root's password.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^PermitRootLogin\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitRootLogin no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAdd or correct the following line in \"/etc/ssh/sshd_config\": \n\nPermitRootLogin no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239271",
            "RuleID": "SV-239271r674742_rule",
            "StigID": "ESXI-67-000015",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not allow authentication using an empty password.",
            "Description": "<VulnDiscussion>Configuring this setting for the SSH daemon provides additional assurance that remote logon via SSH will require a password, even in the event of misconfiguration elsewhere.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Configuring this setting for the SSH daemon provides additional assurance that remote logon via SSH will require a password, even in the event of misconfiguration elsewhere.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^PermitEmptyPasswords\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitEmptyPasswords no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nPermitEmptyPasswords no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239272",
            "RuleID": "SV-239272r674745_rule",
            "StigID": "ESXI-67-000016",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not permit user environment settings.",
            "Description": "<VulnDiscussion>SSH environment options potentially allow users to bypass access restriction in some configurations. Users must not be able to present environment options to the SSH daemon.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "SSH environment options potentially allow users to bypass access restriction in some configurations. Users must not be able to present environment options to the SSH daemon.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^PermitUserEnvironment\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitUserEnvironment no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nPermitUserEnvironment no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239273",
            "RuleID": "SV-239273r674748_rule",
            "StigID": "ESXI-67-000018",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not permit GSSAPI authentication.",
            "Description": "<VulnDiscussion>GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through SSH exposes the system\u2019s GSSAPI to remote hosts, increasing the attack surface of the system.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through SSH exposes the system\u2019s GSSAPI to remote hosts, increasing the attack surface of the system.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^GSSAPIAuthentication\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"GSSAPIAuthentication no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nGSSAPIAuthentication no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239274",
            "RuleID": "SV-239274r674751_rule",
            "StigID": "ESXI-67-000019",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not permit Kerberos authentication.",
            "Description": "<VulnDiscussion>Kerberos authentication for SSH is often implemented using GSSAPI. If Kerberos is enabled through SSH, the SSH daemon provides a means of access to the system's Kerberos implementation. Vulnerabilities in the system's Kerberos implementation may then be subject to exploitation. To reduce the attack surface of the system, the Kerberos authentication mechanism within SSH must be disabled for systems.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Kerberos authentication for SSH is often implemented using GSSAPI. If Kerberos is enabled through SSH, the SSH daemon provides a means of access to the system's Kerberos implementation. Vulnerabilities in the system's Kerberos implementation may then be subject to exploitation. To reduce the attack surface of the system, the Kerberos authentication mechanism within SSH must be disabled for systems.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^KerberosAuthentication\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"KerberosAuthentication no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nKerberosAuthentication no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239275",
            "RuleID": "SV-239275r674754_rule",
            "StigID": "ESXI-67-000020",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must perform strict mode checking of home directory configuration files.",
            "Description": "<VulnDiscussion>If other users have access to modify user-specific SSH configuration files, they may be able to log on to the system as another user.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If other users have access to modify user-specific SSH configuration files, they may be able to log on to the system as another user.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^StrictModes\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"StrictModes yes\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nStrictModes yes",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239276",
            "RuleID": "SV-239276r674757_rule",
            "StigID": "ESXI-67-000021",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not allow compression or must only allow compression after successful authentication.",
            "Description": "<VulnDiscussion>If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection, potentially with root privileges.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection, potentially with root privileges.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^Compression\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"Compression no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nCompression no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239277",
            "RuleID": "SV-239277r674760_rule",
            "StigID": "ESXI-67-000022",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must be configured to not allow gateway ports.",
            "Description": "<VulnDiscussion>SSH TCP connection forwarding provides a mechanism to establish TCP connections proxied by the SSH server. This function can provide similar convenience to a Virtual Private Network (VPN) with the similar risk of providing a path to circumvent firewalls and network Access Control Lists (ACLs). Gateway ports allow remote forwarded ports to bind to non-loopback addresses on the server.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "SSH TCP connection forwarding provides a mechanism to establish TCP connections proxied by the SSH server. This function can provide similar convenience to a Virtual Private Network (VPN) with the similar risk of providing a path to circumvent firewalls and network Access Control Lists (ACLs). Gateway ports allow remote forwarded ports to bind to non-loopback addresses on the server.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^GatewayPorts\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"GatewayPorts no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nGatewayPorts no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239278",
            "RuleID": "SV-239278r674763_rule",
            "StigID": "ESXI-67-000023",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must be configured to not allow X11 forwarding.",
            "Description": "<VulnDiscussion>X11 forwarding over SSH allows for the secure remote execution of X11-based applications. This feature can increase the attack surface of an SSH connection.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "X11 forwarding over SSH allows for the secure remote execution of X11-based applications. This feature can increase the attack surface of an SSH connection.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^X11Forwarding\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"X11Forwarding no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nX11Forwarding no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239279",
            "RuleID": "SV-239279r674766_rule",
            "StigID": "ESXI-67-000024",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not accept environment variables from the client.",
            "Description": "<VulnDiscussion>Environment variables can be used to change the behavior of remote sessions and should be limited. Locale environment variables specify the language, character set, and other features modifying the operation of software to match the user's preferences.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Environment variables can be used to change the behavior of remote sessions and should be limited. Locale environment variables specify the language, character set, and other features modifying the operation of software to match the user's preferences.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^AcceptEnv\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"AcceptEnv\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nAcceptEnv",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239280",
            "RuleID": "SV-239280r674769_rule",
            "StigID": "ESXI-67-000025",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must not permit tunnels.",
            "Description": "<VulnDiscussion>OpenSSH has the ability to create network tunnels (layer 2 and layer 3) over an SSH connection. This function can provide similar convenience to a Virtual Private Network (VPN) with the similar risk of providing a path to circumvent firewalls and network Access Control Lists (ACLs).</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "OpenSSH has the ability to create network tunnels (layer 2 and layer 3) over an SSH connection. This function can provide similar convenience to a Virtual Private Network (VPN) with the similar risk of providing a path to circumvent firewalls and network Access Control Lists (ACLs).",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^PermitTunnel\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"PermitTunnel no\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nPermitTunnel no",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239281",
            "RuleID": "SV-239281r674772_rule",
            "StigID": "ESXI-67-000026",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must set a timeout count on idle sessions.",
            "Description": "<VulnDiscussion>Setting a timeout ensures that a user login will be terminated as soon as the \"ClientAliveCountMax\" is reached.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Setting a timeout ensures that a user login will be terminated as soon as the \"ClientAliveCountMax\" is reached.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^ClientAliveCountMax\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"ClientAliveCountMax 3\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nClientAliveCountMax 3",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239282",
            "RuleID": "SV-239282r674775_rule",
            "StigID": "ESXI-67-000027",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must set a timeout interval on idle sessions.",
            "Description": "<VulnDiscussion>Automatically logging out idle users guards against compromises via hijacked administrative sessions.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Automatically logging out idle users guards against compromises via hijacked administrative sessions.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^ClientAliveInterval\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"ClientAliveInterval 200\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nClientAliveInterval 200",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239283",
            "RuleID": "SV-239283r674778_rule",
            "StigID": "ESXI-67-000028",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host SSH daemon must limit connections to a single session.",
            "Description": "<VulnDiscussion>The SSH protocol has the ability to provide multiple sessions over a single connection without reauthentication. A compromised client could use this feature to establish additional sessions to a system without consent or knowledge of the user.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The SSH protocol has the ability to provide multiple sessions over a single connection without reauthentication. A compromised client could use this feature to establish additional sessions to a system without consent or knowledge of the user.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^MaxSessions\" /etc/ssh/sshd_config\n\nIf there is no output or the output is not exactly \"MaxSessions 1\", this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \"/etc/ssh/sshd_config\":\n\nMaxSessions 1",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239284",
            "RuleID": "SV-239284r674781_rule",
            "StigID": "ESXI-67-000029",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must remove keys from the SSH authorized_keys file.",
            "Description": "<VulnDiscussion>ESXi hosts come with SSH, which can be enabled to allow remote access without requiring user authentication.\u00a0To enable password-free access, copy the remote user's public key into the \"/etc/ssh/keys-root/authorized_keys\" file on the ESXi host. \n\nThe presence of the remote user's public key in the \"authorized_keys\" file identifies the user as trusted, meaning the user is granted access to the host without providing a password. \n\nIf using Lockdown Mode and SSH is disabled, then logon with authorized keys will have the same restrictions as username/password.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "ESXi hosts come with SSH, which can be enabled to allow remote access without requiring user authentication.\u00a0To enable password-free access, copy the remote user's public key into the \"/etc/ssh/keys-root/authorized_keys\" file on the ESXi host. \n\nThe presence of the remote user's public key in the \"authorized_keys\" file identifies the user as trusted, meaning the user is granted access to the host without providing a password. \n\nIf using Lockdown Mode and SSH is disabled, then logon with authorized keys will have the same restrictions as username/password.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# ls -la /etc/ssh/keys-root/authorized_keys\n\nor\n\n# cat /etc/ssh/keys-root/authorized_keys\n\nIf the \"authorized_keys\" file exists and is not empty, this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, zero out or remove the /etc/ssh/keys-root/authorized_keys file:\n\n# >/etc/ssh/keys-root/authorized_keys\n\nor\n\n# rm /etc/ssh/keys-root/authorized_keys",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239285",
            "RuleID": "SV-239285r674784_rule",
            "StigID": "ESXI-67-000030",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000037-VMM-000150",
            "RuleTitle": "The ESXi host must produce audit records containing information to establish what type of events occurred.",
            "Description": "<VulnDiscussion>Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nSatisfies: SRG-OS-000037-VMM-000150, SRG-OS-000063-VMM-000310</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nSatisfies: SRG-OS-000037-VMM-000150, SRG-OS-000063-VMM-000310",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Config.HostAgent.log.level\" value and verify it is set to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level\n\nIf the \"Config.HostAgent.log.level\" setting is not set to \"info\", this is a finding.\n\nNote: Verbose logging level is acceptable for troubleshooting purposes.",
            "FixText": "From the vSphere Client, select the ESXi Host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"Config.HostAgent.log.level\" value, and configure it to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.log.level | Set-AdvancedSetting -Value \"info\"",
            "CCI": "CCI-000130,CCI-000171"
        },
        {
            "VulnID": "V-239286",
            "RuleID": "SV-239286r674787_rule",
            "StigID": "ESXI-67-000031",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000069-VMM-000360",
            "RuleTitle": "The ESXi host must enforce password complexity by requiring that at least one uppercase character be used.",
            "Description": "<VulnDiscussion>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.\n\nSatisfies: SRG-OS-000069-VMM-000360, SRG-OS-000070-VMM-000370, SRG-OS-000071-VMM-000380, SRG-OS-000078-VMM-000450, SRG-OS-000072-VMM-000390, SRG-OS-000266-VMM-000940</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.\n\nSatisfies: SRG-OS-000069-VMM-000360, SRG-OS-000070-VMM-000370, SRG-OS-000071-VMM-000380, SRG-OS-000078-VMM-000450, SRG-OS-000072-VMM-000390, SRG-OS-000266-VMM-000940",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Security.PasswordQualityControl\" value and verify it is set to \"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl\n\nIf the \"Security.PasswordQualityControl\" setting is not set to \"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"Security.PasswordQualityControl\" value, and configure it to \"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordQualityControl | Set-AdvancedSetting -Value \"similar=deny retry=3 min=disabled,disabled,disabled,disabled,15\"",
            "CCI": "CCI-000192,CCI-000193,CCI-000194,CCI-000195,CCI-000205,CCI-001619"
        },
        {
            "VulnID": "V-239287",
            "RuleID": "SV-239287r674790_rule",
            "StigID": "ESXI-67-000032",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000077-VMM-000440",
            "RuleTitle": "The ESXi host must prohibit the reuse of passwords within five iterations.",
            "Description": "<VulnDiscussion>If a user or root used the same password continuously or was allowed to change it back shortly after being forced to change it to something else, it would provide a potential intruder with the opportunity to keep guessing at one user's password until it was guessed correctly.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If a user or root used the same password continuously or was allowed to change it back shortly after being forced to change it to something else, it would provide a potential intruder with the opportunity to keep guessing at one user's password until it was guessed correctly.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Security.PasswordHistory\" value and verify it is set to \"5\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordHistory\n\nIf the \"Security.PasswordHistory\" setting is not set to \"5\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Security.PasswordHistory\" value and configure it to \"5\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Security.PasswordHistory | Set-AdvancedSetting -Value 5",
            "CCI": "CCI-000200"
        },
        {
            "VulnID": "V-239288",
            "RuleID": "SV-239288r674793_rule",
            "StigID": "ESXI-67-000033",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The password hashes stored on the ESXi host must have been generated using a FIPS 140-2 approved cryptographic hashing algorithm.",
            "Description": "<VulnDiscussion>Systems must employ cryptographic hashes for passwords using the SHA-2 family of algorithms or FIPS 140-2 approved successors. The use of unapproved algorithms may result in weak password hashes more vulnerable to compromise.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Systems must employ cryptographic hashes for passwords using the SHA-2 family of algorithms or FIPS 140-2 approved successors. The use of unapproved algorithms may result in weak password hashes more vulnerable to compromise.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From an SSH session connected to the ESXi host, or from the ESXi shell, run the following command:\n\n# grep -i \"^password\" /etc/pam.d/passwd | grep sufficient\n\nIf sha512 is not listed, this is a finding.",
            "FixText": "From an SSH session connected to the ESXi host, or from the ESXi shell, add or correct the following line in \u201c/etc/pam.d/passwd\u201d:\n\npassword sufficient /lib/security/$ISA/pam_unix.so use_authtok nullok shadow sha512 remember=5",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239289",
            "RuleID": "SV-239289r674796_rule",
            "StigID": "ESXI-67-000034",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000095-VMM-000480",
            "RuleTitle": "The ESXi host must disable the Managed Object Browser (MOB).",
            "Description": "<VulnDiscussion>The MOB provides a way to explore the object model used by the VMkernel to manage the host and enables configurations to be changed as well. This interface is meant to be used primarily for debugging the vSphere SDK, but because there are no access controls it could also be used as a method to obtain information about a host being targeted for unauthorized access.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The MOB provides a way to explore the object model used by the VMkernel to manage the host and enables configurations to be changed as well. This interface is meant to be used primarily for debugging the vSphere SDK, but because there are no access controls it could also be used as a method to obtain information about a host being targeted for unauthorized access.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi Host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Config.HostAgent.plugins.solo.enableMob\" value and verify it is set to \"false\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob\n\nIf the \"Config.HostAgent.plugins.solo.enableMob\" setting is not set to \"false\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi Host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\" and select the \"Config.HostAgent.plugins.solo.enableMob\" value and configure it to \"false\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob | Set-AdvancedSetting -Value false",
            "CCI": "CCI-000381"
        },
        {
            "VulnID": "V-239290",
            "RuleID": "SV-239290r674799_rule",
            "StigID": "ESXI-67-000035",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000095-VMM-000480",
            "RuleTitle": "The ESXi host must be configured to disable nonessential capabilities by disabling SSH.",
            "Description": "<VulnDiscussion>The ESXi Shell is an interactive command line interface (CLI) available at the ESXi server console. The ESXi shell provides temporary access to commands essential for server maintenance. Intended primarily for use in break-fix scenarios, the ESXi shell is well suited for checking and modifying configuration details, not always generally accessible, using the vSphere Client. \n\nThe ESXi shell is accessible remotely using SSH by users with the Administrator role. Under normal operating conditions, SSH access to the host must be disabled as is the default. As with the ESXi shell, SSH is also intended only for temporary use during break-fix scenarios. SSH must therefore be disabled under normal operating conditions and must only be enabled for diagnostics or troubleshooting. Remote access to the host must therefore be limited to the vSphere Client or Host Client at all other times.\n\nSatisfies: SRG-OS-000095-VMM-000480, SRG-OS-000297-VMM-001040, SRG-OS-000298-VMM-001050</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The ESXi Shell is an interactive command line interface (CLI) available at the ESXi server console. The ESXi shell provides temporary access to commands essential for server maintenance. Intended primarily for use in break-fix scenarios, the ESXi shell is well suited for checking and modifying configuration details, not always generally accessible, using the vSphere Client. \n\nThe ESXi shell is accessible remotely using SSH by users with the Administrator role. Under normal operating conditions, SSH access to the host must be disabled as is the default. As with the ESXi shell, SSH is also intended only for temporary use during break-fix scenarios. SSH must therefore be disabled under normal operating conditions and must only be enabled for diagnostics or troubleshooting. Remote access to the host must therefore be limited to the vSphere Client or Host Client at all other times.\n\nSatisfies: SRG-OS-000095-VMM-000480, SRG-OS-000297-VMM-001040, SRG-OS-000298-VMM-001050",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Services. \n\nUnder \"Services\", select \"Edit\", view the \"SSH\" service, and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"}\n\nIf the ESXi SSH service is running, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Services. \n\nUnder \"Services\", select \"SSH\" service and click the \"Stop\" button to stop the service. Use Edit Startup policy to \"Start and stop manually\" and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} | Set-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"SSH\"} | Stop-VMHostService",
            "CCI": "CCI-000381,CCI-002314,CCI-002322"
        },
        {
            "VulnID": "V-239291",
            "RuleID": "SV-239291r674802_rule",
            "StigID": "ESXI-67-000036",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000095-VMM-000480",
            "RuleTitle": "The ESXi host must disable ESXi Shell unless needed for diagnostics or troubleshooting.",
            "Description": "<VulnDiscussion>The ESXi Shell is an interactive command line environment available locally from the DCUI or remotely via SSH. Activities performed from the ESXi Shell bypass vCenter RBAC and audit controls. \n\nThe ESXi shell should only be turned on when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere client.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The ESXi Shell is an interactive command line environment available locally from the DCUI or remotely via SSH. Activities performed from the ESXi Shell bypass vCenter RBAC and audit controls. \n\nThe ESXi shell should only be turned on when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere client.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Services. \n\nUnder \"Services\", select \"Edit\", view the \"ESXi Shell\" service, and verify it is stopped.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"ESXi Shell\"}\n\nIf the ESXi Shell service is running, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Services. \n\nUnder \"Services\", select \"ESXi Shell\" service and click the \"Stop\" button to stop the service. Use Edit Startup policy to \"Start and stop manually\" and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"ESXi Shell\"} | Set-VMHostService -Policy Off\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"ESXi Shell\"} | Stop-VMHostService",
            "CCI": "CCI-000381"
        },
        {
            "VulnID": "V-239292",
            "RuleID": "SV-239292r674805_rule",
            "StigID": "ESXI-67-000037",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000104-VMM-000500",
            "RuleTitle": "The ESXi host must use Active Directory for local user authentication.",
            "Description": "<VulnDiscussion>Join ESXi hosts to an Active Directory (AD) domain to eliminate the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced, and reduces the risk of security breaches and unauthorized access. \n\nNote: If the AD group \"ESX Admins\" (default) exists, then all users and groups that are assigned as members to this group will have full administrative access to all ESXi hosts the domain.\n\nSatisfies: SRG-OS-000104-VMM-000500, SRG-OS-000109-VMM-000550, SRG-OS-000112-VMM-000560, SRG-OS-000113-VMM-000570</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced, and reduces the risk of security breaches and unauthorized access. \n\nNote: If the AD group \"ESX Admins\" (default) exists, then all users and groups that are assigned as members to this group will have full administrative access to all ESXi hosts the domain.\n\nSatisfies: SRG-OS-000104-VMM-000500, SRG-OS-000109-VMM-000550, SRG-OS-000112-VMM-000560, SRG-OS-000113-VMM-000570",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Authentication Services. \n\nVerify the \"Directory Services Type\" is set to \"Active Directory\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostAuthentication\n\nFor systems that do not use Active Directory and have no local user accounts, other than root and/or vpxuser, this is Not Applicable.\n\nFor systems that do not use Active Directory and do have local user accounts, other than root and/or vpxuser, this is a finding.\n\nIf the \"Directory Services Type\" is not set to \"Active Directory\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Authentication Services. \n\nClick \"Join Domain\" and enter the AD domain to join. Select the \"Using credentials\u201d radio button, enter the credentials of an account with permissions to join machines to AD (use UPN naming \u2013 user@domain), and then click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostAuthentication | Set-VMHostAuthentication -JoinDomain -Domain \"domain name\" -User \"username\" -Password \"password\"",
            "CCI": "CCI-000764,CCI-000770,CCI-001941,CCI-001942"
        },
        {
            "VulnID": "V-239293",
            "RuleID": "SV-239293r816572_rule",
            "StigID": "ESXI-67-000038",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000104-VMM-000500",
            "RuleTitle": "ESXi hosts using Host Profiles and/or Auto Deploy must use the vSphere Authentication Proxy to protect passwords when adding themselves to Active Directory.",
            "Description": "<VulnDiscussion>If a host is configured to join an Active Directory domain using Host Profiles and/or Auto Deploy, the Active Directory credentials are saved in the profile and are transmitted over the network. To avoid having to save Active Directory credentials in the Host Profile and to avoid transmitting Active Directory credentials over the network, use the vSphere Authentication Proxy.\n\nSatisfies: SRG-OS-000104-VMM-000500, SRG-OS-000109-VMM-000550, SRG-OS-000112-VMM-000560, SRG-OS-000113-VMM-000570</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If a host is configured to join an Active Directory domain using Host Profiles and/or Auto Deploy, the Active Directory credentials are saved in the profile and are transmitted over the network. To avoid having to save Active Directory credentials in the Host Profile and to avoid transmitting Active Directory credentials over the network, use the vSphere Authentication Proxy.\n\nSatisfies: SRG-OS-000104-VMM-000500, SRG-OS-000109-VMM-000550, SRG-OS-000112-VMM-000560, SRG-OS-000113-VMM-000570",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Home >> Host Profiles and select a Host Profile to edit. \n\nView the settings under Security and Services >> Security Settings >> Authentication Configuration >> Active Directory Configuration >> Join Domain Method. \n\nVerify the method used to join hosts to a domain is set to \"Use vSphere Authentication Proxy to add the host to domain\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Select Name, ` @{N=\"HostProfile\";E={$_ | Get-VMHostProfile}}, ` @{N=\"JoinADEnabled\";E={($_ | Get-VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enabled}}, ` @{N=\"JoinDomainMethod\";E={(($_ | Get-VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory | Select -ExpandProperty Policy | Where {$_.Id -eq \"JoinDomainMethodPolicy\"}).Policyoption.Id}}\n\nVerify that if \"JoinADEnabled\" is \"True\", \"JoinDomainMethod\" is \"FixedCAMConfigOption\".\n\nIf not using Host Profiles to join active directory, this is not a finding.",
            "FixText": "From the vSphere Client, go to Home >> Host Profiles and select a Host Profile to edit. \n\nView the settings under Security and Services >> Security Settings >> Authentication Configuration >> Active Directory Configuration >> Join Domain Method. \n\nSet the method used to join hosts to a domain to \"Use vSphere Authentication Proxy to add the host to domain\" and provide the IP address of the vSphere Authentication Proxy server.",
            "CCI": "CCI-000764,CCI-000770,CCI-001941,CCI-001942"
        },
        {
            "VulnID": "V-239294",
            "RuleID": "SV-239294r674811_rule",
            "StigID": "ESXI-67-000039",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000104-VMM-000500",
            "RuleTitle": "Active Directory ESX Admin group membership must not be used when adding ESXi hosts to Active Directory.",
            "Description": "<VulnDiscussion>When adding ESXi hosts to Active Directory (AD), all user/group accounts assigned to the AD group \"ESX Admins\" will have full administrative access to the host. If this group is not controlled or known to the System Administrators, it may be used for inappropriate access to the host. Therefore, the default group must be changed to a site-specific AD group and membership therein must be severely restricted.\n\nSatisfies: SRG-OS-000104-VMM-000500, SRG-OS-000109-VMM-000550, SRG-OS-000112-VMM-000560, SRG-OS-000113-VMM-000570</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When adding ESXi hosts to Active Directory (AD), all user/group accounts assigned to the AD group \"ESX Admins\" will have full administrative access to the host. If this group is not controlled or known to the System Administrators, it may be used for inappropriate access to the host. Therefore, the default group must be changed to a site-specific AD group and membership therein must be severely restricted.\n\nSatisfies: SRG-OS-000104-VMM-000500, SRG-OS-000109-VMM-000550, SRG-OS-000112-VMM-000560, SRG-OS-000113-VMM-000570",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configuration >> System >> Advanced System Settings. \n\nClick \"Edit\" and select the \"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" value and verify it is not set to \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.hostsvc.esxAdminsGroup\n\nFor systems that do not use Active Directory, this is Not Applicable.\n\nIf the \"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" key is set to \"ESX Admins\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configuration >> System >> Advanced System Settings. \n\nClick \"Edit\" and select the \"Config.HostAgent.plugins.hostsvc.esxAdminsGroup\" key and configure its value to an appropriate Active Directory group other than \"ESX Admins\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.hostsvc.esxAdminsGroup | Set-AdvancedSetting -Value <AD Group>",
            "CCI": "CCI-000764,CCI-000770,CCI-001941,CCI-001942"
        },
        {
            "VulnID": "V-239295",
            "RuleID": "SV-239295r816574_rule",
            "StigID": "ESXI-67-000040",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000107-VMM-000530",
            "RuleTitle": "The ESXi host must use multifactor authentication for local DCUI access to privileged accounts.",
            "Description": "<VulnDiscussion>To ensure accountability and prevent unauthenticated access, privileged users must utilize multifactor authentication to prevent potential misuse and compromise of the system.\n\nNote: This feature requires an existing PKI and AD integration.\n\nSatisfies: SRG-OS-000107-VMM-000530, SRG-OS-000376-VMM-001520, SRG-OS-000377-VMM-001530, SRG-OS-000403-VMM-001640</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To ensure accountability and prevent unauthenticated access, privileged users must utilize multifactor authentication to prevent potential misuse and compromise of the system.\n\nNote: This feature requires an existing PKI and AD integration.\n\nSatisfies: SRG-OS-000107-VMM-000530, SRG-OS-000376-VMM-001520, SRG-OS-000377-VMM-001530, SRG-OS-000403-VMM-001640",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi Host and go to Configure >> System >> Authentication Services and view the Smart Card Authentication status.\n\nIf \"Smart Card Mode\" is \"Disabled\", this is a finding.\n\nFor environments that do not have PKI or AD available, this is Not Applicable.",
            "FixText": "The following are prerequisites to configuration of smart card authentication for the ESXi DCUI: \n\n- Active Directory domain that supports smart card authentication, smart card readers, and smart cards; \n- ESXi joined to an Active Directory domain; and \n- Trusted certificates for root and intermediary certificate authorities. \n\nFrom the vSphere Client, select the ESXi host and go to Configure >> System >> Authentication Services, click \"Edit\", and check the \"Enable Smart Card Authentication\" checkbox.\n\nAt the \"Certificates\" tab, click the green plus sign to import trusted certificate authority certificates and click \"OK\".",
            "CCI": "CCI-000767,CCI-001953,CCI-001954,CCI-002470"
        },
        {
            "VulnID": "V-239296",
            "RuleID": "SV-239296r674817_rule",
            "StigID": "ESXI-67-000041",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000163-VMM-000700",
            "RuleTitle": "The ESXi host must set a timeout to automatically disable idle shell sessions after two minutes.",
            "Description": "<VulnDiscussion>If a user forgets to log out of their local or remote ESXi Shell session, the idle connection will remain open indefinitely and increase the likelihood of inappropriate host access via session hijacking. The \"ESXiShellInteractiveTimeOut\" allows the automatic termination of idle shell sessions.\n\nSatisfies: SRG-OS-000163-VMM-000700, SRG-OS-000279-VMM-001010</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If a user forgets to log out of their local or remote ESXi Shell session, the idle connection will remain open indefinitely and increase the likelihood of inappropriate host access via session hijacking. The \"ESXiShellInteractiveTimeOut\" allows the automatic termination of idle shell sessions.\n\nSatisfies: SRG-OS-000163-VMM-000700, SRG-OS-000279-VMM-001010",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"UserVars.ESXiShellInteractiveTimeOut\" value and verify it is set to \"120\" (2 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut\n\nIf the \"UserVars.ESXiShellInteractiveTimeOut\" setting is not set to \"120\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi Host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"UserVars.ESXiShellInteractiveTimeOut\" value, and configure it to \"120\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellInteractiveTimeOut | Set-AdvancedSetting -Value 120",
            "CCI": "CCI-001133,CCI-002361"
        },
        {
            "VulnID": "V-239297",
            "RuleID": "SV-239297r674820_rule",
            "StigID": "ESXI-67-000042",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000163-VMM-000700",
            "RuleTitle": "The ESXi host must terminate shell services after 10 minutes.",
            "Description": "<VulnDiscussion>When the ESXi Shell or SSH services are enabled on a host, they will run indefinitely. To avoid having these services left running, set the \"ESXiShellTimeOut\". The \"ESXiShellTimeOut\" defines a window of time after which the ESXi Shell and SSH services will be stopped automatically.\n\nSatisfies: SRG-OS-000163-VMM-000700, SRG-OS-000279-VMM-001010</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When the ESXi Shell or SSH services are enabled on a host, they will run indefinitely. To avoid having these services left running, set the \"ESXiShellTimeOut\". The \"ESXiShellTimeOut\" defines a window of time after which the ESXi Shell and SSH services will be stopped automatically.\n\nSatisfies: SRG-OS-000163-VMM-000700, SRG-OS-000279-VMM-001010",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi Host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"UserVars.ESXiShellTimeOut\" value and verify it is set to \"600\" (10 Minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut\n\nIf the \"UserVars.ESXiShellTimeOut\" setting is not set to \"600\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"UserVars.ESXiShellTimeOut\" value, and configure it to \"600\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiShellTimeOut | Set-AdvancedSetting -Value 600",
            "CCI": "CCI-001133,CCI-002361"
        },
        {
            "VulnID": "V-239298",
            "RuleID": "SV-239298r674823_rule",
            "StigID": "ESXI-67-000043",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000163-VMM-000700",
            "RuleTitle": "The ESXi host must log out of the console UI after two minutes.",
            "Description": "<VulnDiscussion>When the direct console user interface (DCUI) is enabled and logged in, it should be automatically logged out if left logged in to avoid access by unauthorized persons. The \"DcuiTimeOut\" setting defines a window of time after which the DCUI will be logged out.\n\nSatisfies: SRG-OS-000163-VMM-000700, SRG-OS-000279-VMM-001010</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When the direct console user interface (DCUI) is enabled and logged in, it should be automatically logged out if left logged in to avoid access by unauthorized persons. The \"DcuiTimeOut\" setting defines a window of time after which the DCUI will be logged out.\n\nSatisfies: SRG-OS-000163-VMM-000700, SRG-OS-000279-VMM-001010",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"UserVars.DcuiTimeOut\" value and verify it is set to \"120\" (2 minutes).\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut\n\nIf the \"UserVars.DcuiTimeOut\" setting is not set to \"120\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"UserVars.DcuiTimeOut\" value, and configure it to \"120\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut | Set-AdvancedSetting -Value 120",
            "CCI": "CCI-001133,CCI-002361"
        },
        {
            "VulnID": "V-239299",
            "RuleID": "SV-239299r816576_rule",
            "StigID": "ESXI-67-000044",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000269-VMM-000950",
            "RuleTitle": "The ESXi host must enable kernel core dumps.",
            "Description": "<VulnDiscussion>In the event of a system failure, the system must preserve any information necessary to determine cause of failure and any information necessary to return to operations with least disruption to mission processes.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "In the event of a system failure, the system must preserve any information necessary to determine cause of failure and any information necessary to return to operations with least disruption to mission processes.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and right-click. \n\nIf the \"Add Diagnostic Partition\" option is greyed out, core dumps are configured.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\n$esxcli = Get-EsxCli -v2\n$esxcli.system.coredump.partition.get.Invoke()\n$esxcli.system.coredump.network.get.Invoke()\n\nThe first command prepares for the other two. The second command shows whether an active core dump partition is configured. The third command shows whether a network core dump collector is configured and enabled via the \"HostVNic\", \"NetworkServerIP\", \"NetworkServerPort\", and \"Enabled\" variables. \n\nIf there is an active core dump partition, via the second command, this is not a finding.\n\nIf there is a network core dump collector configured and enabled, this is not a finding.\n\nIf there is no core dump partition and no network core dump collector configured, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and right-click. Select the \"Add Diagnostic Partition\" option to configure a core dump diagnostic partition.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run at least one of the following sets of commands:\n\nTo configure a core dump partition:\n\n$esxcli = Get-EsxCli -v2\n#View available partitions to configure\n$esxcli.system.coredump.partition.list.Invoke()\n$arguments = $esxcli.system.coredump.partition.set.CreateArgs()\n$arguments.partition = \"<NAA ID of target partition from output listed previously>\"\n$esxcli.system.coredump.partition.set.Invoke($arguments)\n#You can't set the partition and enable it at the same time so now we can enable it\n$arguments = $esxcli.system.coredump.partition.set.CreateArgs()\n$arguments.enable = $true\n$esxcli.system.coredump.partition.set.Invoke($arguments)\n\nTo configure a core dump collector:\n\n$esxcli = Get-EsxCli -v2\n$arguments = $esxcli.system.coredump.network.set.CreateArgs()\n$arguments.interfacename = \"<vmkernel port to use>\"\n$arguments.serverip = \"<collector IP>\"\n$arguments.serverport = \"<collector port>\"\n$arguments = $esxcli.system.coredump.network.set.Invoke($arguments)\n$arguments = $esxcli.system.coredump.network.set.CreateArgs()\n$arguments.enable = $true\n$arguments = $esxcli.system.coredump.network.set.Invoke($arguments)",
            "CCI": "CCI-001665"
        },
        {
            "VulnID": "V-239300",
            "RuleID": "SV-239300r674829_rule",
            "StigID": "ESXI-67-000045",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000341-VMM-001220",
            "RuleTitle": "The ESXi host must enable a persistent log location for all locally stored logs.",
            "Description": "<VulnDiscussion>ESXi can be configured to store log files on an in-memory file system. This occurs when the host's \"/scratch\" directory is linked to \"/tmp/scratch\". When this is done, only a single day's worth of logs is stored at any time. In addition, log files will be reinitialized upon each reboot. This presents a security risk as user activity logged on the host is only stored temporarily and will not persist across reboots. This can also complicate auditing and make it harder to monitor events and diagnose issues. ESXi host logging should always be configured to a persistent datastore.\n\nNote: Scratch space is configured automatically during installation or first boot of an ESXi host and does not usually need to be manually configured. ESXi Installable creates a 4 GB Fat16 partition on the target device during installation if there is sufficient space and if the device is considered \"local\". \n\nIf ESXi is installed on an SD card or USB device, a persistent log location may not be configured upon install as normal.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "ESXi can be configured to store log files on an in-memory file system. This occurs when the host's \"/scratch\" directory is linked to \"/tmp/scratch\". When this is done, only a single day's worth of logs is stored at any time. In addition, log files will be reinitialized upon each reboot. This presents a security risk as user activity logged on the host is only stored temporarily and will not persist across reboots. This can also complicate auditing and make it harder to monitor events and diagnose issues. ESXi host logging should always be configured to a persistent datastore.\n\nNote: Scratch space is configured automatically during installation or first boot of an ESXi host and does not usually need to be manually configured. ESXi Installable creates a 4 GB Fat16 partition on the target device during installation if there is sufficient space and if the device is considered \"local\". \n\nIf ESXi is installed on an SD card or USB device, a persistent log location may not be configured upon install as normal.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Syslog.global.logDir\" value and verify it is set to a persistent location.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\n$esxcli = Get-EsxCli -v2\n$esxcli.system.syslog.config.get.Invoke() | Select LocalLogOutput,LocalLogOutputIsPersistent\n\nIf the \"LocalLogOutputIsPersistent\" value is not true, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\" and select the \"Syslog.global.logDir\" value and set it to a known persistent location.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Syslog.global.logDir | Set-AdvancedSetting -Value \"New Log Location\"",
            "CCI": "CCI-001849"
        },
        {
            "VulnID": "V-239301",
            "RuleID": "SV-239301r674832_rule",
            "StigID": "ESXI-67-000046",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000355-VMM-001330",
            "RuleTitle": "The ESXi host must configure NTP time synchronization.",
            "Description": "<VulnDiscussion>To ensure the accuracy of the system clock, it must be synchronized with an authoritative time source within DoD. Many system functions, including time-based logon and activity restrictions, automated reports, system logs, and audit records, depend on an accurate system clock. If there is no confidence in the correctness of the system clock, time-based functions may not operate as intended and records may be of diminished value.\n\nSatisfies: SRG-OS-000355-VMM-001330, SRG-OS-000356-VMM-001340</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To ensure the accuracy of the system clock, it must be synchronized with an authoritative time source within DoD. Many system functions, including time-based logon and activity restrictions, automated reports, system logs, and audit records, depend on an accurate system clock. If there is no confidence in the correctness of the system clock, time-based functions may not operate as intended and records may be of diminished value.\n\nSatisfies: SRG-OS-000355-VMM-001330, SRG-OS-000356-VMM-001340",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Time Configuration. \n\nClick \"Edit\" to verify the configured NTP servers and service startup policy.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostNTPServer\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"}\n\nIf the NTP service is not configured with authoritative DoD time sources or the service does not have a \"Policy\" of \"on\" or is stopped, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Time Configuration. \n\nClick \"Edit\" to configure the NTP service to start and stop with the host and with authoritative DoD time sources.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\n$NTPServers = \"ntpserver1\",\"ntpserver2\"\nGet-VMHost | Add-VMHostNTPServer $NTPServers\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} | Set-VMHostService -Policy On\nGet-VMHost | Get-VMHostService | Where {$_.Label -eq \"NTP Daemon\"} | Start-VMHostService",
            "CCI": "CCI-001891,CCI-002046"
        },
        {
            "VulnID": "V-239302",
            "RuleID": "SV-239302r674835_rule",
            "StigID": "ESXI-67-000047",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-OS-000366-VMM-001430",
            "RuleTitle": "The ESXi Image Profile and vSphere Installation Bundle (VIB) Acceptance Levels must be verified.",
            "Description": "<VulnDiscussion>Verify the ESXi Image Profile to only allow signed VIBs. An unsigned VIB represents untested code installed on an ESXi host. The ESXi Image profile supports four acceptance levels: \n\n1. VMwareCertified - VIBs created, tested, and signed by VMware\n2. VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware\n3. PartnerSupported - VIBs created, tested, and signed by a certified VMware partner \n4. CommunitySupported - VIBs that have not been tested by VMware or a VMware partner \n\nCommunitySupported VIBs are not supported and do not have a digital signature. To protect the security and integrity of ESXi hosts, do not allow unsigned (CommunitySupported) VIBs to be installed on hosts.\n\nSatisfies: SRG-OS-000366-VMM-001430, SRG-OS-000370-VMM-001460, SRG-OS-000404-VMM-001650</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Verify the ESXi Image Profile to only allow signed VIBs. An unsigned VIB represents untested code installed on an ESXi host. The ESXi Image profile supports four acceptance levels: \n\n1. VMwareCertified - VIBs created, tested, and signed by VMware\n2. VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware\n3. PartnerSupported - VIBs created, tested, and signed by a certified VMware partner \n4. CommunitySupported - VIBs that have not been tested by VMware or a VMware partner \n\nCommunitySupported VIBs are not supported and do not have a digital signature. To protect the security and integrity of ESXi hosts, do not allow unsigned (CommunitySupported) VIBs to be installed on hosts.\n\nSatisfies: SRG-OS-000366-VMM-001430, SRG-OS-000370-VMM-001460, SRG-OS-000404-VMM-001650",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Security Profile. \n\nUnder \"Host Image Profile Acceptance Level\", view the acceptance level.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\n$esxcli = Get-EsxCli -v2\n$esxcli.software.acceptance.get.Invoke()\n\nIf the acceptance level is \"CommunitySupported\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Security Profile. \n\nUnder \"Host Image Profile Acceptance Level\", click \"Edit\".\n\nUsing the pull-down selection, set the acceptance level to be \"VMwareCertified\", \"VMwareAccepted\", or \"PartnerSupported\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\n$esxcli = Get-EsxCli -v2\n$arguments = $esxcli.software.acceptance.set.CreateArgs()\n$arguments.level = \"PartnerSupported\"\n$esxcli.software.acceptance.set.Invoke($arguments)\n\nNote: \"VMwareCertified\" or \"VMwareAccepted\" may be substituted for \"PartnerSupported\", depending on local requirements. These are also case sensitive.",
            "CCI": "CCI-001749,CCI-001774,CCI-002475"
        },
        {
            "VulnID": "V-239303",
            "RuleID": "SV-239303r674838_rule",
            "StigID": "ESXI-67-000048",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000423-VMM-001700",
            "RuleTitle": "The ESXi host must protect the confidentiality and integrity of transmitted information by isolating vMotion traffic.",
            "Description": "<VulnDiscussion>While encrypted vMotion is available now, vMotion traffic should still be sequestered from other traffic to further protect it from attack. This network must be only be accessible to other ESXi hosts preventing outside access to the network.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "While encrypted vMotion is available now, vMotion traffic should still be sequestered from other traffic to further protect it from attack. This network must be only be accessible to other ESXi hosts preventing outside access to the network.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Verify the vMotion VMKernel port group is in a dedicated VLAN, which can be on a common standard or distributed virtual switch as long as the vMotion VLAN is not shared by any other function and is not routed to anything but ESXi hosts.\n\nFor environments that do not use vCenter server to manage ESXi, this is Not Applicable.\n\nThe check for this will be unique per environment. \n\nFrom the vSphere Client, select the ESXi host and go to Configuration >> Networking.\n\nReview the VLAN associated with the vMotion VMkernel(s) and verify it is dedicated for that purpose and logically separated from other functions.\n\nIf long distance or cross-vCenter vMotion is used, the vMotion network can be routable but must be accessible to only the intended ESXi hosts.\n\nIf the vMotion port group is not on an isolated VLAN and/or is routable to systems other than ESXi hosts, this is a finding.",
            "FixText": "Configuration of the vMotion VMkernel will be unique to each environment. \n\nAs an example, to modify the IP address and VLAN information to the correct network on a distributed switch, do the following:\n\nFrom the vSphere Client, go to Networking >> Select a distributed switch >> Select a port group >> Configure >> Settings >> Edit >> VLAN. \n\nChange the \"VLAN Type\" to \"VLAN\" and change the \"VLAN ID\" to a network allocated and dedicated to vMotion traffic exclusively.",
            "CCI": "CCI-002418"
        },
        {
            "VulnID": "V-239304",
            "RuleID": "SV-239304r674841_rule",
            "StigID": "ESXI-67-000049",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000423-VMM-001700",
            "RuleTitle": "The ESXi host must protect the confidentiality and integrity of transmitted information by protecting ESXi management traffic.",
            "Description": "<VulnDiscussion>The vSphere management network provides access to the vSphere management interface on each component. Services running on the management interface provide an opportunity for an attacker to gain privileged access to the systems. Any remote attack most likely would begin with gaining entry to this network.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The vSphere management network provides access to the vSphere management interface on each component. Services running on the management interface provide an opportunity for an attacker to gain privileged access to the systems. Any remote attack most likely would begin with gaining entry to this network.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Verify the Management VMkernel port group is on a dedicated VLAN, which can be on a common standard or distributed virtual switch as long as the Management VLAN is not shared by any other function and is not accessible to anything other than management-related functions such as vCenter. \n\nThe check for this will be unique per environment. \n\nFrom the vSphere Client, select the ESXi host and go to Configure >> Networking.\n\nReview the VLAN associated with the Management VMkernel and verify it is dedicated for that purpose and is logically separated from other functions.\n\nIf the network segment is accessible, except to networks where other management-related entities such as vCenter are located, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> VMkernel adapters. \n\nSelect the Management VMkernel and click \"Edit\".\n\nOn the Port properties tab, uncheck everything but \"Management.\u201d \n\nOn the IP Settings tab, enter the appropriate IP address and subnet information and click \"OK\". \n\nSet the appropriate VLAN ID >> Configure >> Networking >> Virtual switches. \n\nSelect the Management portgroup and click \"Edit\".\n\nOn the properties tab, enter the appropriate VLAN ID and click \"OK\".",
            "CCI": "CCI-002418"
        },
        {
            "VulnID": "V-239305",
            "RuleID": "SV-239305r674844_rule",
            "StigID": "ESXI-67-000050",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000423-VMM-001700",
            "RuleTitle": "The ESXi host must protect the confidentiality and integrity of transmitted information by isolating IP-based storage traffic.",
            "Description": "<VulnDiscussion>Virtual machines might share virtual switches and VLANs with the IP-based storage configurations. IP-based storage includes vSAN, iSCSI, and NFS. This configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network. \n\nTo restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and virtual machines will limit unauthorized users from viewing the traffic.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Virtual machines might share virtual switches and VLANs with the IP-based storage configurations. IP-based storage includes vSAN, iSCSI, and NFS. This configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network. \n\nTo restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and virtual machines will limit unauthorized users from viewing the traffic.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If IP-based storage is not used, this is Not Applicable.\n\nVerify that IP-based storage (iSCSI, NFS, vSAN) VMkernel port groups are in a dedicated VLAN, which can be on a standard or distributed virtual switch that is logically separated from other traffic types. The check for this will be unique per environment. \n\nFrom the vSphere Client, select the ESXi Host and go to Configure >> Networking >> VMkernel adapters.\n\nReview the VLANs associated with any IP-based storage VMkernels and verify it is dedicated for that purpose and logically separated from other functions.\n\nIf any IP-based storage networks are not isolated from other traffic types, this is a finding.",
            "FixText": "Configuration of an IP-Based VMkernel will be unique to each environment. However, as an example, to modify the IP address and VLAN information to the correct network on a standard switch for an iSCSI VMkernel, do the following:\n\nvSAN Example: \nFrom the vSphere Client, select the ESXi host and go to Configure >> Networking >> VMkernel adapters. \n\nSelect the dedicated vSAN VMkernel adapter and click Edit settings.\n\nOn the Port properties tab, uncheck everything but \"vSAN.\u201d \n\nOn the IP Settings tab, enter the appropriate IP address and subnet information and click \"OK\". \n\nSet the appropriate VLAN ID by navigating to Configure >> Networking >> Virtual switches. \n\nSelect the appropriate portgroup (iSCSI, NFS, vSAN) and click Edit settings.\n\nOn the properties tab, enter the appropriate VLAN ID and click \"OK\".",
            "CCI": "CCI-002418"
        },
        {
            "VulnID": "V-239306",
            "RuleID": "SV-239306r674847_rule",
            "StigID": "ESXI-67-000052",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000423-VMM-001700",
            "RuleTitle": "The ESXi host must protect the confidentiality and integrity of transmitted information by using different TCP/IP stacks where possible.",
            "Description": "<VulnDiscussion>Three different TCP/IP stacks are available by default on ESXi: Default, Provisioning, and vMotion. \n\nTo better protect and isolate sensitive network traffic within ESXi, administrators must configure each of these stacks. Additional custom TCP/IP stacks can be created if desired.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Three different TCP/IP stacks are available by default on ESXi: Default, Provisioning, and vMotion. \n\nTo better protect and isolate sensitive network traffic within ESXi, administrators must configure each of these stacks. Additional custom TCP/IP stacks can be created if desired.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> TCP/IP configuration. \n\nReview the default system TCP/IP stacks and verify they are configured with the appropriate IP address information.\n\nIf vMotion and Provisioning VMKernels are in use and are not using their own TCP/IP stack, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> TCP/IP configuration.\n\nSelect a TCP/IP stack and click \"Edit\". \n\nEnter the appropriate site-specific IP address information for the particular TCP/IP stack and click \"OK\".",
            "CCI": "CCI-002418"
        },
        {
            "VulnID": "V-239307",
            "RuleID": "SV-239307r674850_rule",
            "StigID": "ESXI-67-000053",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "SNMP must be configured properly on the ESXi host.",
            "Description": "<VulnDiscussion>If SNMP is not being used, it must remain disabled. If it is being used, the proper trap destination must be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If SNMP is not being used, it must remain disabled. If it is being used, the proper trap destination must be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHostSnmp | Select *\n\nor\n\nFrom an console or ssh session, run the follow command:\n\nesxcli system snmp get\n\nIf SNMP is not in use and is enabled, this is a finding.\n\nIf SNMP is enabled and read-only communities is set to \"public\", this is a finding.\n\nIf SNMP is enabled and is not using v3 targets, this is a finding.\n\nNote: SNMP v3 targets can only be viewed and configured from the esxcli command.",
            "FixText": "To disable SNMP, run the following command from a PowerCLI command prompt while connected to the ESXi Host:\n\nGet-VMHostSnmp | Set-VMHostSnmp -Enabled $false\n\nor\n\nFrom a console or ssh session, run the follow command:\n\nesxcli system snmp set -e no\n\nTo configure SNMP for v3 targets, use the \"esxcli system snmp set\" command set.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239308",
            "RuleID": "SV-239308r674853_rule",
            "StigID": "ESXI-67-000054",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must enable bidirectional CHAP authentication for iSCSI traffic.",
            "Description": "<VulnDiscussion>When enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. There is a potential for a MiTM attack, when not authenticating both the iSCSI target and host, in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. There is a potential for a MiTM attack, when not authenticating both the iSCSI target and host, in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> Storage >> Storage Adapters.\n\nSelect the iSCSI adapter >> Properties >> Authentication method, view the CHAP configuration, and verify CHAP is required for target and host authentication.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostHba | Where {$_.Type -eq \"iscsi\"} | Select AuthenticationProperties -ExpandProperty AuthenticationProperties\n\nIf iSCSI is not used, this is not a finding.\n\nIf iSCSI is used and CHAP is not set to \"required\" for both the target and host, this is a finding.\n\nIf iSCSI is used and unique CHAP secrets are not used for each host, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> Storage >> Storage Adapters.\n\nSelect the iSCSI adapter >> Properties >> Authentication and click the \"Edit\" button. \n\nSet Authentication method to \u201cUse bidirectional CHAP\u201d and enter a unique secret for each traffic flow direction.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostHba | Where {$_.Type -eq \"iscsi\"} | Set-VMHostHba -ChapType Required -ChapName \"chapname\" -ChapPassword \"password\" -MutualChapEnabled $true -MutualChapName \"mutualchapname\" -MutualChapPassword \"mutualpassword\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239309",
            "RuleID": "SV-239309r674856_rule",
            "StigID": "ESXI-67-000055",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must disable Inter-VM transparent page sharing.",
            "Description": "<VulnDiscussion>Published academic papers have demonstrated that by forcing a flush and reload of cache memory, it is possible to measure memory timings to try to determine an AES encryption key in use on another virtual machine running on the same physical processor of the host server if Transparent Page Sharing is enabled between the two virtual machines. This technique works only in a highly controlled system configured in a non-standard way that VMware believes would not be recreated in a production environment.\n\nAlthough VMware believes information being disclosed in real-world conditions is unrealistic, out of an abundance of caution, upcoming ESXi update releases will no longer enable TPS between virtual machines by default (TPS will still be used within individual VMs).</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Published academic papers have demonstrated that by forcing a flush and reload of cache memory, it is possible to measure memory timings to try to determine an AES encryption key in use on another virtual machine running on the same physical processor of the host server if Transparent Page Sharing is enabled between the two virtual machines. This technique works only in a highly controlled system configured in a non-standard way that VMware believes would not be recreated in a production environment.\n\nAlthough VMware believes information being disclosed in real-world conditions is unrealistic, out of an abundance of caution, upcoming ESXi update releases will no longer enable TPS between virtual machines by default (TPS will still be used within individual VMs).",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Mem.ShareForceSalting\" value and verify it is set to \"2\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting\n\nIf the \"Mem.ShareForceSalting\" setting is not set to \"2\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"Mem.ShareForceSalting\" value, and configure it to \"2\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting | Set-AdvancedSetting -Value 2",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239310",
            "RuleID": "SV-239310r674859_rule",
            "StigID": "ESXI-67-000056",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must configure the firewall to restrict access to services running on the host.",
            "Description": "<VulnDiscussion>Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access. Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access. Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Firewall. \n\nUnder the \"Firewall\" section, click \"Edit\".\n\nFor each enabled service, click \"Firewall\" and review the allowed IPs.\n\nCheck this for incoming and outgoing connections.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-VMHostFirewallException | Where {$_.Enabled -eq $true} | Select Name,Enabled,@{N=\"AllIPEnabled\";E={$_.ExtensionData.AllowedHosts.AllIP}}\n\nIf for an enabled service \"Allow connections from any IP address\" is selected, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Firewall. \n\nUnder the \"Firewall\" section, click \"Edit\".\n\nFor each enabled service, uncheck the check box to \u201cAllow connections from any IP address\u201d and input the site-specific network(s) required. \n\nConfigure this for incoming and outgoing connections.\n\nThe following example formats are acceptable:\n\n192.168.0.0/24\n192.168.1.2, 2001::1/64\nfd3e:29a6:0a81:e478::/64\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\n$esxcli = Get-EsxCli -v2\n#This disables the allow all rule for the target service. We are targeting the sshServer service in this example.\n$arguments = $esxcli.network.firewall.ruleset.set.CreateArgs()\n$arguments.rulesetid = \"sshServer\"\n$arguments.allowedall = $false\n$esxcli.network.firewall.ruleset.set.Invoke($arguments)\n\n#Next add the allowed IPs for the service. Note doing the \"vSphere Web Client\" service this way may disable access but may be done through vCenter or through the console.\n$arguments = $esxcli.network.firewall.ruleset.allowedip.add.CreateArgs()\n$arguments.rulesetid = \"sshServer\"\n$arguments.ipaddress = \"10.0.0.0/8\"\n$esxcli.network.firewall.ruleset.allowedip.add.Invoke($arguments)\n\nThis must be done for each enabled service.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239311",
            "RuleID": "SV-239311r674862_rule",
            "StigID": "ESXI-67-000057",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must configure the firewall to block network traffic by default.",
            "Description": "<VulnDiscussion>In addition to service-specific firewall rules, ESXi has a default firewall rule policy to allow or deny incoming and outgoing traffic. Reduce the risk of attack by making sure this is set to deny incoming and outgoing traffic.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "In addition to service-specific firewall rules, ESXi has a default firewall rule policy to allow or deny incoming and outgoing traffic. Reduce the risk of attack by making sure this is set to deny incoming and outgoing traffic.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHostFirewallDefaultPolicy\n\nIf the Incoming or Outgoing policies are \"True\", this is a finding.",
            "FixText": "From a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHostFirewallDefaultPolicy | Set-VMHostFirewallDefaultPolicy -AllowIncoming $false -AllowOutgoing $false",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239312",
            "RuleID": "SV-239312r674865_rule",
            "StigID": "ESXI-67-000058",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must enable BPDU filter on the host to prevent being locked out of physical switch ports with Portfast and BPDU Guard enabled.",
            "Description": "<VulnDiscussion>BPDU Guard and Portfast are commonly enabled on the physical switch to which the ESXi host is directly connected to reduce the STP convergence delay. \n\nIf a BPDU packet is sent from a virtual machine on the ESXi host to the physical switch so configured, a cascading lockout of all the uplink interfaces from the ESXi host can occur. To prevent this type of lockout, BPDU Filter can be enabled on the ESXi host to drop any BPDU packets being sent to the physical switch. \n\nThe caveat is that certain SSL VPNs that use Windows bridging capability can legitimately generate BPDU packets. The administrator should verify that there are no legitimate BPDU packets generated by virtual machines on the ESXi host prior to enabling BPDU Filter. If BPDU Filter is enabled in this situation, enabling Reject Forged Transmits on the virtual switch port group adds protection against Spanning Tree loops.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "BPDU Guard and Portfast are commonly enabled on the physical switch to which the ESXi host is directly connected to reduce the STP convergence delay. \n\nIf a BPDU packet is sent from a virtual machine on the ESXi host to the physical switch so configured, a cascading lockout of all the uplink interfaces from the ESXi host can occur. To prevent this type of lockout, BPDU Filter can be enabled on the ESXi host to drop any BPDU packets being sent to the physical switch. \n\nThe caveat is that certain SSL VPNs that use Windows bridging capability can legitimately generate BPDU packets. The administrator should verify that there are no legitimate BPDU packets generated by virtual machines on the ESXi host prior to enabling BPDU Filter. If BPDU Filter is enabled in this situation, enabling Reject Forged Transmits on the virtual switch port group adds protection against Spanning Tree loops.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Net.BlockGuestBPDU\" value and verify it is set to \"1\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.BlockGuestBPDU\n\nIf the \"Net.BlockGuestBPDU\" setting is not set to \"1\", this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"Net.BlockGuestBPDU\" value, and configure it to \"1\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.BlockGuestBPDU | Set-AdvancedSetting -Value 1",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239313",
            "RuleID": "SV-239313r674868_rule",
            "StigID": "ESXI-67-000059",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The virtual switch Forged Transmits policy must be set to reject on the ESXi host.",
            "Description": "<VulnDiscussion>If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. \n \nThis means the virtual switch does not compare the source and effective MAC addresses. \n \nTo protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject. Reject Forged Transmit can be set at the vSwitch and/or the Portgroup level. Switch-level settings can be overridden at the Portgroup level.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. \n \nThis means the virtual switch does not compare the source and effective MAC addresses. \n \nTo protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject. Reject Forged Transmit can be set at the vSwitch and/or the Portgroup level. Switch-level settings can be overridden at the Portgroup level.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Configure >> Networking >> Virtual Switches. \n\nView the properties on each virtual switch and port group and verify \"Forged Transmits\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \"Forged Transmits\" policy is set to accept (or true, via PowerCLI), this is a finding.",
            "FixText": "From the vSphere Client, go to Configure >> Networking >> Virtual Switches. \n\nFor each virtual switch and port group, click Edit settings (dots) and change \"Forged Transmits\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmits $false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy -ForgedTransmitsInherited $true",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239314",
            "RuleID": "SV-239314r674871_rule",
            "StigID": "ESXI-67-000060",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The virtual switch MAC Address Change policy must be set to reject on the ESXi host.",
            "Description": "<VulnDiscussion>If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. \n\nThis will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality, how a layer 2 bridge will operate, and applications that require a specific MAC address for licensing. Reject MAC Changes can be set at the vSwitch and/or the Portgroup level. Switch-level settings can be overridden at the Portgroup level.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. \n\nThis will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality, how a layer 2 bridge will operate, and applications that require a specific MAC address for licensing. Reject MAC Changes can be set at the vSwitch and/or the Portgroup level. Switch-level settings can be overridden at the Portgroup level.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Configure >> Networking >> Virtual Switches. \n\nView the properties on each virtual switch and port group and verify \"MAC Address Changes\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \"MAC Address Changes\" policy is set to accept (or true, via PowerCLI), this is a finding.",
            "FixText": "From the vSphere Client, go to Configure >> Networking >> Virtual Switches. \n\nFor each virtual switch and port group, click Edit settings (dots) and change \"MAC Address Changes\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -MacChanges $false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy -MacChangesInherited $true",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239315",
            "RuleID": "SV-239315r674874_rule",
            "StigID": "ESXI-67-000061",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The virtual switch Promiscuous Mode policy must be set to reject on the ESXi host.",
            "Description": "<VulnDiscussion>When Promiscuous Mode is enabled for a virtual switch, all virtual machines connected to the Portgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that Portgroup. \n\nPromiscuous Mode is disabled by default on the ESXi Server, and this is the recommended setting. Promiscuous Mode can be set at the vSwitch and/or the Portgroup level. Switch-level settings can be overridden at the Portgroup level.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When Promiscuous Mode is enabled for a virtual switch, all virtual machines connected to the Portgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that Portgroup. \n\nPromiscuous Mode is disabled by default on the ESXi Server, and this is the recommended setting. Promiscuous Mode can be set at the vSwitch and/or the Portgroup level. Switch-level settings can be overridden at the Portgroup level.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Configure >> Networking >> Virtual Switches. \n\nView the properties on each virtual switch and port group and verify that \"Promiscuous Mode\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy\nGet-VirtualPortGroup | Get-SecurityPolicy\n\nIf the \"Promiscuous Mode\" policy is set to accept (or true, via PowerCLI), this is a finding.",
            "FixText": "From the vSphere Client go to Configure >> Networking >> Virtual Switches. \n\nFor each virtual switch and port group, click Edit settings (dots) and change \"Promiscuous Mode\" to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following commands:\n\nGet-VirtualSwitch | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuous $false\nGet-VirtualPortGroup | Get-SecurityPolicy | Set-SecurityPolicy -AllowPromiscuousInherited $true",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239316",
            "RuleID": "SV-239316r674877_rule",
            "StigID": "ESXI-67-000062",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must prevent unintended use of the dvFilter network APIs.",
            "Description": "<VulnDiscussion>If the organization is not using products that use the dvfilter network API, the host should not be configured to send network information to a VM. \n\nIf the API is enabled, an attacker might attempt to connect a VM to it, potentially providing access to the network of other VMs on the host. If the organization is using a product that uses this API, verify that the host has been configured correctly. If the organization is not using such a product, ensure the setting is blank.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If the organization is not using products that use the dvfilter network API, the host should not be configured to send network information to a VM. \n\nIf the API is enabled, an attacker might attempt to connect a VM to it, potentially providing access to the network of other VMs on the host. If the organization is using a product that uses this API, verify that the host has been configured correctly. If the organization is not using such a product, ensure the setting is blank.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> System >> Advanced System Settings. \n\nSelect the \"Net.DVFilterBindIpAddress\" value and verify the value is blank or the correct IP address of a security appliance if in use.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.DVFilterBindIpAddress\n\nIf the \"Net.DVFilterBindIpAddress\" is not blank and security appliances are not in use on the host, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi Host and go to Configure >> System >> Advanced System Settings. \n\nClick \"Edit\", select the \"Net.DVFilterBindIpAddress\" value, and remove any incorrect addresses.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name Net.DVFilterBindIpAddress | Set-AdvancedSetting -Value \"\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239317",
            "RuleID": "SV-239317r674880_rule",
            "StigID": "ESXI-67-000063",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "For the ESXi host, all port groups must be configured to a value other than that of the native VLAN.",
            "Description": "<VulnDiscussion>ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to the native VLAN of the physical switch. \n\nFor example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \"1\"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \"1\" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). \n\nIf the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch because the switch is expecting untagged traffic.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to the native VLAN of the physical switch. \n\nFor example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \"1\"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \"1\" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). \n\nIf the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch because the switch is expecting untagged traffic.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. \n\nFor each virtual switch, review the port group VLAN tags and verify they are not set to the native VLAN ID of the attached physical switch.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VirtualPortGroup | Select Name, VLanId\n\nIf any port group is configured with the native VLAN of the attached physical switch, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. \n\nHighlight the port group where VLAN ID is set to native VLAN ID and click Edit settings (dots). \n\nChange the VLAN ID to a non-native VLAN and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VirtualPortGroup -Name \"portgroup name\" | Set-VirtualPortGroup -VLanId \"New VLAN#\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239318",
            "RuleID": "SV-239318r674883_rule",
            "StigID": "ESXI-67-000064",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "For the ESXi host, all port groups must not be configured to VLAN 4095 unless Virtual Guest Tagging (VGT) is required.",
            "Description": "<VulnDiscussion>When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest VM without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself. If VGT is enabled inappropriately, it might cause denial of service or allow a guest VM to interact with traffic on an unauthorized VLAN.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest VM without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself. If VGT is enabled inappropriately, it might cause denial of service or allow a guest VM to interact with traffic on an unauthorized VLAN.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. \n\nFor each virtual switch, review the port group VLAN tags and verify they are not set to 4095.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VirtualPortGroup | Select Name, VLanID\n\nIf any port group is configured with VLAN 4095 and is not documented as a needed exception, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. \n\nHighlight a port group where VLAN ID is set to 4095 and click Edit settings (dots). \n\nChange the VLAN ID to an appropriate VLAN and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VirtualPortGroup -Name \"portgroup name\" | Set-VirtualPortGroup -VLanId \"New VLAN#\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239319",
            "RuleID": "SV-239319r674886_rule",
            "StigID": "ESXI-67-000065",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "For the ESXi host, all port groups must not be configured to VLAN values reserved by upstream physical switches.",
            "Description": "<VulnDiscussion>Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001-1024 and 4094, while Nexus switches typically reserve 3968-4047 and 4094. Check the documentation for the specific switch. Using a reserved VLAN might result in a denial of service on the network.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001-1024 and 4094, while Nexus switches typically reserve 3968-4047 and 4094. Check the documentation for the specific switch. Using a reserved VLAN might result in a denial of service on the network.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. For each virtual switch, review the port group VLAN tags and verify they are not set to a reserved VLAN ID.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VirtualPortGroup | Select Name, VLanId\n\nIf any port group is configured with a reserved VLAN ID, this is a finding.",
            "FixText": "From the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. \n\nHighlight a port group where VLAN ID is set to a reserved value and click \"Edit\" settings (dots). \n\nChange the VLAN ID to an appropriate VLAN and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VirtualPortGroup -Name \"portgroup name\" | Set-VirtualPortGroup -VLanId \"New VLAN#\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239320",
            "RuleID": "SV-239320r674889_rule",
            "StigID": "ESXI-67-000066",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "For physical switch ports connected to the ESXi host, the non-negotiate option must be configured for trunk links between external physical switches and virtual switches in Virtual Switch Tagging (VST) mode.",
            "Description": "<VulnDiscussion>To communicate with virtual switches in VST mode, external switch ports must be configured as trunk ports. VST mode does not support Dynamic Trunking Protocol (DTP), so the trunk must be static and unconditional. The auto or desirable physical switch settings do not work with the ESXi Server because the physical switch communicates with the ESXi Server using DTP. \n\nThe non-negotiate and on options unconditionally enable VLAN trunking on the physical switch and create a VLAN trunk link between the ESXi Server and the physical switch. The difference between non-negotiate and on options is that on mode still sends out DTP frames, whereas the non-negotiate option does not. The non-negotiate option should be used for all VLAN trunks to minimize unnecessary network traffic for virtual switches in VST mode.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To communicate with virtual switches in VST mode, external switch ports must be configured as trunk ports. VST mode does not support Dynamic Trunking Protocol (DTP), so the trunk must be static and unconditional. The auto or desirable physical switch settings do not work with the ESXi Server because the physical switch communicates with the ESXi Server using DTP. \n\nThe non-negotiate and on options unconditionally enable VLAN trunking on the physical switch and create a VLAN trunk link between the ESXi Server and the physical switch. The difference between non-negotiate and on options is that on mode still sends out DTP frames, whereas the non-negotiate option does not. The non-negotiate option should be used for all VLAN trunks to minimize unnecessary network traffic for virtual switches in VST mode.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note that this check refers to an entity outside the physical scope of the ESXi server system. The configuration of external switch ports as trunk ports must be documented. VST mode does not support DTP, so the trunk must be static and unconditional. \n\nInspect the documentation and verify that it is correct and updated according to an organization-defined frequency and/or whenever modifications are made to either ESXi hosts or the upstream external switch ports.\n\nIf DTP is enabled on the physical switch ports connected to the ESXi host, this is a finding.",
            "FixText": "Note that this check refers to an entity outside the physical scope of the ESXi server system. \n\nDocument the configuration of external switch ports as trunk ports. \n\nLog in to the vendor-specific physical switch and disable DTP on the physical switch ports connected to the ESXi host. \n\nUpdate the documentation according to an organization-defined frequency or whenever modifications are made to either ESXi hosts or the upstream external switch ports.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239321",
            "RuleID": "SV-239321r674892_rule",
            "StigID": "ESXI-67-000067",
            "Severity": "low",
            "Cat": "CAT III",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "All ESXi host-connected physical switch ports must be configured with spanning tree disabled.",
            "Description": "<VulnDiscussion>Since VMware virtual switches do not support STP, the ESXi host-connected physical switch ports must have portfast configured if spanning tree is enabled to avoid loops within the physical switch network. If these are not set, potential performance and connectivity issues might arise.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Since VMware virtual switches do not support STP, the ESXi host-connected physical switch ports must have portfast configured if spanning tree is enabled to avoid loops within the physical switch network. If these are not set, potential performance and connectivity issues might arise.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note that this check refers to an entity outside the physical scope of the ESXi server system. The configuration of upstream physical switches must be documented to ensure that spanning tree protocol is disabled and/or portfast is configured for all physical ports connected to ESXi hosts. \n\nInspect the documentation and verify that the documentation is updated according to an organization-defined frequency and/or whenever modifications are made to either ESXi hosts or the upstream physical switches. \n\nAlternatively, log in to the physical switch and verify that spanning tree protocol is disabled and/or portfast is configured for all physical ports connected to ESXi hosts.\n\nIf the physical switch's spanning tree protocol is not disabled or portfast is not configured for all physical ports connected to ESXi hosts, this is a finding.",
            "FixText": "Note that this check refers to an entity outside the scope of the ESXi server system. \n\nDocument the upstream physical switch configuration for spanning tree protocol disablement and/or portfast configuration for all physical ports connected to ESXi hosts. \n\nLog in to the physical switch(es) and disable spanning tree protocol and/or configure portfast for all physical ports connected to ESXi hosts. \n\nUpdate the documentation on an organization defined frequency or whenever modifications are made to either ESXi hosts or the upstream physical switches.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239322",
            "RuleID": "SV-239322r674895_rule",
            "StigID": "ESXI-67-000068",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "All ESXi host-connected virtual switch VLANs must be fully documented and have only the required VLANs.",
            "Description": "<VulnDiscussion>When defining a physical switch port for trunk mode, only specified VLANs must be configured on the VLAN trunk link. The risk with not fully documenting all VLANs on the vSwitch is that it is possible that a physical trunk port might be configured without needed VLANs, or with unneeded VLANs. This could enable an administrator to either accidentally or maliciously connect a VM to an unauthorized VLAN.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When defining a physical switch port for trunk mode, only specified VLANs must be configured on the VLAN trunk link. The risk with not fully documenting all VLANs on the vSwitch is that it is possible that a physical trunk port might be configured without needed VLANs, or with unneeded VLANs. This could enable an administrator to either accidentally or maliciously connect a VM to an unauthorized VLAN.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note that this check refers to an entity outside the physical scope of the ESXi server system. The configuration of upstream physical switches must be documented to ensure that unneeded VLANs are configured for all physical ports connected to ESXi hosts. \n\nInspect the documentation and verify that the documentation is updated according to an organization-defined frequency and/or whenever modifications are made to either ESXi hosts or the upstream physical switches. \n\nAlternatively, log in to the physical switch and verify that only needed VLANs are configured for all physical ports connected to ESXi hosts.\n\nIf the physical switch's configuration is trunked VLANs that are not used by ESXi for all physical ports connected to ESXi hosts, this is a finding.",
            "FixText": "Note that this check refers to an entity outside the scope of the ESXi server system.\n\nRemove any VLANs trunked across physical ports connected to ESXi hosts that are not in use.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239323",
            "RuleID": "SV-239323r674898_rule",
            "StigID": "ESXI-67-000070",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must not provide root/administrator-level access to CIM-based hardware monitoring tools or other third-party applications.",
            "Description": "<VulnDiscussion>The CIM system provides an interface that enables hardware-level management from remote applications via a set of standard APIs. Create a limited-privilege, read-only service account for CIM. Grant this role to the user on the ESXi server. Place this user in the Exception Users list. When/where write access is required, create/enable a limited-privilege service account and grant only the minimum required privileges.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The CIM system provides an interface that enables hardware-level management from remote applications via a set of standard APIs. Create a limited-privilege, read-only service account for CIM. Grant this role to the user on the ESXi server. Place this user in the Exception Users list. When/where write access is required, create/enable a limited-privilege service account and grant only the minimum required privileges.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the Host Client, select the ESXi host, right-click and go to \"Permissions\". \n\nVerify the CIM account user role is limited to read only and CIM permissions.\n\nIf there is no dedicated CIM account and the root is used for CIM monitoring, this is a finding.\n\nIf write access is not required and the access level is not \"read-only\", this is a finding.",
            "FixText": "Create a role for the CIM account:\n\nFrom the Host Client, go to Manage >> Security & Users. \n\nSelect \"Roles\" and click \"Add Role\". \n\nProvide a name for the new role and select Host >> Cim >> Ciminteraction and click \"Add\".\n\nAdd a CIM user account:\n\nFrom the Host Client, go to Manage >> Security & Users. \n\nSelect \"Users\" and click \"Add User\". \n\nProvide a name, description, and password for the new user and click \"Add\".\n\nAssign the CIM account permissions to the host with the new role.\n\nFrom the Host Client, select the ESXi host, right-click, and go to \"Permissions\". \n\nClick \"Add User\", select the CIM account from the drop-down list, select the new CIM role from the drop-down list, and click \"Add User\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239324",
            "RuleID": "SV-239324r674901_rule",
            "StigID": "ESXI-67-000071",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The SA must verify the integrity of the installation media before installing ESXi.",
            "Description": "<VulnDiscussion>Always check the SHA1 or MD5 hash after downloading an ISO, offline bundle, or patch to ensure integrity and authenticity of the downloaded files.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Always check the SHA1 or MD5 hash after downloading an ISO, offline bundle, or patch to ensure integrity and authenticity of the downloaded files.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "The downloaded ISO, offline bundle, or patch hash must be verified against the vendor's checksum to ensure the integrity and authenticity of the files. \n\nSee some typical command line example(s) for both the md5 and sha1 hash check(s) below:\n\n# md5sum <filename>.iso\n# sha1sum <filename>.iso\n\nIf any of the system's downloaded ISO, offline bundle, or system patch hashes cannot be verified against the vendor's checksum, this is a finding.",
            "FixText": "If the hash returned from the \"md5sum\" or \"sha1sum\" commands do not match the vendor's hash, the downloaded software must be discarded. \n\nIf the physical media is obtained from VMware and the security seal is broken, the software must be returned to VMware for replacement.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239325",
            "RuleID": "SV-239325r674904_rule",
            "StigID": "ESXI-67-000072",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must have all security patches and updates installed.",
            "Description": "<VulnDiscussion>Installing software updates is a fundamental mitigation against the exploitation of publicly known vulnerabilities.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Installing software updates is a fundamental mitigation against the exploitation of publicly known vulnerabilities.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If vCenter Update Manager is used on the network, it can be used to scan all hosts for missing patches.\n\nFrom the vSphere Client, go to Hosts and Clusters >> Updates. \n\nCheck under \"Attached Baselines\" and verify that a compliance check has been run.\n\nIf vCenter Update Manager is not used, host compliance status must be determined manually by the build number. \n\nVMware KB 1014508 can be used to correlate patches with build numbers.\n\nIf the ESXi host does not have the latest patches, this is a finding.\n\nIf the ESXi host is not on a supported release, this is a finding.\n\nVMware also publishes Advisories on security patches and offers a way to subscribe to email alerts for them. \n\nGo to: https://www.vmware.com/support/policies/security_response",
            "FixText": "If vCenter Update Manager is used on the network, hosts can be remediated from the vSphere Web Client. \n\nFrom the vSphere Client, go to Hosts and Clusters >> Updates. \n\nCheck under \"Attached Baselines\". If there are no baselines attached, select the drop-down \"Attach >> Attach Baseline or Baseline Group\". Select \"attach\" and select the type of patches. \n\nClick on Check Compliance to check Host(s) Compliance.\n\nTo manually remediate a host, the patch file must be copied locally and the following command run from an SSH session connected to the ESXi host or from the ESXi shell:\n\nesxcli software vib update -d <path to offline patch bundle.zip>",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239326",
            "RuleID": "SV-239326r674907_rule",
            "StigID": "ESXI-67-000074",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must exclusively enable TLS 1.2 for all endpoints.",
            "Description": "<VulnDiscussion>TLS 1.0 and 1.1 are deprecated protocols with well-published shortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces and SSLv3, TL 1.1, and 1.0 disabled where supported. \n\nMandating TLS 1.2 may break third-party integrations and add-ons to vSphere. Test these integrations carefully after implementing TLS 1.2 and roll back where appropriate. \n\nOn interfaces where required functionality is broken with TLS 1.2 this finding is not applicable until the third-party software supports TLS 1.2.\n\nBe sure to modify TLS settings in the following order: \n\n1. Platform Services Controllers (if applicable) \n2. vCenter\n3. ESXi</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "TLS 1.0 and 1.1 are deprecated protocols with well-published shortcomings and vulnerabilities. TLS 1.2 should be enabled on all interfaces and SSLv3, TL 1.1, and 1.0 disabled where supported. \n\nMandating TLS 1.2 may break third-party integrations and add-ons to vSphere. Test these integrations carefully after implementing TLS 1.2 and roll back where appropriate. \n\nOn interfaces where required functionality is broken with TLS 1.2 this finding is not applicable until the third-party software supports TLS 1.2.\n\nBe sure to modify TLS settings in the following order: \n\n1. Platform Services Controllers (if applicable) \n2. vCenter\n3. ESXi",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Web Client, select the host and click Configure >> System >> Advanced System Settings. \n\nFind the \"UserVars.ESXiVPsDisabledProtocols\" value and verify that it is set to the following:\n\ntlsv1,tlsv1.1,sslv3\n\nIf the value is not set as above or it does not exist, this is a finding.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiVPsDisabledProtocols\n\nIf the value returned is not \"tlsv1,tlsv1.1,sslv3\" or the setting does not exist, this is a finding.",
            "FixText": "From the vSphere Web Client, select the host and click Configure >> System >> Advanced System Settings. \n\nFind the \"UserVars.ESXiVPsDisabledProtocols\" value and set it to the following:\n\ntlsv1,tlsv1.1,sslv3\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.ESXiVPsDisabledProtocols | Set-AdvancedSetting -Value \"tlsv1,tlsv1.1,sslv3\"\n\nA host reboot is required for changes to take effect.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239327",
            "RuleID": "SV-239327r674910_rule",
            "StigID": "ESXI-67-000076",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must enable Secure Boot.",
            "Description": "<VulnDiscussion>Secure Boot is a protocol of UEFI firmware that ensures the integrity of the boot process from hardware up through to the OS. Secure Boot for ESXi requires support from the firmware and requires that all ESXi kernel modules, drivers, and vSphere Installation Bundles (VIBs) be signed by VMware or a partner subordinate.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Secure Boot is a protocol of UEFI firmware that ensures the integrity of the boot process from hardware up through to the OS. Secure Boot for ESXi requires support from the firmware and requires that all ESXi kernel modules, drivers, and vSphere Installation Bundles (VIBs) be signed by VMware or a partner subordinate.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Temporarily enable SSH, connect to the ESXi host, and run the following command:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -s\n\nIf the output is not \"Enabled\", this is a finding.",
            "FixText": "Temporarily enable SSH, connect to the ESXi host, and run the following command:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -c\n\nIf the output indicates that Secure Boot cannot be enabled, correct the discrepancies and try again. If the discrepancies cannot be rectified, this finding is downgraded to a CAT III.\n\nConsult vendor documentation and boot the host into BIOS setup mode. Enable UEFI boot mode and Secure Boot. Restart the host.\n\nTemporarily enable SSH, connect to the ESXi host, and run the following command to verify that Secure Boot is enabled:\n\n/usr/lib/vmware/secureboot/bin/secureBoot.py -s",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239328",
            "RuleID": "SV-239328r674913_rule",
            "StigID": "ESXI-67-000078",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must use DoD-approved certificates.",
            "Description": "<VulnDiscussion>The default self-signed, VMware Certificate Authority-issued host certificate must be replaced with a DoD-approved certificate when the host will be accessed directly, such as during a VM console connection. \n\nThe use of a DoD certificate on the host assures clients that the service they are connecting to is legitimate and properly secured.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The default self-signed, VMware Certificate Authority-issued host certificate must be replaced with a DoD-approved certificate when the host will be accessed directly, such as during a VM console connection. \n\nThe use of a DoD certificate on the host assures clients that the service they are connecting to is legitimate and properly secured.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Web Client, select the host and click Configure >> System >> Certificate.\n\nIf the issuer is not a DoD-approved certificate authority, this is a finding.\n\nIf the host will never be accessed directly (VM console connections bypass vCenter), this is not a finding.",
            "FixText": "Obtain a DoD-issued certificate and private key for the host following the requirements below:\n\nKey size: 2048 bits or more (PEM encoded) \n\nKey format: PEM; VMware supports PKCS8 and PKCS1 (RSA keys) \nx509 version 3\n\nSubjectAltName must contain DNS Name=<machine_FQDN>\n\nCRT (Base-64) format\n\nContains the following Key Usages: Digital Signature, Non Repudiation, Key Encipherment\n\nStart time of one day before the current time.\n\nCN (and SubjectAltName) set to the host name (or IP address) that the ESXi host has in the vCenter Server inventory.\n\nPut the host into maintenance mode.\n\nTemporarily enable SSH on the host. SCP the new certificate and key to /tmp. SSH to the host. Back up the existing certificate and key: \n\nmv /etc/vmware/ssl/rui.crt /etc/vmware/ssl/rui.crt.bak\nmv /etc/vmware/ssl/rui.key /etc/vmware/ssl/rui.key.bak\n\nCopy the new certificate and key to /etc/vmware/ssl/ and rename them to rui.crt and rui.key respectively. Restart management agents to implement the new certificate: \n\nservices.sh restart\n\nFrom the vSphere Web Client, select the vCenter Server and click Configure >> System >> Advanced Settings. \n\nFind the \"vpxd.certmgmt value\" and set it to \"custom\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239329",
            "RuleID": "SV-239329r674916_rule",
            "StigID": "ESXI-67-000079",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000480-VMM-002000",
            "RuleTitle": "The ESXi host must not suppress warnings that the local or remote shell sessions are enabled.",
            "Description": "<VulnDiscussion>Warnings that local or remote shell sessions are enabled alert administrators to activity that they may not be aware of and need to investigate.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Warnings that local or remote shell sessions are enabled alert administrators to activity that they may not be aware of and need to investigate.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Web Client, select the host and click Configure >> System >> Advanced System Settings. \n\nFind the \"UserVars.SuppressShellWarning\" value and verify that it is set to the following:\n\n0\n\nIf the value is not set as above or does not exist, this is a finding.\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.SuppressShellWarning\n\nIf the value returned is not \"0\" or the setting does not exist, this is a finding.",
            "FixText": "From the vSphere Web Client, select the host and click Configure >> System >> Advanced System Settings. \n\nFind the \"UserVars.SuppressShellWarning\" value and set it to the following:\n\n0\n\nor\n\nFrom a PowerCLI command prompt while connected to the ESXi host, run the following command:\n\nGet-VMHost | Get-AdvancedSetting -Name UserVars.SuppressShellWarning | Set-AdvancedSetting -Value \"0\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-239331",
            "RuleID": "SV-239331r816580_rule",
            "StigID": "ESXI-67-100010",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-OS-000478-VMM-001980",
            "RuleTitle": "The ESXi host SSH daemon must be configured to only use FIPS 140-2 approved ciphers.",
            "Description": "<VulnDiscussion>Approved algorithms should impart some level of confidence in their implementation. These are also required for compliance.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Approved algorithms should impart some level of confidence in their implementation. These are also required for compliance.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Verify that only FIPS-approved ciphers are used by running the following command: \n\n# grep -i \"^Ciphers\" /etc/ssh/sshd_config\n\nIf there is no output, or the output is not exactly \"Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\", this is a finding.",
            "FixText": "Limit the ciphers to algorithms that are FIPS approved. Counter (CTR) mode is also preferred over cipher-block chaining (CBC) mode. \n\nAdd or correct the following line in \"/etc/ssh/sshd_config\": \n\nCiphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr",
            "CCI": "CCI-002450"
        }
    ]
}