{
    "Title": "VMware vSphere 6.7 vCenter Security Technical Implementation Guide",
    "Description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.",
    "Version": "1",
    "Release": "3 ",
    "BenchmarkDate": "27 Oct 2022",
    "ReleaseInfo": "Release: 3 Benchmark Date: 27 Oct 2022",
    "Source": "STIG.DOD.MIL",
    "Notice": "terms-of-use",
    "Rules": [
        {
            "VulnID": "V-243072",
            "RuleID": "SV-243072r719459_rule",
            "StigID": "VCTR-67-000001",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000165",
            "RuleTitle": "The vCenter Server must prohibit password reuse for a minimum of five generations.",
            "Description": "<VulnDiscussion>Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nTo meet password policy requirements, passwords need to be changed at specific policy-based intervals. \n\nIf the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nTo meet password policy requirements, passwords need to be changed at specific policy-based intervals. \n\nIf the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nView the value of the \"Restrict reuse\" setting.\n\nIf the \"Restrict reuse\" policy is not set to \"5\" or more, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nClick \"Edit\".\n\nEnter \"5\" into the \"Restrict reuse\" setting and click \"OK\".",
            "CCI": "CCI-000200"
        },
        {
            "VulnID": "V-243073",
            "RuleID": "SV-243073r719462_rule",
            "StigID": "VCTR-67-000002",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000190",
            "RuleTitle": "The vCenter Server must not automatically refresh client sessions.",
            "Description": "<VulnDiscussion>Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. Automatic client session refreshes keep unused sessions online, blocking session timeouts.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. Automatic client session refreshes keep unused sessions online, blocking session timeouts.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Windows, this is not applicable.\n\nOn the vCenter Server, execute the following command:\n\n#  grep \"^refresh\\.rate\" /etc/vmware/vsphere-client/webclient.properties\n\nExpected result:\n\nrefresh.rate = -1\n\nIf the output does not match the expected result, this is a finding.",
            "FixText": "Navigate to and open /etc/vmware/vsphere-ui/webclient.properties. Remove any existing \"refresh.rate\" line and add the following:\n\nrefresh.rate = -1\n\nAfter editing the file, the vSphere Client service must be restarted.\n\n# service-control --restart vsphere-client",
            "CCI": "CCI-001133"
        },
        {
            "VulnID": "V-243074",
            "RuleID": "SV-243074r719465_rule",
            "StigID": "VCTR-67-000003",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000174",
            "RuleTitle": "The vCenter Server must enforce a 60-day maximum password lifetime restriction.",
            "Description": "<VulnDiscussion>Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed at specific intervals. \n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the application does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the system and/or application passwords could be compromised. \n\nThis requirement does not include emergency administration accounts, which are meant for access to the application in case of failure. These accounts are not required to have maximum password lifetime restrictions.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed at specific intervals. \n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the application does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the system and/or application passwords could be compromised. \n\nThis requirement does not include emergency administration accounts, which are meant for access to the application in case of failure. These accounts are not required to have maximum password lifetime restrictions.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nView the value of the \"Maximum lifetime\" setting.\n\nIf the \"Maximum lifetime\" policy is not set to \"60\", this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nClick \"Edit\".\n\nEnter \"60\" into the \"Maximum lifetime\" setting and click \"OK\".",
            "CCI": "CCI-000199"
        },
        {
            "VulnID": "V-243075",
            "RuleID": "SV-243075r719468_rule",
            "StigID": "VCTR-67-000004",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000190",
            "RuleTitle": "The vCenter Server must terminate management sessions after 10 minutes of inactivity.",
            "Description": "<VulnDiscussion>Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Windows, this is not applicable.\n\nOn the vCenter Server, execute the following command:\n\n#  grep \"^session\\.timeout\" /etc/vmware/vsphere-client/webclient.properties\n\nExpected result:\n\nsession.timeout = 10\n\nIf the output does not match the expected result, this is a finding.",
            "FixText": "Navigate to and open /etc/vmware/vsphere-client/webclient.properties. Remove any existing \"session.timeout\" line and add the following:\n\nsession.timeout = 10",
            "CCI": "CCI-001133"
        },
        {
            "VulnID": "V-243076",
            "RuleID": "SV-243076r719471_rule",
            "StigID": "VCTR-67-000005",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000211",
            "RuleTitle": "The vCenter Server users must have the correct roles assigned.",
            "Description": "<VulnDiscussion>Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Access Control >> Roles. \n\nView each role and verify the users and/or groups assigned to it.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VIPermission | Sort Role | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto\n\nApplication service account and user required privileges should be documented.\n\nIf any user or service account has more privileges than required, this is a finding.",
            "FixText": "To update a user's or group's permissions to an existing role with reduced permissions:\n\nFrom the vSphere Client, go to Administration >> Access Control >> Global Permissions. \n\nSelect the user or group, click \"Edit\", change the assigned role, and click \"OK\". \n\nIf permissions are assigned on a specific object, the role must be updated where it is assigned (for example, at the cluster level).\n\nTo create a new role with reduced permissions:\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles. \n\nClick the green plus sign, enter a name for the role, and select only the specific permissions required.\n\nUsers can then be assigned to the newly created role.",
            "CCI": "CCI-001082"
        },
        {
            "VulnID": "V-243077",
            "RuleID": "SV-243077r816836_rule",
            "StigID": "VCTR-67-000007",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must manage excess capacity, bandwidth, or other redundancy to limit the effects of information-flooding types of denial-of-service (DoS) attacks by enabling Network I/O Control (NIOC).",
            "Description": "<VulnDiscussion>DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> Configure >> Settings >> Properties. \n\nView the \"Properties\" pane and verify Network I/O Control is enabled.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDSwitch | select Name,@{N=\"NIOC Enabled\";E={$_.ExtensionData.config.NetworkResourceManagementEnabled}}\n\nIf Network I/O Control is disabled, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> Configure >> Settings >> Properties. \n\nIn the \"Properties\" pane, click \"Edit\" and change Network I/O Control to enabled.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\n(Get-VDSwitch \"VDSwitch Name\" | Get-View).EnableNetworkResourceManagement($true)",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243078",
            "RuleID": "SV-243078r719644_rule",
            "StigID": "VCTR-67-000008",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000108",
            "RuleTitle": "The vCenter Server must provide an immediate real-time alert to the SA and ISSO, at a minimum, of all audit failure events.",
            "Description": "<VulnDiscussion>It is critical for the appropriate personnel to be aware if an ESXi host is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.\n\nTo ensure the appropriate personnel are alerted if an audit failure occurs, a vCenter alarm can be created to trigger when an ESXi host can no longer reach its syslog server.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "It is critical for the appropriate personnel to be aware if an ESXi host is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.\n\nTo ensure the appropriate personnel are alerted if an audit failure occurs, a vCenter alarm can be created to trigger when an ESXi host can no longer reach its syslog server.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> More >> Alarm Definitions. \n\nVerify there is an alarm created to alert if an ESXi host can no longer reach its syslog server. The alarm definition will have a rule for the \"Remote logging host has become unreachable\" event.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AlarmDefinition | Where {$_.ExtensionData.Info.Expression.Expression.EventTypeId -eq \"esx.problem.vmsyslogd.remote.failure\"} | Select Name,Enabled,@{N=\"EventTypeId\";E={$_.ExtensionData.Info.Expression.Expression.EventTypeId}}\n\nIf an alarm is not created and enabled to alert when syslog failures occur, this is a finding.",
            "FixText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> More >> Alarm Definitions. \n\nClick \"Add\". \n\nProvide an alarm name and description.\n\nSelect \"Hosts\" from the \"Target type\" dropdown menu. \n\nClick \"Next\".\n\nPaste \"esx.problem.vmsyslogd.remote.failure\" in the line after IF and press \"Enter\". \n\nSelect \"Show as Warning\" for severity. \n\nClick \"Next\".\n\nConfigure any other options as desired, enable alarm, and finish.\n\nNote: This alarm will only trigger if syslog is configured for TCP or SSL connections and not UDP.",
            "CCI": "CCI-000139"
        },
        {
            "VulnID": "V-243079",
            "RuleID": "SV-243079r863038_rule",
            "StigID": "VCTR-67-000009",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000153",
            "RuleTitle": "The vCenter Server must implement Active Directory authentication.",
            "Description": "<VulnDiscussion>The vCenter Server must ensure users are authenticated with an individual authenticator prior to using a group authenticator. Using Active Directory for authentication provides more robust account management capabilities.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The vCenter Server must ensure users are authenticated with an individual authenticator prior to using a group authenticator. Using Active Directory for authentication provides more robust account management capabilities.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Web Client, go to Administration >> Single Sign-On >> Configuration. \n\nClick the \"Identity Sources\" tab.\n\nIf there is no identity source of type \"Active Directory\", this is a finding.",
            "FixText": "From the vSphere Web Client go to Administration >> Single Sign-On >> Configuration. \n\nClick the \"Add identity source\".\n\nSelect either \"Active Directory over LDAP\" or \"Active Directory\" and configure appropriately. \n\nNote: Windows Integrated Authentication requires that the vCenter server be joined to AD before configuration via Administration >> Single Sign-On >> Configuration >> Active Directory Domain.",
            "CCI": "CCI-000770"
        },
        {
            "VulnID": "V-243080",
            "RuleID": "SV-243080r719483_rule",
            "StigID": "VCTR-67-000010",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000153",
            "RuleTitle": "The vCenter Server must limit the use of the built-in SSO administrative account.",
            "Description": "<VulnDiscussion>Use of the SSO administrator account should be limited as it is a shared account and individual accounts must be used wherever possible.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Use of the SSO administrator account should be limited as it is a shared account and individual accounts must be used wherever possible.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Verify the built-in SSO administrator account is only used for emergencies and situations where it is the only option due to permissions.\n\nIf the built-in SSO administrator account is used for daily operations or there is no policy restricting its use, this is a finding.",
            "FixText": "Develop a policy to limit the use of the built-in SSO administrator account.",
            "CCI": "CCI-000770"
        },
        {
            "VulnID": "V-243081",
            "RuleID": "SV-243081r816839_rule",
            "StigID": "VCTR-67-000012",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must disable the distributed virtual switch health check.",
            "Description": "<VulnDiscussion>Network Healthcheck is disabled by default. Once enabled, the healthcheck packets contain information on host#, vds#, and port#, which an attacker would find useful. It is recommended that network healthcheck be used for troubleshooting and turned off when troubleshooting is finished.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Network Healthcheck is disabled by default. Once enabled, the healthcheck packets contain information on host#, vds#, and port#, which an attacker would find useful. It is recommended that network healthcheck be used for troubleshooting and turned off when troubleshooting is finished.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> Configure >> Settings >> Health Check. \n\nView the health check pane and verify that the \"VLAN and MTU\" and \"Teaming and failover\" checks are disabled.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$vds = Get-VDSwitch\n$vds.ExtensionData.Config.HealthCheckConfig\n\nIf the health check feature is enabled on distributed switches and is not on temporarily for troubleshooting purposes, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> Configure >> Settings >> Health Check. \n\nClick \"Edit\" and disable the \"VLAN and MTU\" and \"Teaming and failover\" checks.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-View -ViewType DistributedVirtualSwitch | ?{($_.config.HealthCheckConfig | ?{$_.enable -notmatch \"False\"})}| %{$_.UpdateDVSHealthCheckConfig(@((New-Object Vmware.Vim.VMwareDVSVlanMtuHealthCheckConfig -property @{enable=0}),(New-Object Vmware.Vim.VMwareDVSTeamingHealthCheckConfig -property @{enable=0})))}",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243082",
            "RuleID": "SV-243082r816841_rule",
            "StigID": "VCTR-67-000013",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must set the distributed port group Forged Transmits policy to reject.",
            "Description": "<VulnDiscussion>If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nWhen the Forged transmits option is set to \"Accept\", ESXi does not compare source and effective MAC addresses.\n\nTo protect against MAC impersonation, set the Forged transmits option to \"Reject\". The host will compare the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to determine if they match. If the addresses do not match, the ESXi host drops the packet.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nWhen the Forged transmits option is set to \"Accept\", ESXi does not compare source and effective MAC addresses.\n\nTo protect against MAC impersonation, set the Forged transmits option to \"Reject\". The host will compare the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to determine if they match. If the addresses do not match, the ESXi host drops the packet.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> select a port group >> Configure >> Settings >> Policies.\n\nVerify \"Forged Transmits\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"Forged Transmits\" policy is set to accept for a non-uplink port, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> select a port group >> Configure >> Settings >> Policies >> Edit >> Security. \n\nSet \"Forged Transmits\" to reject. Click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243083",
            "RuleID": "SV-243083r816843_rule",
            "StigID": "VCTR-67-000014",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must set the distributed port group MAC Address Change policy to reject.",
            "Description": "<VulnDiscussion>If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. This will also affect how a layer 2 bridge will operate and will affect applications that require a specific MAC address for licensing.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. This will also affect how a layer 2 bridge will operate and will affect applications that require a specific MAC address for licensing.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> select a port group >> Configure >> Settings >> Policies.\n\nVerify \"MAC Address Changes\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"MAC Address Changes\" policy is set to accept, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> select a port group >> Configure >> Settings >> Policies >> Edit >> Security. \n\nSet \"MAC Address Changes\" to reject. Click \"OK\".\n \nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243084",
            "RuleID": "SV-243084r816845_rule",
            "StigID": "VCTR-67-000015",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must set the distributed port group Promiscuous Mode policy to reject.",
            "Description": "<VulnDiscussion>When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the port group have the potential of reading all packets across that network, meaning only the virtual machines connected to that port group. Promiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the port group have the potential of reading all packets across that network, meaning only the virtual machines connected to that port group. Promiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> select a port group >> Configure >> Settings >> Policies.\n\nVerify \"Promiscuous Mode\" is set to reject.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"Promiscuous Mode\" policy is set to accept, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> select a port group >> Configure >> Settings >> Policies >> Edit >> Security. \n\nSet \"Promiscuous Mode\" to reject. Click \"OK\".\n \nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243085",
            "RuleID": "SV-243085r816847_rule",
            "StigID": "VCTR-67-000016",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must only send NetFlow traffic to authorized collectors.",
            "Description": "<VulnDiscussion>The distributed virtual switch can export NetFlow information about traffic crossing the switch. NetFlow exports are not encrypted and can contain information about the virtual network, making it easier for a MitM attack to be executed successfully. If NetFlow export is required, verify that all NetFlow target IPs are correct.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The distributed virtual switch can export NetFlow information about traffic crossing the switch. NetFlow exports are not encrypted and can contain information about the virtual network, making it easier for a MitM attack to be executed successfully. If NetFlow export is required, verify that all NetFlow target IPs are correct.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nTo view NetFlow Collector IPs configured on distributed switches:\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> Configure >> Settings >> NetFlow. \n\nView the NetFlow pane and verify that any collector IP addresses are valid and in use for troubleshooting.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDSwitch | select Name,@{N=\"NetFlowCollectorIPs\";E={$_.ExtensionData.config.IpfixConfig.CollectorIpAddress}}\n\nTo view if NetFlow is enabled on any distributed port groups:\n\nFrom the vSphere Client, go to Networking >> select a distributed port group >> Manage >> Settings >> Policies. \n\nGo to Monitoring and view the NetFlow status.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | select Name,VirtualSwitch,@{N=\"NetFlowEnabled\";E={$_.Extensiondata.Config.defaultPortConfig.ipfixEnabled.Value}}\n\nIf NetFlow is configured and the collector IP is not known and documented, this is a finding.",
            "FixText": "To remove collector IPs:\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> Configure >> Settings >> NetFlow. \n\nClick \"Edit\" and remove any unknown collector IPs.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$dvs = Get-VDSwitch dvswitch | Get-View\nForEach($vs in $dvs){\n$spec = New-Object VMware.Vim.VMwareDVSConfigSpec\n$spec.configversion = $vs.Config.ConfigVersion\n$spec.IpfixConfig = New-Object VMware.Vim.VMwareIpfixConfig\n$spec.IpfixConfig.CollectorIpAddress = \"\"\n$spec.IpfixConfig.CollectorPort = \"0\"\n$spec.IpfixConfig.ActiveFlowTimeout = \"60\"\n$spec.IpfixConfig.IdleFlowTimeout = \"15\"\n$spec.IpfixConfig.SamplingRate = \"0\"\n$spec.IpfixConfig.InternalFlowsOnly = $False\n$vs.ReconfigureDvs_Task($spec)\n}\n\nNote: This will reset the NetFlow collector configuration back to the defaults.\n\nTo disable NetFlow on a distributed port group:\n\nFrom the vSphere Client, go to Networking >> select a distributed port group >> Manage >> Settings >> Policies. \n\nGo to \"Monitoring\" and change \"NetFlow\" to disabled.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$pgs = Get-VDPortgroup | Get-View\nForEach($pg in $pgs){\n$spec = New-Object VMware.Vim.DVPortgroupConfigSpec\n$spec.configversion = $pg.Config.ConfigVersion\n$spec.defaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting\n$spec.defaultPortConfig.ipfixEnabled = New-Object VMware.Vim.BoolPolicy\n$spec.defaultPortConfig.ipfixEnabled.inherited = $false\n$spec.defaultPortConfig.ipfixEnabled.value = $false\n$pg.ReconfigureDVPortgroup_Task($spec)\n}",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243086",
            "RuleID": "SV-243086r816913_rule",
            "StigID": "VCTR-67-000018",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must configure all port groups to a value other than that of the native VLAN.",
            "Description": "<VulnDiscussion>ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to native VLAN of the physical switch. \n\nFor example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \"1\"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \"1\" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). \n\nIf the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch because the switch is expecting untagged traffic.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to native VLAN of the physical switch. \n\nFor example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \"1\"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \"1\" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). \n\nIf the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch because the switch is expecting untagged traffic.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> select a distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group VLAN tags and verify they are not set to the native VLAN ID of the attached physical switch.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | select Name, VlanConfiguration\n\nIf any port group is configured with the native VLAN of the ESXi host's attached physical switch, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> select a distributed port group >> Configure >> Settings >> Policies. \n\nClick \"Edit\".\n\nUnder the VLAN section, change the VLAN ID to a non-native VLAN and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup \"portgroup name\" | Set-VDVlanConfiguration -VlanId \"New VLAN#\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243087",
            "RuleID": "SV-243087r816914_rule",
            "StigID": "VCTR-67-000019",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must not configure VLAN Trunking unless Virtual Guest Tagging (VGT) is required and authorized.",
            "Description": "<VulnDiscussion>When a port group is set to VLAN Trunking, the vSwitch passes all network frames in the specified range to the attached VMs without modifying the VLAN tags. In vSphere, this is referred to as Virtual Guest Tagging (VGT). \n\nThe VM must process the VLAN information itself via an 802.1Q driver in the OS. VLAN Trunking must only be implemented if the attached VMs have been specifically authorized and are capable of managing VLAN tags themselves. \n\nIf VLAN Trunking is enabled inappropriately, it may cause denial of service or allow a VM to interact with traffic on an unauthorized VLAN.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When a port group is set to VLAN Trunking, the vSwitch passes all network frames in the specified range to the attached VMs without modifying the VLAN tags. In vSphere, this is referred to as Virtual Guest Tagging (VGT). \n\nThe VM must process the VLAN information itself via an 802.1Q driver in the OS. VLAN Trunking must only be implemented if the attached VMs have been specifically authorized and are capable of managing VLAN tags themselves. \n\nIf VLAN Trunking is enabled inappropriately, it may cause denial of service or allow a VM to interact with traffic on an unauthorized VLAN.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> select a distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group \"VLAN Type\" and \"VLAN trunk range\", if present.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | Where {$_.ExtensionData.Config.Uplink -ne \"True\"} | select Name,VlanConfiguration\n\nIf any port group is configured with \"VLAN Trunk\" and is not documented as a needed exception (such as NSX appliances), this is a finding.\n\nIf any port group is authorized to be configured with \"VLAN trunking\" but is not configured with the most limited range necessary, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> select a distributed port group >> Configure >> Settings >> Policies. \n\nClick \"Edit\". \n\nClick the \"VLAN\" tab.\n\nIf \"VLAN trunking\" is not authorized, remove it by setting \"VLAN type\" to \"VLAN\" and configure an appropriate VLAN ID. Click \"OK\".\n\nIf \"VLAN trunking\" is authorized but the range is too broad, modify the range in the \"VLAN trunk range\" field to the minimum necessary and authorized range. An example range would be \"1,3-5,8\". Click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command to configure trunking:\n\nGet-VDPortgroup \"Portgroup Name\" | Set-VDVlanConfiguration -VlanTrunkRange \"<VLAN Range(s) comma separated>\"\n\nor \n\nRun this command to configure a single VLAN ID:\n\nGet-VDPortgroup \"Portgroup Name\" | Set-VDVlanConfiguration -VlanId \"<New VLAN#>\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243088",
            "RuleID": "SV-243088r816854_rule",
            "StigID": "VCTR-67-000020",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must not configure all port groups to VLAN values reserved by upstream physical switches.",
            "Description": "<VulnDiscussion>Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001\u20131024 and 4094, while Nexus switches typically reserve 3968\u20134047 and 4094. \n\nCheck with the documentation for the specific switch. Using a reserved VLAN might result in a denial of service on the network.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001\u20131024 and 4094, while Nexus switches typically reserve 3968\u20134047 and 4094. \n\nCheck with the documentation for the specific switch. Using a reserved VLAN might result in a denial of service on the network.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking >> select a distributed switch >> select a distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group VLAN tags and verify they are not set to a reserved VLAN ID.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | select Name, VlanConfiguration\n\nIf any port group is configured with a reserved VLAN ID, this is a finding.",
            "FixText": "From the vSphere Client, go to Networking >> select a distributed switch >> select a distributed port group >> Configure >> Settings >> Policies. \n\nClick \"Edit\".\n\nUnder the VLAN section, change the VLAN ID to an unreserved VLAN ID and click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup \"portgroup name\" | Set-VDVlanConfiguration -VlanId \"New VLAN#\"",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243089",
            "RuleID": "SV-243089r719510_rule",
            "StigID": "VCTR-67-000023",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must configure the vpxuser auto-password to be changed every 30 days.",
            "Description": "<VulnDiscussion>By default, the vpxuser password will be automatically changed by vCenter every 30 days. Ensure this setting meets site policies; if not, configure to meet password aging policies. \n\nNote: It is very important the password aging policy not be shorter than the default interval that is set to automatically change the vpxuser password, to preclude the possibility that vCenter might be locked out of an ESXi host.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By default, the vpxuser password will be automatically changed by vCenter every 30 days. Ensure this setting meets site policies; if not, configure to meet password aging policies. \n\nNote: It is very important the password aging policy not be shorter than the default interval that is set to automatically change the vpxuser password, to preclude the possibility that vCenter might be locked out of an ESXi host.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nVerify that \"VirtualCenter.VimPasswordExpirationInDays\" is set to \"30\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays and verify it is set to 30.\n\nIf the \"VirtualCenter.VimPasswordExpirationInDays\" is set to a value other than \"30\" or does not exist, this is a finding.",
            "FixText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nClick \"Edit Settings\" and configure the \"VirtualCenter.VimPasswordExpirationInDays\" value to \"30\".\n\nIf the value does not exist, create it by entering the values in the \"Key\" and \"Value\" fields and clicking \"Add\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nIf the setting already exists:\nGet-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays | Set-AdvancedSetting -Value 30\n\nIf the setting does not exist:\nNew-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays -Value 30",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243090",
            "RuleID": "SV-243090r719513_rule",
            "StigID": "VCTR-67-000024",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must configure the vpxuser password meets length policy.",
            "Description": "<VulnDiscussion>The vpxuser password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies. \n\nLonger passwords make brute-force password attacks more difficult. The vpxuser password is added by vCenter, meaning no manual intervention is normally required. The vpxuser password length must never be modified to less than the default length of 32 characters.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The vpxuser password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies. \n\nLonger passwords make brute-force password attacks more difficult. The vpxuser password is added by vCenter, meaning no manual intervention is normally required. The vpxuser password length must never be modified to less than the default length of 32 characters.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nVerify that \"config.vpxd.hostPasswordLength\" is set to \"32\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.vpxd.hostPasswordLength\n\nVerify it is set to \"32\".\n\nIf the \"config.vpxd.hostPasswordLength\" is set to a value other than \"32\", this is a finding. \n\nIf the setting does not exist, this is not a finding.",
            "FixText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nClick \"Edit Settings\" and configure the \"config.vpxd.hostPasswordLength\" value to \"32\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server run the following command if the setting already exists:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.vpxd.hostPasswordLength | Set-AdvancedSetting -Value 32",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243091",
            "RuleID": "SV-243091r719516_rule",
            "StigID": "VCTR-67-000025",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must disable the managed object browser (MOB) at all times when not required for troubleshooting or maintenance of managed objects.",
            "Description": "<VulnDiscussion>The MOB was designed to be used by SDK developers to assist in the development, programming, and debugging of objects. It is an inventory object, full-access interface, allowing attackers to determine the inventory path of an infrastructure's managed entities.\n\nThe MOB provides a way to explore the object model used by the vCenter to manage the vSphere environment; it enables configurations to be changed as well. This interface is used primarily for debugging and could potentially be used to perform malicious configuration changes or actions.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The MOB was designed to be used by SDK developers to assist in the development, programming, and debugging of objects. It is an inventory object, full-access interface, allowing attackers to determine the inventory path of an infrastructure's managed entities.\n\nThe MOB provides a way to explore the object model used by the vCenter to manage the vSphere environment; it enables configurations to be changed as well. This interface is used primarily for debugging and could potentially be used to perform malicious configuration changes or actions.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Check the operational status of the MOB by performing one of the following or both:\n\nBrowse to the MOB page on the vCenter server:\n\nhttps://<vcenter fqdn or IP>/mob\n\nIf a \"503 Service Unavailable\" error is returned, the MOB is disabled. \n\nIf a prompt for authentication appears, it is enabled.\n\nor\n\nRun the following command from the vCenter appliance:\n\ngrep -i \"enableDebugBrowse\" /etc/vmware-vpx/vpxd.cfg\n\nIf the MOB is enabled, ask the SA if it is being used for object maintenance and if so, this is not a finding. \n\nIf the \"enableDebugBrowse\" element is enabled (set to true) or absent, and object maintenance is not being performed, this is a finding.",
            "FixText": "If the datastore browser is enabled and required for object maintenance, no fix is immediately required.\n\nDisable the managed object browser by editing the /etc/vmware-vpx/vpxd.cfg file.\n\nEdit the file and locate the <vpxd> ... </vpxd> element.\n\nAdd or update the following element in the vpxd section:\n <enableDebugBrowse>false</enableDebugBrowse>\n\nNote: It is not present by default and is case sensitive.\n\nRestart the vCenter Service to ensure the configuration file change(s) are in effect by running the following command on the vCenter appliance:\n\nservice-control --restart vmware-vpxd",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243092",
            "RuleID": "SV-243092r719519_rule",
            "StigID": "VCTR-67-000026",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must check the privilege reassignment after restarts.",
            "Description": "<VulnDiscussion>Check for privilege reassignment when restarting vCenter Server. If the user or user group that is assigned the Administrator role on the root folder cannot be verified as a valid user or group during a restart, the role is removed from that user or group. In its place, vCenter Server grants the Administrator role to the vCenter Single Sign-On account administrator@vsphere.local. This account can then act as the Administrator.\n\nReestablish a named Administrator account and assign the Administrator role to that account to avoid using the anonymous administrator@vsphere.local account.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Check for privilege reassignment when restarting vCenter Server. If the user or user group that is assigned the Administrator role on the root folder cannot be verified as a valid user or group during a restart, the role is removed from that user or group. In its place, vCenter Server grants the Administrator role to the vCenter Single Sign-On account administrator@vsphere.local. This account can then act as the Administrator.\n\nReestablish a named Administrator account and assign the Administrator role to that account to avoid using the anonymous administrator@vsphere.local account.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nAfter the Windows server hosting the vCenter Server has been rebooted, a vCenter Server user or member of the user group granted the Administrator role must log in and verify the role permissions remain intact. \n\nIf the user and/or user group granted vCenter Administrator role permissions cannot be verified as intact, this is a finding.",
            "FixText": "As the SSO Administrator, log in to the vCenter Server and restore a legitimate Administrator account per site-specific user/group/role requirements.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243093",
            "RuleID": "SV-243093r719522_rule",
            "StigID": "VCTR-67-000029",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must enable all tasks to be shown to Administrators in the Web Client.",
            "Description": "<VulnDiscussion>By default, not all tasks are shown in the Web Client to Administrators, and only that user's tasks will be shown. Enabling all tasks to be shown will allow the Administrator to potentially see any malicious activity they may miss with the view disabled.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By default, not all tasks are shown in the Web Client to Administrators, and only that user's tasks will be shown. Enabling all tasks to be shown will allow the Administrator to potentially see any malicious activity they may miss with the view disabled.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Windows, this is not applicable.\n\nOn the vCenter Server, execute the following command:\n\n#  grep \"^show\\.allusers\\.tasks\" /etc/vmware/vsphere-client/webclient.properties\n\nExpected result:\n\nshow.allusers.tasks = true\n\nIf the output does not match the expected result, this is a finding.",
            "FixText": "Navigate to and open /etc/vmware/vsphere-client/webclient.properties. Remove any existing \"show.allusers.tasks\" line and add the following:\n\nshow.allusers.tasks = true",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243094",
            "RuleID": "SV-243094r719525_rule",
            "StigID": "VCTR-67-000031",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must restrict the connectivity between Update Manager and public patch repositories by use of a separate Update Manager Download Server.",
            "Description": "<VulnDiscussion>The Update Manager Download Service (UMDS) is an optional module of the Update Manager. UMDS downloads upgrades for virtual appliances, patch metadata, patch binaries, and notifications that would not otherwise be available to the Update Manager server. \n\nFor security reasons and deployment restrictions, the Update Manager must be installed in a secured network that is disconnected from the internet. The Update Manager requires access to patch information to function properly. UMDS must be installed on a separate system that has internet access to download upgrades, patch binaries, and patch metadata and then export the downloads to a portable media drive so they become accessible to the Update Manager server.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The Update Manager Download Service (UMDS) is an optional module of the Update Manager. UMDS downloads upgrades for virtual appliances, patch metadata, patch binaries, and notifications that would not otherwise be available to the Update Manager server. \n\nFor security reasons and deployment restrictions, the Update Manager must be installed in a secured network that is disconnected from the internet. The Update Manager requires access to patch information to function properly. UMDS must be installed on a separate system that has internet access to download upgrades, patch binaries, and patch metadata and then export the downloads to a portable media drive so they become accessible to the Update Manager server.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Check the following conditions:\n\n1. The Update Manager must be configured to use the Update Manager Download Server. \n\n2. The use of physical media to transfer update files to the Update Manager server (air gap model example: separate Update Manager Download Server, which may source vendor patches externally via the internet versus an internal, organization-defined source) must be enforced with site policies.\n\nFrom the vSphere Client, click Update Manager >> Settings >> Administrative Settings >> Patch Setup and click the \"Change Download Source\" button. \n\nVerify that the \"Download patches from a UMDS shared repository\" radio button is selected and that a valid UMDS repository is supplied.\n\nIf \"Direct connection to Internet\" is configured, this is a finding.\n\nIf all of the above conditions are not met, this is a finding.",
            "FixText": "Configure the Update Manager Server to use a separate Update Manager Download Server; the use of physical media to transfer updated files to the Update Manager server (air gap model) must be enforced and documented with organization policies. \n\nConfigure the Update Manager Download Server and enable the Download Service. Patches must not be directly accessible to the Update Manager Server application from the internet.\n\nTo configure a web server or local disk repository as a download source (i.e., \"Direct connection to Internet\" must not be selected as the source), from the vSphere Client/vCenter Server system, click \"Update Manager\" under \"Solutions and Applications\". \n\nOn the \"Configuration\" tab, under \"Settings\", click \"Download Settings\". \n\nIn the \"Download Sources\" pane, select \"Use a shared repository\". \n\nEnter the <site-specific> path or the URL to the shared repository. \n\nClick \"Validate URL\" to validate the path. \n\nClick \"Apply\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243095",
            "RuleID": "SV-243095r719528_rule",
            "StigID": "VCTR-67-000033",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must use a least-privileges assignment for the vCenter Server database user.",
            "Description": "<VulnDiscussion>Least privileges mitigate attacks if the vCenter database account is compromised. vCenter requires very specific privileges on the database. Privileges normally required only for installation and upgrade must be removed for/during normal operation. These privileges may be reinstated if/when any future upgrade must be performed.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Least privileges mitigate attacks if the vCenter database account is compromised. vCenter requires very specific privileges on the database. Privileges normally required only for installation and upgrade must be removed for/during normal operation. These privileges may be reinstated if/when any future upgrade must be performed.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nVerify that only the following permissions are allowed on the vCenter database for the following roles and users. \n\nvCenter database administrator role used only for initial setup and periodic maintenance of the database: \n\nSchema permissions: ALTER, REFERENCES, and INSERT. \nPermissions CREATE TABLE, CREATE VIEW, and CREATE PROCEDURE \n\nvCenter database user role: \n\nSchema permissions: SELECT, INSERT, DELETE, UPDATE, and EXECUTE\n\nEXECUTE permissions on sp_add_job, sp_delete_job, sp_add_jobstep, sp_update_job, sp_add_jobserver, sp_add_jobschedule, and sp_add_category stored procedures. \n\nSELECT permission on syscategories, sysjobsteps, sysjobs_view, and sysjobs tables. \n\nvCenter database user: \n\nVIEW SERVER STATE and VIEW ANY DEFINITIONS. \n\nEquivalent permissions must be set for non-MSSQL databases. \n\nIf the above database permissions are not set correctly, this is a finding.\n\nIf the database user role is not assigned to the database account after installation, this is a finding.\n\nIf the embedded Postgres database is used, this finding is not applicable.\n\nFor more information, refer to the following website: https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vcenter.install.doc/GUID-66638880-75B5-446E-BD8C-0230FECF60E0.html",
            "FixText": "Configure correct permissions and roles for SQL: \n\nGrant these privileges to a vCenter database administrator role used only for initial setup and periodic maintenance of the database: \n\nSchema permissions ALTER, REFERENCES, and INSERT. \nPermissions CREATE TABLE, VIEW, and CREATE PROCEDURES \n\nGrant these privileges to a vCenter database user role: \n\nSELECT, INSERT, DELETE, UPDATE, and EXECUTE\n \nEXECUTE permissions on sp_add_job, sp_delete_job, sp_add_jobstep, sp_update_job, sp_add_jobserver, sp_add_jobschedule, and sp_add_category stored procedures. \n\nSELECT permission on syscategories, sysjobsteps, sysjobs_view, and sysjobs tables. \n\nGrant the permissions VIEW SERVER STATE and VIEW ANY DEFINITIONS to the vCenter database user. \n\nFor more information, refer to the following website: https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vcenter.install.doc/GUID-66638880-75B5-446E-BD8C-0230FECF60E0.html",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243096",
            "RuleID": "SV-243096r719531_rule",
            "StigID": "VCTR-67-000034",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must use unique service accounts when applications connect to vCenter.",
            "Description": "<VulnDiscussion>In order to not violate non-repudiation (i.e., deny the authenticity of who is connecting to vCenter), when applications need to connect to vCenter they must use unique service accounts.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "In order to not violate non-repudiation (i.e., deny the authenticity of who is connecting to vCenter), when applications need to connect to vCenter they must use unique service accounts.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Verify that each external application that connects to vCenter has a unique service account dedicated to that application. \n\nFor example, there should be separate accounts for Log Insight, Operations Manager, or anything else that requires an account to access vCenter.\n\nIf any application shares a service account that is used to connect to vCenter, this is a finding.",
            "FixText": "For applications sharing service accounts, create a new service account to assign to the application so that no application shares a service account with another.\n\nWhen standing up a new application that requires access to vCenter, always create a new service account prior to installation and grant only the permissions needed for that application.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243097",
            "RuleID": "SV-243097r719534_rule",
            "StigID": "VCTR-67-000035",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "vCenter Server plugins must be verified.",
            "Description": "<VulnDiscussion>The vCenter Server includes a vSphere Client extensibility framework, which provides the ability to extend the vSphere Client with menu selections or toolbar icons that provide access to vCenter Server add-on components or external, web-based functionality. \n\nvSphere Client plugins or extensions run at the same privilege level as the user. Malicious extensions might masquerade as useful add-ons while compromising the system by stealing credentials or incorrectly configuring the system.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The vCenter Server includes a vSphere Client extensibility framework, which provides the ability to extend the vSphere Client with menu selections or toolbar icons that provide access to vCenter Server add-on components or external, web-based functionality. \n\nvSphere Client plugins or extensions run at the same privilege level as the user. Malicious extensions might masquerade as useful add-ons while compromising the system by stealing credentials or incorrectly configuring the system.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Verify the vSphere Client used by administrators includes only authorized extensions from trusted sources.\n\nFrom the vSphere Client, go to Administration >> Solutions >> Client Plug-Ins. \n\nView the Installed/Available Plug-ins list and verify they are all identified as authorized VMware, third-party (partner), and/or site-specific approved plug-ins.\n\nIf any Installed/Available plug-ins in the viewable list cannot be verified as an allowed vSphere Client plug-ins from trusted sources, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Solutions >> Client Plug-Ins.\n\nClick the radio button next to the unknown plug-in and click disable. Proceed to uninstall the plug-in.\n\nTo remove plug-ins:\n\nIf vCenter Server is in linked mode, perform this procedure on the vCenter Server that is used to install the plug-in initially and then restart the vCenter Server services on the linked vCenter Server.\n\nIn a web browser, navigate to http://vCenter_Server_name_or_IP/mob.\n\nvCenter_Server_name_or_IP/mob is the name of the vCenter Server or its IP address.\n\nClick \"Content\".\n\nClick \"ExtensionManager\".\n\nSelect and copy the name of the plug-in to be removed from the list of values under \"Properties\". \n\nClick \"UnregisterExtension\". A new window appears.\n\nPaste the name of the plug-in and click \"Invoke Method\". This removes the plug-in.\n\nClose the window.\n\nRefresh the \"Managed Object Type:ManagedObjectReference:ExtensionManager\" window to verify that the plug-in is removed successfully.\n\nNote: If the plug-in still appears, restart the vSphere Client.\n\nNote: Enable the Managed Object Browser (MOB) temporarily if it was previously disabled.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243098",
            "RuleID": "SV-243098r850125_rule",
            "StigID": "VCTR-67-000036",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000474",
            "RuleTitle": "The vCenter Server must produce audit records containing information to establish what type of events occurred.",
            "Description": "<VulnDiscussion>Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nVerify that \"config.log.level\" value is set to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.log.level \n\nVerify it is set to \"info\".\n\nIf the \"config.log.level\" value is not set to \"info\" or does not exist, this is a finding.",
            "FixText": "From the vSphere Client, go to Hosts and Clusters >> select a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nClick \"Edit Settings\" and configure the \"config.log.level\" setting to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.log.level | Set-AdvancedSetting -Value info",
            "CCI": "CCI-002702"
        },
        {
            "VulnID": "V-243099",
            "RuleID": "SV-243099r719540_rule",
            "StigID": "VCTR-67-000039",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000164",
            "RuleTitle": "The vCenter Server passwords must be at least 15 characters in length.",
            "Description": "<VulnDiscussion>The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. \n\nUse of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. \n\nUse of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nView the values of the password format requirements. \n\nThe following password requirement should be set at a minimum: \n\nMinimum Length: 15 \n\nIf this password policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nClick \"Edit\". \n\nSet the Minimum Length to \"15\" and click \"OK\".",
            "CCI": "CCI-000205"
        },
        {
            "VulnID": "V-243100",
            "RuleID": "SV-243100r719543_rule",
            "StigID": "VCTR-67-000040",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000166",
            "RuleTitle": "The vCenter Server passwords must contain at least one uppercase character.",
            "Description": "<VulnDiscussion>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nView the values of the password format requirements. \n\nThe following password requirement should be set at a minimum: \n\nUpper-case Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nClick \"Edit\". \n\nSet \"Upper-case Characters\" to at least \"1\" and click \"OK\".",
            "CCI": "CCI-000192"
        },
        {
            "VulnID": "V-243101",
            "RuleID": "SV-243101r719546_rule",
            "StigID": "VCTR-67-000041",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000167",
            "RuleTitle": "The vCenter Server passwords must contain at least one lowercase character.",
            "Description": "<VulnDiscussion>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nView the values of the password format requirements. \n\nThe following password requirement should be set at a minimum: \n\nLower-case Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nClick \"Edit\". \n\nSet \"Lower-case Characters\" to at least \"1\" and click \"OK\".",
            "CCI": "CCI-000193"
        },
        {
            "VulnID": "V-243102",
            "RuleID": "SV-243102r719549_rule",
            "StigID": "VCTR-67-000042",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000168",
            "RuleTitle": "The vCenter Server passwords must contain at least one numeric character.",
            "Description": "<VulnDiscussion>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nView the values of the password format requirements. \n\nThe following password requirement should be set at a minimum: \n\nNumeric Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy.\n\nClick \"Edit\". \n\nSet \"Numeric Characters\" to at least \"1\" and click \"OK\".",
            "CCI": "CCI-000194"
        },
        {
            "VulnID": "V-243103",
            "RuleID": "SV-243103r719552_rule",
            "StigID": "VCTR-67-000043",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000169",
            "RuleTitle": "The vCenter Server passwords must contain at least one special character.",
            "Description": "<VulnDiscussion>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nView the values of the password format requirements. \n\nThe following password requirements should be set at a minimum: \n\nSpecial Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Password Policy. \n\nClick \"Edit\". \n\nSet \"Special Characters\" to at least \"1\" and click \"OK\".",
            "CCI": "CCI-001619"
        },
        {
            "VulnID": "V-243104",
            "RuleID": "SV-243104r850126_rule",
            "StigID": "VCTR-67-000045",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000345",
            "RuleTitle": "The vCenter Server must limit the maximum number of failed login attempts to three.",
            "Description": "<VulnDiscussion>By limiting the number of failed login attempts, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By limiting the number of failed login attempts, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Lockout Policy. \n\nView the values for the lockout policies. \n\nThe following lockout policy should be set at follows: \n\nMaximum number of failed login attempts: 3 \n\nIf this account lockout policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Lockout Policy.\n\nClick \"Edit\". \n\nSet the \"Maximum number of failed login attempts\" to \"3\" and click \"OK\".",
            "CCI": "CCI-002238"
        },
        {
            "VulnID": "V-243105",
            "RuleID": "SV-243105r850127_rule",
            "StigID": "VCTR-67-000046",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000345",
            "RuleTitle": "The vCenter Server must set the interval for counting failed login attempts to at least 15 minutes.",
            "Description": "<VulnDiscussion>By limiting the number of failed login attempts within a specified time period, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By limiting the number of failed login attempts within a specified time period, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Lockout Policy. \n\nView the values for the lockout policies. \n\nThe following lockout policy should be set at follows: \n\nTime interval between failures: 900 seconds \n\nIf this lockout policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client go to Administration >> Single Sign-On >> Configuration >> Policies >> Lockout Policy. \n\nClick \"Edit\". \n\nSet the \"Time interval between failures\" to \"900\" and click \"OK\".",
            "CCI": "CCI-002238"
        },
        {
            "VulnID": "V-243106",
            "RuleID": "SV-243106r850128_rule",
            "StigID": "VCTR-67-000047",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000345",
            "RuleTitle": "The vCenter Server must require an administrator to unlock an account locked due to excessive login failures.",
            "Description": "<VulnDiscussion>By requiring that SSO accounts be unlocked manually, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. When the account unlock time is set to zero, once an account is locked it can only be unlocked manually by an administrator.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By requiring that SSO accounts be unlocked manually, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. When the account unlock time is set to zero, once an account is locked it can only be unlocked manually by an administrator.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Lockout Policy. \n\nView the values for the lockout policies. \n\nThe following lockout policy should be set at follows: \n\nUnlock time: 0 \n\nIf this account lockout policy is not configured as stated, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Policies >> Lockout Policy. \n\nClick \"Edit\". \n\nSet the \"Unlock time\" to \"0\" and click \"OK\".",
            "CCI": "CCI-002238"
        },
        {
            "VulnID": "V-243107",
            "RuleID": "SV-243107r719564_rule",
            "StigID": "VCTR-67-000051",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000233",
            "RuleTitle": "The vCenter Server users must have the correct roles assigned.",
            "Description": "<VulnDiscussion>Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Access Control >> Roles. \n\nView each role and verify the users and/or groups assigned to it.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VIPermission | Sort Role | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto\n\nApplication service account and user required privileges should be documented.\n\nIf any user or service account has more privileges than required, this is a finding.",
            "FixText": "To create a new role with specific permissions:\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles. \n\nClick the plus sign, enter a name for the role, and select only the specific permissions required. \n\nUsers can then be assigned to the newly created role.",
            "CCI": "CCI-001084"
        },
        {
            "VulnID": "V-243108",
            "RuleID": "SV-243108r719567_rule",
            "StigID": "VCTR-67-000052",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must protect the confidentiality and integrity of transmitted information by isolating IP-based storage traffic.",
            "Description": "<VulnDiscussion>Virtual machines might share virtual switches and VLANs with the IP-based storage configurations. IP-based storage includes vSAN, iSCSI, and NFS. This configuration might expose IP-based storage traffic to unauthorized virtual machine users. \n\nIP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network. To restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and virtual machines will limit unauthorized users from viewing the traffic.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Virtual machines might share virtual switches and VLANs with the IP-based storage configurations. IP-based storage includes vSAN, iSCSI, and NFS. This configuration might expose IP-based storage traffic to unauthorized virtual machine users. \n\nIP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network. To restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and virtual machines will limit unauthorized users from viewing the traffic.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If IP-based storage is not used, this is not applicable.\n\nIP-based storage (iSCSI, NFS, vSAN) VMkernel port groups must be in a dedicated VLAN that can be on a standard or distributed virtual switch that is logically separated from other traffic types. The check for this will be unique per environment.\n\nTo check a standard switch, from the vSphere Client select the ESXi host and go to Configure >> Networking >> Virtual switches. \n\nSelect a standard switch. For each storage port group (iSCSI, NFS, vSAN), select the port group and click the \"Details\" button.\n\nNote the VLAN ID associated with each port group and verify that it is dedicated to that purpose and is logically separated from other traffic types.\n\nTo check a distributed switch, from the vSphere Client go to Networking >> select and expand a distributed switch. \n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and navigate to the \"Summary\" tab. \n\nNote the VLAN ID associated with each port group and verify that it is dedicated to that purpose and is logically separated from other traffic types.\n\nIf any IP-based storage networks are not isolated from other traffic types, this is a finding.",
            "FixText": "Configuration of an IP-based VMkernel will be unique to each environment but, for example, to modify the IP address and VLAN information to the correct network on a standard switch for an iSCSI VMkernel, do the following:\n\nFrom the vSphere Client, select the ESXi host and go to Configure >> Networking >> VMkernel adapters. \n\nSelect the Storage VMkernel (for any IP-based storage) and click the \"Edit\" button.\n\nOn the Port properties tab, uncheck everything (unless vSAN). \n\nOn the IP Settings tab, enter the appropriate IP address and subnet information and click \"OK\". \n\nTo configure a standard switch, from the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. \n\nSelect a standard switch. \n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and click the \"Edit\" button.\n\nOn the properties page, enter the appropriate VLAN ID and click \"OK\".\n\nTo configure a distributed switch, from the vSphere Client, go to Networking.\n\nSelect and expand a distributed switch. \n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and navigate to Configure >> Settings >> Properties. \n\nClick the \"Edit\" button. \n\nOn the VLAN page, enter the appropriate VLAN type and ID and click \"OK\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243110",
            "RuleID": "SV-243110r719573_rule",
            "StigID": "VCTR-67-000054",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must disable or restrict the connectivity between vSAN Health Check and public Hardware Compatibility List by use of an external proxy server.",
            "Description": "<VulnDiscussion>The vSAN Health Check is able to download the hardware compatibility list from VMware to check compliance against the underlying vSAN Cluster hosts. \n\nTo ensure the vCenter server is not directly downloading content from the internet, this functionality must be disabled or, if this feature is necessary, an external proxy server must be configured.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The vSAN Health Check is able to download the hardware compatibility list from VMware to check compliance against the underlying vSAN Cluster hosts. \n\nTo ensure the vCenter server is not directly downloading content from the internet, this functionality must be disabled or, if this feature is necessary, an external proxy server must be configured.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If no clusters are enabled for vSAN, this is not applicable.\n\nFrom the vSphere Client, go to Hosts and Clusters >> select the vCenter Server >> Configure >> vSAN >> Internet Connectivity.\n\nIf the HCL internet download is not required, verify that \"Status\" is disabled. \n\nIf the \"Status\" is enabled, this is a finding.\n\nIf the HCL internet download is required, verify that \"Status\" is enabled and a proxy host is configured. \n\nIf \"Status\" is enabled and a proxy is not configured, this is a finding.",
            "FixText": "From the vSphere Client, go to Hosts and Clusters >> vCenter Server >> Configure >> vSAN >> Internet Connectivity >> Edit.\n\nIf the HCL internet download is not required, ensure that \"Status\" is disabled.\n\nIf the HCL internet download is required, ensure that \"Status\" is enabled and a proxy host is appropriately configured.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243111",
            "RuleID": "SV-243111r719576_rule",
            "StigID": "VCTR-67-000055",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must configure the vSAN Datastore name to a unique name.",
            "Description": "<VulnDiscussion>A vSAN Datastore name by default is \"vsanDatastore\". If more than one vSAN cluster is present in vCenter, both datastores will have the same name by default, potentially leading to confusion and manually misplaced workloads.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "A vSAN Datastore name by default is \"vsanDatastore\". If more than one vSAN cluster is present in vCenter, both datastores will have the same name by default, potentially leading to confusion and manually misplaced workloads.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If no clusters are enabled for vSAN, this is not applicable.\n\nFrom the vSphere Client, go to Hosts and Clusters >> select a vSAN Enabled Cluster >> Datastores.\n\nReview the datastores. \n\nIdentify any datastores with \"vSAN\" as the datastore type.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nIf($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){\nWrite-Host \"vSAN Enabled Cluster found\"\nGet-Cluster | where {$_.VsanEnabled} | Get-Datastore | where {$_.type -match \"vsan\"}\n}\nelse{\nWrite-Host \"vSAN is not enabled, this finding is not applicable\"\n}\n\nIf vSAN is enabled and the datastore is named \"vsanDatastore\", this is a finding.",
            "FixText": "From the vSphere Client, go to Hosts and Clusters >> select a vSAN Enabled Cluster >> Datastores. \n\nRight-click on the datastore named \"vsanDatastore\" and select \"Rename\". \n\nRename the datastore based on site-specific naming standards.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nIf($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){\nWrite-Host \"vSAN Enabled Cluster found\"\n$Clusters = Get-Cluster | where {$_.VsanEnabled} \nForeach ($clus in $clusters){\n $clus | Get-Datastore | where {$_.type -match \"vsan\"} | Set-Datastore -Name $(($clus.name) + \"_vSAN_Datastore\")\n}\n}\nelse{\nWrite-Host \"vSAN is not enabled, this finding is not applicable\"\n}",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243112",
            "RuleID": "SV-243112r816857_rule",
            "StigID": "VCTR-67-000057",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must enable TLS 1.2 exclusively.",
            "Description": "<VulnDiscussion>TLS 1.0 and 1.1 are deprecated protocols with well published shortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces and TLS 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third-party integrations and add-ons to vSphere. Test these integrations carefully after implementing TLS 1.2 and roll back where appropriate. On interfaces where required functionality is broken with TLS 1.2 this finding is N/A until such time as the third party software supports TLS 1.2.\n\nMake sure you modify TLS settings in the following order: 1. Platform Services Controls (if applicable), 2. vCenter, 3. ESXi</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "TLS 1.0 and 1.1 are deprecated protocols with well published shortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces and TLS 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third-party integrations and add-ons to vSphere. Test these integrations carefully after implementing TLS 1.2 and roll back where appropriate. On interfaces where required functionality is broken with TLS 1.2 this finding is N/A until such time as the third party software supports TLS 1.2.\n\nMake sure you modify TLS settings in the following order: 1. Platform Services Controls (if applicable), 2. vCenter, 3. ESXi",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Windows, this is not applicable.\n\nOn the vCenter Server, execute the following command:\n\n# $(find /usr/lib -name reconfigureVc) scan\n\nIf the output indicates versions of TLS other than 1.2 are enabled, this is a finding.",
            "FixText": "On the vCenter Server, execute the following commands:\n\n# $(find /usr/lib -name reconfigureVc) backup\n# $(find /usr/lib -name reconfigureVc) update -p TLS1.2\n\nvCenter services will be restarted as part of the reconfiguration, the OS will not be restarted.\n\nYou can add the --no-restart flag to restart services at a later time.\n\nChanges will not take effect until all services are restarted or the machine is rebooted.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243113",
            "RuleID": "SV-243113r719582_rule",
            "StigID": "VCTR-67-000058",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server Machine SSL certificate must be issued by a DoD certificate authority.",
            "Description": "<VulnDiscussion>The default self-signed, VMCA-issued vCenter reverse proxy certificate must be replaced with a DoD-approved certificate. The use of a DoD certificate on the vCenter reverse proxy assures clients that the service they are connecting to is legitimate and properly secured.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The default self-signed, VMCA-issued vCenter reverse proxy certificate must be replaced with a DoD-approved certificate. The use of a DoD certificate on the vCenter reverse proxy assures clients that the service they are connecting to is legitimate and properly secured.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Certificates >> Certificate Management >> Machine SSL Certificate. \n\nClick \"View Details\". \n\nExamine the \"Issuer Information\" block.\n\nIf the issuer specified is not a DoD-approved certificate authority (or other AO approved CA), this is a finding.",
            "FixText": "Obtain a DoD-issued certificate and private key for each vCenter in the system, following these requirements:\n\nKey size: 2048 bits or more (PEM encoded)\nCRT format (Base-64)\nx509 version 3\nSubjectAltName must contain DNS Name=<machine_FQDN>\nContains the following Key Usages: Digital Signature, Non Repudiation, Key Encipherment\n\nEnsure that the certificate includes all intermediates and root certificates. If it does not, export the entire certificate issuing chain up to the root in Base-64 format and concatenate the individual certificates onto the issued certificate.\n\nFrom the vSphere Client, go to Administration >> Certificates >> Certificate Management >> Machine SSL Certificate. \n\nClick Actions >> Replace. \n\nSupply the CA-issued certificate with the exported roots file and the private key. \n\nClick \"Replace\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243114",
            "RuleID": "SV-243114r719585_rule",
            "StigID": "VCTR-67-000059",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must enable certificate based authentication.",
            "Description": "<VulnDiscussion>The vSphere Client is capable of CAC authentication. This capability must be enabled and properly configured.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The vSphere Client is capable of CAC authentication. This capability must be enabled and properly configured.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "See supplemental document.\n\nEnsure that CAC authentication is required to log in to the vSphere Client. If CAC authentication is not required, this is a finding.",
            "FixText": "Configure CAC Authentication per supplemental document.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243115",
            "RuleID": "SV-243115r719588_rule",
            "StigID": "VCTR-67-000060",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must enable revocation checking for certificate-based authentication.",
            "Description": "<VulnDiscussion>The system must establish the validity of the user-supplied identity certificate using OCSP and/or CRL revocation checking.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The system must establish the validity of the user-supplied identity certificate using OCSP and/or CRL revocation checking.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Smart Card Authentication. \n\nUnder Smart card authentication settings >> Certificate revocation, verify that \"Revocation check\" does not show as disabled.\n\nIf \"Revocation check\" shows as disabled, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On > Configuration >> Smart Card Authentication. \n\nUnder Smart card authentication settings >> Certificate revocation, click the \"Edit\" button.\n\nBy default, the PSC will use the CRL from the certificate to check revocation check status. \n\nOCSP with CRL fallback is recommended, but\u00a0this setting is site specific and should be configured appropriately.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243116",
            "RuleID": "SV-243116r719591_rule",
            "StigID": "VCTR-67-000061",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must disable Password and Windows integrated authentication.",
            "Description": "<VulnDiscussion>All forms of authentication other than CAC must be disabled. Password authentication can be temporarily re-enabled for emergency access to the local SSO domain accounts but it must be disable as soon as CAC authentication is functional.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "All forms of authentication other than CAC must be disabled. Password authentication can be temporarily re-enabled for emergency access to the local SSO domain accounts but it must be disable as soon as CAC authentication is functional.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Windows, this is not applicable.\n\nFrom the vSphere Client go to Administration >> Single Sign-On >> Configuration >> Smart Card Authentication.\n\nIf \"Smart card authentication\" is not enabled and \"Password and windows session authentication\" is not disabled, this is a finding.",
            "FixText": "From the vSphere Client go to Administration >> Single Sign-On >> Configuration >> Smart Card Authentication. Next to \"Authentication methods\", click \"Edit\". Click the \"Enable smart card authentication\" radio button and click \"Save\".\n\nTo re-enable password authentication for troubleshooting purposes, run the following command on the vCenter server:\n\n/opt/vmware/bin/sso-config.sh -set_authn_policy -pwdAuthn true -winAuthn false -certAuthn false -securIDAuthn false -t vsphere.local",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243117",
            "RuleID": "SV-243117r719594_rule",
            "StigID": "VCTR-67-000062",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must enable the login banner for vSphere Client.",
            "Description": "<VulnDiscussion>The required legal notice must be configured for the vCenter Web Client.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The required legal notice must be configured for the vCenter Web Client.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Login Message.\n\nIf selection boxes next to \"Show login message\" are disabled or if \"Details of login message\" is not configured to the standard DoD User Agreement, this is a finding.\n\nNote: Supplementary Information: DoD Logon Banner\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Login Message. \n\nClick \"Edit\". \n\nClick the \"Show login message\" slider to enable. \n\nConfigure the \"Login message\" to \"DoD User Agreement\". \n\nClick the \"Consent checkbox\" slider to enable. \n\nSet the \"Details of login message\" to the standard DoD User Agreement text.\n\nClick \"Save\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243118",
            "RuleID": "SV-243118r719597_rule",
            "StigID": "VCTR-67-000063",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must restrict access to the cryptographic role.",
            "Description": "<VulnDiscussion>In vSphere 6.7, the built-in \"Administrator\" role contains permission to perform cryptographic operations such as KMS functions and encrypting and decrypting virtual machine disks. This role must be reserved for cryptographic administrators where VM encryption and/or vSAN encryption is in use. \n\nA new built-in role called \"No Cryptography Administrator\" exists to provide all administrative permissions except cryptographic operations. Permissions must be restricted such that normal vSphere administrators are assigned the 'No Cryptography Administrator' role or more restrictive. \n\nThe \"Administrator\" role must be tightly controlled and must not be applied to administrators who will not be doing cryptographic work. Catastrophic data loss can result from poorly administered cryptography.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "In vSphere 6.7, the built-in \"Administrator\" role contains permission to perform cryptographic operations such as KMS functions and encrypting and decrypting virtual machine disks. This role must be reserved for cryptographic administrators where VM encryption and/or vSAN encryption is in use. \n\nA new built-in role called \"No Cryptography Administrator\" exists to provide all administrative permissions except cryptographic operations. Permissions must be restricted such that normal vSphere administrators are assigned the 'No Cryptography Administrator' role or more restrictive. \n\nThe \"Administrator\" role must be tightly controlled and must not be applied to administrators who will not be doing cryptographic work. Catastrophic data loss can result from poorly administered cryptography.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Access Control >>\u00a0Roles.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VIPermission | Where {$_.Role -eq \"Admin\"} | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto\n\nIf there are any users other than Solution Users with the \"Administrator\" role that are not explicitly designated for cryptographic operations, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nMove any accounts not explicitly designated for cryptographic operations, other than Solution Users, to other roles such as \"No Cryptography Administrator\".",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243119",
            "RuleID": "SV-243119r719600_rule",
            "StigID": "VCTR-67-000064",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must restrict access to cryptographic permissions.",
            "Description": "<VulnDiscussion>These permissions must be reserved for cryptographic administrators where VM encryption and/or vSAN encryption is in use. Catastrophic data loss can result from poorly administered cryptography.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "These permissions must be reserved for cryptographic administrators where VM encryption and/or vSAN encryption is in use. Catastrophic data loss can result from poorly administered cryptography.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nHighlight each role and click the \"Privileges\" button in the right pane. \n\nVerify that only the Administrator and any site-specific cryptographic group(s) have the following permissions:\n\nCryptographic Operations privileges\nGlobal.Diagnostics\nHost.Inventory.Add host to cluster\nHost.Inventory.Add standalone host\nHost.Local operations.Manage user groups\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\n$roles = Get-VIRole\nForEach($role in $roles){\n    $privileges = $role.PrivilegeList\n    If($privileges -match \"Crypto*\" -or $privileges -match \"Global.Diagnostics\" -or $privileges -match \"Host.Inventory.Add*\" -or $privileges -match \"Host.Local operations.Manage user groups\"){\n    Write-Host \"$role has Cryptographic privileges\"\n    }\n}\n\nIf any role other than Administrator and any site-specific group(s) have any of these permissions, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nHighlight each role and click the pencil button if it is enabled. \n\nRemove the following permissions from any group other than Administrator and any site-specific cryptographic group(s):\n\nCryptographic Operations privileges\nGlobal.Diagnostics\nHost.Inventory.Add host to cluster\nHost.Inventory.Add standalone host\nHost.Local operations.Manage user groups",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243120",
            "RuleID": "SV-243120r719603_rule",
            "StigID": "VCTR-67-000065",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must have Mutual CHAP configured for vSAN iSCSI targets.",
            "Description": "<VulnDiscussion>When Mutual CHAP is enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. There is a potential for a MitM attack when not authenticating both the iSCSI target and host in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When Mutual CHAP is enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. There is a potential for a MitM attack when not authenticating both the iSCSI target and host in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If no clusters are enabled for vSAN or if vSAN is enabled but iSCSI is not enabled, this is not applicable.\n\nFrom the vSphere Client, go to Hosts and Clusters >> select a vSAN Enabled Cluster >> Configure >> vSAN >> iSCSI Target Service.\n\nFor each iSCSI target, review the value in the \"Authentication\" column.\n\nIf the Authentication method is not set to \"CHAP_Mutual\" for any iSCSI target, this is a finding.",
            "FixText": "From the vSphere Client, go to Hosts and Clusters >> select a vSAN Enabled Cluster >> Configure >> vSAN >> iSCSI Target Service.\n\nFor each iSCSI target, select the item and click \"Edit\". \n\nChange the \"Authentication\" field to \"Mutual CHAP\" and configure the incoming and outgoing users and secrets appropriately.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243121",
            "RuleID": "SV-243121r719606_rule",
            "StigID": "VCTR-67-000066",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must have new Key Encryption Keys (KEKs) reissued at regular intervals for vSAN encrypted datastore(s).",
            "Description": "<VulnDiscussion>The KEK for a vSAN encrypted datastore is generated by the Key Management Server (KMS) and serves as a wrapper and lock around the Disk Encryption Key (DEK). The DEK is generated by the host and is used to encrypt and decrypt the datastore.\n\nA mustow rekey is a procedure in which the KMS issues a new KEK to the ESXi host that rewraps the DEK but does not change the DEK or any data on disk. This operation must be done on a regular, site-defined interval and can be viewed as similar in criticality to changing an administrative password. \n\nIf the KMS is compromised, a standing operational procedure to rekey will put a time limit on the usefulness of any stolen KMS data.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The KEK for a vSAN encrypted datastore is generated by the Key Management Server (KMS) and serves as a wrapper and lock around the Disk Encryption Key (DEK). The DEK is generated by the host and is used to encrypt and decrypt the datastore.\n\nA mustow rekey is a procedure in which the KMS issues a new KEK to the ESXi host that rewraps the DEK but does not change the DEK or any data on disk. This operation must be done on a regular, site-defined interval and can be viewed as similar in criticality to changing an administrative password. \n\nIf the KMS is compromised, a standing operational procedure to rekey will put a time limit on the usefulness of any stolen KMS data.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Interview the SA to determine that a procedure has been implemented to perform a mustow rekey of all vSAN encrypted datastores at regular, site-defined intervals.\n\nVMware recommends a 60-day rekey task, but this interval must be defined by the SA and the ISSO.\n\nIf vSAN encryption is not in use, this is not a finding.",
            "FixText": "If vSAN encryption is in use, ensure that a regular rekey procedure is in place.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243122",
            "RuleID": "SV-243122r719609_rule",
            "StigID": "VCTR-67-000067",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must disable the Customer Experience Improvement Program (CEIP).",
            "Description": "<VulnDiscussion>The VMware CEIP sends VMware anonymized system information that is used to improve the quality, reliability, and functionality of VMware products and services. For confidentiality purposes, this feature must be disabled.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The VMware CEIP sends VMware anonymized system information that is used to improve the quality, reliability, and functionality of VMware products and services. For confidentiality purposes, this feature must be disabled.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Deployment >> Customer Experience Improvement Program.\n\nIf Customer Experience Improvement \"Program Status\" is \"Joined\", this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Deployment >> Customer Experience Improvement Program.\n\nClick the \"Leave\" button.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243123",
            "RuleID": "SV-243123r719612_rule",
            "StigID": "VCTR-67-000068",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must use secure Lightweight Directory Access Protocol (LDAPS) when adding an SSO identity source.",
            "Description": "<VulnDiscussion>LDAP is an industry-standard protocol for querying directory services such as Active Directory. This protocol can operate in clear text or over an SSL/TLS encrypted tunnel. \n\nTo protect confidentiality of LDAP communications, secure LDAP (LDAPS) must be explicitly configured when adding an LDAP identity source in vSphere SSO. When configuring an identity source and supplying an SSL certificate, vCenter will enforce LDAPs. The server URLs do not need to be explicitly provided as long as an SSL certificate is uploaded.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "LDAP is an industry-standard protocol for querying directory services such as Active Directory. This protocol can operate in clear text or over an SSL/TLS encrypted tunnel. \n\nTo protect confidentiality of LDAP communications, secure LDAP (LDAPS) must be explicitly configured when adding an LDAP identity source in vSphere SSO. When configuring an identity source and supplying an SSL certificate, vCenter will enforce LDAPs. The server URLs do not need to be explicitly provided as long as an SSL certificate is uploaded.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration. \n\nClick the \"Identity Sources\" tab.\n\nFor each identity source of type \"Active Directory\", if the \"Server URL\" does not indicate \"ldaps://\", this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration. \n\nClick the \"Identity Sources\" tab.\n\nFor each identity source of type \"Active Directory\" where LDAPS is not configured, highlight the item and click \"Edit\". \n\nEnsure the primary and secondary server URLs, if specified, are configured for \"ldaps://\". \n\nAt the bottom, click the \"Browse\" button, select the AD LDAP cert previously exported to the local computer, click \"Open\", and \"Save\" to complete modifications.\n\nNote: With LDAPS, the server must be a specific domain controller and its specific certificate or the domain alias with a certificate that is valid for that URL.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243124",
            "RuleID": "SV-243124r719615_rule",
            "StigID": "VCTR-67-000069",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must use a limited privilege account when adding an LDAP identity source.",
            "Description": "<VulnDiscussion>When adding an LDAP identity source to vSphere SSO, the account used to bind to AD must be minimally privileged. This account only requires read rights to the base DN specified. Any other permissions inside or outside of that OU are unnecessary and violate least privilege.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "When adding an LDAP identity source to vSphere SSO, the account used to bind to AD must be minimally privileged. This account only requires read rights to the base DN specified. Any other permissions inside or outside of that OU are unnecessary and violate least privilege.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration. \n\nClick the \"Identity Sources\" tab.\n\nFor each identity source with of type \"Active Directory\", highlight the item and click \"Edit\". \n\nIf the account that is configured to bind to the LDAPS server is not one with minimal privileges, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration. \n\nClick the \"Identity Sources\" tab.\n\nFor each identity source that has been configured with a highly privileged AD account, highlight the item and click \"Edit\". \n\nChange the username and password to one with read-only rights to the base DN and complete the dialog.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243125",
            "RuleID": "SV-243125r719618_rule",
            "StigID": "VCTR-67-000070",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000190",
            "RuleTitle": "The vCenter Server must not automatically refresh client sessions.",
            "Description": "<VulnDiscussion>Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. Automatic client session refreshes keep unused sessions online, blocking session timeouts.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. Automatic client session refreshes keep unused sessions online, blocking session timeouts.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nOn the vCenter Server locate the \"webclient.properties\" file in \nC:\\ProgramData\\VMware\\vCenterServer\\cfg\\vsphere-client \n\nFind the \"refresh.rate =\" line in the \"webclient.properties\" file. \n\nIf the refresh rate is not set to \"-1\" in the \"webclient.properties\" file, this is a finding.",
            "FixText": "Change the refresh rate value by editing the \"webclient.properties\" file. \n\nOn the vCenter Server locate the \"webclient.properties\" file in \nC:\\ProgramData\\VMware\\vCenterServer\\cfg\\vsphere-client \n\nEdit the file to include the line \"refresh.rate = -1\" where \"-1\" indicates sessions are not automatically refreshed. Uncomment the line if necessary. \n\nAfter editing the file the vSphere Client service must be restarted.",
            "CCI": "CCI-001133"
        },
        {
            "VulnID": "V-243126",
            "RuleID": "SV-243126r719621_rule",
            "StigID": "VCTR-67-000071",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000190",
            "RuleTitle": "The vCenter Server must terminate management sessions after 10 minutes of inactivity.",
            "Description": "<VulnDiscussion>Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system level network connection. This does not mean that the application terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system level network connection. This does not mean that the application terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nBy default, vSphere Client sessions terminate after \"120\" minutes of idle time, requiring the user to log in again to resume using the client. You can view the timeout value by viewing the \"webclient.properties\" file.\n\nOn the vCenter Server locate the \"webclient.properties\" file in \nC:\\ProgramData\\VMware\\vCenterServer\\cfg\\vsphere-client\n\nFind the \"session.timeout =\" line in the \"webclient.properties\" file.\n\nIf the session timeout is not set to \"10\" in the \"webclient.properties\" file, this is a finding.",
            "FixText": "Change the timeout value by editing the \"webclient.properties\" file.\n\nOn the vCenter Server locate the \"webclient.properties\" file in \nC:\\ProgramData\\VMware\\vCenterServer\\cfg\\vsphere-client\n\nEdit the file to include the line \"session.timeout = 10\" where \"10\" is the timeout value in minutes.  Uncomment the line if necessary.\n\nAfter editing the file the vSphere Client service must be restarted.",
            "CCI": "CCI-001133"
        },
        {
            "VulnID": "V-243127",
            "RuleID": "SV-243127r719624_rule",
            "StigID": "VCTR-67-000072",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server services must be ran using a service account instead of a built-in Windows account.",
            "Description": "<VulnDiscussion>You can use the Microsoft Windows built-in system account or a domain user account to run vCenter Server.  The Microsoft Windows built-in system account has more permissions and rights on the server than the vCenter Server system requires, which can contribute to security problems. With a domain user account, you can enable Windows authentication for SQL Server; it also allows more granular security and logging. The installing account only needs to be a member of the Administrators group, and have permission to act as part of the operating system and log on as a service. If you are using SQL Server for the vCenter database, you must configure the SQL Server database to allow the domain account access to SQL Server.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "You can use the Microsoft Windows built-in system account or a domain user account to run vCenter Server.  The Microsoft Windows built-in system account has more permissions and rights on the server than the vCenter Server system requires, which can contribute to security problems. With a domain user account, you can enable Windows authentication for SQL Server; it also allows more granular security and logging. The installing account only needs to be a member of the Administrators group, and have permission to act as part of the operating system and log on as a service. If you are using SQL Server for the vCenter database, you must configure the SQL Server database to allow the domain account access to SQL Server.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nThe following services should be set to run as a service account:\n\nVMware Content Library Service\nVMware Inventory Service\nVMware Performance Charts\nVMware VirtualCenter Server\n\nvCenter should be installed using the service account as that will configure the services appropriately.\n\nIf vCenter is not installed with a service account, this is a finding.\n\nIf the services identified in this control are not running as a service account, this is a finding.",
            "FixText": "For each of the following services open the services console on the vCenter server and right-click, select \"Properties\" on the service.  Go to the \"Log On\" tab and configure the service to run as a service account and restart the service.\n\nVMware Content Library Service\nVMware Inventory Service\nVMware Performance Charts\nVMware VirtualCenter Server",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243128",
            "RuleID": "SV-243128r719627_rule",
            "StigID": "VCTR-67-000073",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must minimize access to the vCenter server.",
            "Description": "<VulnDiscussion>After someone has logged in to the vCenter Server system, it becomes more difficult to prevent what they can do. In general, logging in to the vCenter Server system should be limited to very privileged administrators, and then only for the purpose of administering vCenter Server or the host OS. Anyone logged in to the vCenter Server can potentially cause harm, either intentionally or unintentionally, by altering settings and modifying processes. They also have potential access to vCenter credentials, such as the SSL certificate.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "After someone has logged in to the vCenter Server system, it becomes more difficult to prevent what they can do. In general, logging in to the vCenter Server system should be limited to very privileged administrators, and then only for the purpose of administering vCenter Server or the host OS. Anyone logged in to the vCenter Server can potentially cause harm, either intentionally or unintentionally, by altering settings and modifying processes. They also have potential access to vCenter credentials, such as the SSL certificate.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nLogin to the vCenter server and verify the only local administrators group contains users and/or groups that contain vCenter Administrators.\n\nIf the local administrators group contains users and/or groups that are not vCenter Administrators such as \"Domain Admins\", this is a finding.",
            "FixText": "Remove all unnecessary users and/or groups from the local administrators group of the vCenter server.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243129",
            "RuleID": "SV-243129r719630_rule",
            "StigID": "VCTR-67-000074",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server Administrators must clean up log files after failed installations.",
            "Description": "<VulnDiscussion>In certain cases, if the vCenter installation fails, a log file (with a name of the form \u201chs_err_pidXXXX\u201d) is created that contains the database password in plain text. An attacker who breaks into the vCenter Server could potentially steal this password and access the vCenter Database.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "In certain cases, if the vCenter installation fails, a log file (with a name of the form \u201chs_err_pidXXXX\u201d) is created that contains the database password in plain text. An attacker who breaks into the vCenter Server could potentially steal this password and access the vCenter Database.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nIf at any time a vCenter Server installation fails, only the log files of format \"hs_err_pid....\" should be identified on the Windows host and deleted securely before putting the host into production. Determine if a site policy exists for handling failed installation cleanup of the Windows host prior to deployment. Using the Windows host search function, determine the existence of any log files of format \"hs_err_pid\".\n\nIf a file name of the format \"hs_err_pid\" is found, this is a finding.\n\nIf a site policy does not exist and/or is not followed, this is a finding.",
            "FixText": "Develop a site policy for handling failed installation cleanup of the Windows host prior to deployment. Using the Windows host search function, determine the existence of any log files of format \"hs_err_pid\" and remove them.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243130",
            "RuleID": "SV-243130r719633_rule",
            "StigID": "VCTR-67-000075",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must enable all tasks to be shown to Administrators in the Web Client.",
            "Description": "<VulnDiscussion>By default not all tasks are shown in the web client to administrators and only that user's tasks will be shown.  Enabling all tasks to be shown will allow the administrator to potentially see any malicious activity they may miss with the view disabled.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By default not all tasks are shown in the web client to administrators and only that user's tasks will be shown.  Enabling all tasks to be shown will allow the administrator to potentially see any malicious activity they may miss with the view disabled.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nVerify the \"webclient.properties\" file contains the line \"show.allusers.tasks = true\".\n\nOn the vCenter Server locate the \"webclient.properties\" file in \nC:\\ProgramData\\VMware\\vCenterServer\\cfg\\vsphere-client\n\nIf \"show.allusers.tasks\" is not set to \"true\", this is a finding.",
            "FixText": "Edit the \"webclient.properties\" file to set the \"show.allusers.tasks\" value to \"true\".\n\nOn the vCenter Server locate the \"webclient.properties\" file in \nC:\\ProgramData\\VMware\\vCenterServer\\cfg\\vsphere-client\n\nAfter editing the file the vSphere Client service will need to be restarted.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243131",
            "RuleID": "SV-243131r719636_rule",
            "StigID": "VCTR-67-000076",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server Administrator role must be secured and assigned to specific users other than a Windows Administrator.",
            "Description": "<VulnDiscussion>By default, vCenter Server grants full administrative rights to the local administrator's account, which can be accessed by domain administrators. Separation of duties dictates that full vCenter Administrative rights should be granted only to those administrators who are required to have it. This privilege should not be granted to any group whose membership is not strictly controlled. Therefore, administrative rights should be removed from the local Windows server to users who are not vCenter administrators.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "By default, vCenter Server grants full administrative rights to the local administrator's account, which can be accessed by domain administrators. Separation of duties dictates that full vCenter Administrative rights should be granted only to those administrators who are required to have it. This privilege should not be granted to any group whose membership is not strictly controlled. Therefore, administrative rights should be removed from the local Windows server to users who are not vCenter administrators.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nIf enhanced linked mode is used then local windows authentication is not available to vCenter, this is not applicable.\n\nUnder the computer management console for windows view the local administrators group and verify only vCenter administrators have access to the vCenter server.\n\nOther groups and users that are not vCenter administrators should be removed from the local administrators group such as Domain Admins.\n\nIf there are any groups or users present in the local administrators group of the vCenter server, this is a finding.",
            "FixText": "Under the computer management console for windows view the local administrators group and remove any users or groups that do not fit the criteria defined in the check content.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243132",
            "RuleID": "SV-243132r719639_rule",
            "StigID": "VCTR-67-000077",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must enable TLS 1.2 exclusively.",
            "Description": "<VulnDiscussion>TLS 1.0 and 1.1 are deprecated protocols with well published shortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces and TLS 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third party integrations and add-ons to vSphere. Test these integrations carefully after implementing TLS 1.2 and roll back where appropriate. On interfaces where required functionality is broken with TLS 1.2 this finding is N/A until such time as the third party software supports TLS 1.2.\n\nMake sure you modify TLS settings in the following order: 1. Platform Services Controls (if applicable), 2. vCenter, 3. ESXi</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "TLS 1.0 and 1.1 are deprecated protocols with well published shortcomings and vulnerabilities. TLS 1.2 should be disabled on all interfaces and TLS 1.1 and 1.0 disabled where supported. Mandating TLS 1.2 may break third party integrations and add-ons to vSphere. Test these integrations carefully after implementing TLS 1.2 and roll back where appropriate. On interfaces where required functionality is broken with TLS 1.2 this finding is N/A until such time as the third party software supports TLS 1.2.\n\nMake sure you modify TLS settings in the following order: 1. Platform Services Controls (if applicable), 2. vCenter, 3. ESXi",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nDownload the VMware TLS Reconfigurator utility from my.vmware.com. Follow installation instructions for your vCenter platform according to VMware KB 2147469.\n\n1. Open a command prompt and cd to C:\\Program Files\\VMware\\CIS\\vSphereTlsReconfigurator\\VcTlsReconfigurator\n2. Enter command \"reconfigureVc scan\" and press \"Enter\"\n\nIf the output indicates versions of TLS other than 1.2 are enabled, this is a finding.",
            "FixText": "Download the VMware TLS Reconfigurator utility from my.vmware.com. Follow installation instructions for your vCenter platform according to VMware KB 2147469. Run the following commands.\n\n1. Open a command prompt and cd to C:\\Program Files\\VMware\\CIS\\vSphereTlsReconfigurator\\VcTlsReconfigurator\n2. Enter command \"reconfigureVc backup\" and press \"Enter\"\n3. Enter command \"reconfigureVc update -p TLS1.2\" and press \"Enter\"\n\nvCenter services will be restarted as part of the reconfiguration, the OS will not be restarted. You can add the --no-restart flag to restart services at a later time. Changes will not take effect until all services are restarted or the machine is rebooted.",
            "CCI": "CCI-000366"
        },
        {
            "VulnID": "V-243133",
            "RuleID": "SV-243133r719642_rule",
            "StigID": "VCTR-67-000078",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516",
            "RuleTitle": "The vCenter Server must disable Password and Windows integrated authentication.",
            "Description": "<VulnDiscussion>All forms of authentication other than CAC must be disabled. Password authentication can be temporarily reenabled for emergency access to the local SSO domain accounts, but it must be disabled as soon as CAC authentication is functional.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "All forms of authentication other than CAC must be disabled. Password authentication can be temporarily reenabled for emergency access to the local SSO domain accounts, but it must be disabled as soon as CAC authentication is functional.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Note: For vCenter Server Appliance, this is not applicable.\n\nFrom the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Smart Card Authentication.\n\nIf \"Smart card authentication\" is not enabled and \"Password and windows session authentication\" is not disabled, this is a finding.",
            "FixText": "From the vSphere Client, go to Administration >> Single Sign-On >> Configuration >> Smart Card Authentication. \n\nNext to \"Authentication methods\", click \"Edit\". \n\nClick the \"Enable smart card authentication\" radio button and click \"Save\".\n\nTo reenable password authentication for troubleshooting purposes, run the following command on the vCenter server:\n\nC:\\Program Files\\VMware\\VCenter server\\VMware Identity Services\\sso-config.bat -set_authn_policy -pwdAuthn true -winAuthn false -certAuthn false -securIDAuthn false -t vsphere.local",
            "CCI": "CCI-000366"
        }
    ]
}