{
    "Title": "VMW vRealize Automation 7.x vIDM Security Technical Implementation Guide",
    "Description": "This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.",
    "Version": "1",
    "Release": "1 ",
    "BenchmarkDate": "28 Sep 2018",
    "ReleaseInfo": "Release: 1 Benchmark Date: 28 Sep 2018",
    "Source": "STIG.DOD.MIL",
    "Notice": "terms-of-use",
    "Rules": [
        {
            "VulnID": "V-90283",
            "RuleID": "SV-100933r1_rule",
            "StigID": "VRAU-VI-000020",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000016-AS-000013",
            "RuleTitle": "vIDM must be configured to log activity to the horizon.log file.",
            "Description": "<VulnDiscussion>Logging must be utilized in order to track system activity, assist in diagnosing system issues, and provide evidence needed for forensic investigations post security incident. Remote access by administrators requires that the admin activity be logged. Application servers provide a web and command line-based remote management capability for managing the application server. Application servers must ensure that all actions related to administrative functionality such as application server configuration are logged.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Logging must be utilized in order to track system activity, assist in diagnosing system issues, and provide evidence needed for forensic investigations post security incident. Remote access by administrators requires that the admin activity be logged. Application servers provide a web and command line-based remote management capability for managing the application server. Application servers must ensure that all actions related to administrative functionality such as application server configuration are logged.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "At the command prompt, execute the following command:\n\ngrep log4j.appender.rollingFile.file /usr/local/horizon/conf/saas-log4j.properties\n\nIf the \"log4j.appender.rollingFile.file\" is not set to \"/opt/vmware/horizon/workspace/logs/horizon.log\" or is commented out or is missing, this is a finding.",
            "FixText": "Navigate to and open /usr/local/horizon/conf/saas-log4j.properties.\n\nConfigure the vIDM policy log file with the following lines:\n\nlog4j.appender.rollingFile=org.apache.log4j.RollingFileAppender\nlog4j.appender.rollingFile.MaxFileSize=50MB\nlog4j.appender.rollingFile.MaxBackupIndex=7\nlog4j.appender.rollingFile.Encoding=UTF-8\nlog4j.appender.rollingFile.file=/opt/vmware/horizon/workspace/logs/horizon.log\nlog4j.appender.rollingFile.append=true\nlog4j.appender.rollingFile.layout=org.apache.log4j.PatternLayout\nlog4j.appender.rollingFile.layout.ConversionPattern=%d{ISO8601} %-5p (%t) [%X{orgId};%X{userId};%X{ip}] %c - %m%n",
            "CCI": "CCI-000067"
        },
        {
            "VulnID": "V-90285",
            "RuleID": "SV-100935r1_rule",
            "StigID": "VRAU-VI-000195",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000148-AS-000101",
            "RuleTitle": "vIDM must be configured correctly for the site enterprise user management system.",
            "Description": "<VulnDiscussion>To assure accountability and prevent unauthorized access, application server users must be uniquely identified and authenticated. This is typically accomplished via the use of a user store which is either local (OS-based) or centralized (LDAP) in nature. To ensure support to the enterprise, the authentication must utilize an enterprise solution.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "To assure accountability and prevent unauthorized access, application server users must be uniquely identified and authenticated. This is typically accomplished via the use of a user store which is either local (OS-based) or centralized (LDAP) in nature. To ensure support to the enterprise, the authentication must utilize an enterprise solution.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Interview the ISSO. Obtain the correct configuration for the site's Directory services.\n\nIn a browser, log in with Tenant admin privileges and navigate to the Administration page.\n\nSelect Directories Management >> Directories.\n\nClick on the configured Directory to review the configuration. \n\nIf the Directory service is not configured correctly, this is a finding.",
            "FixText": "Interview the ISSO. Obtain the correct configuration for the site's Directory services.\n\nIn a browser, log in with Tenant admin privileges, and navigate to the Administration page.\n\nSelect Directories Management >> Directories.\n\nClick on the configured Directory to edit the configuration in accordance with the instructions provided by the ISSO.",
            "CCI": "CCI-000764"
        },
        {
            "VulnID": "V-90287",
            "RuleID": "SV-100937r1_rule",
            "StigID": "VRAU-VI-000240",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-APP-000172-AS-000121",
            "RuleTitle": "vIDM must utilize encryption when using LDAP for authentication.",
            "Description": "<VulnDiscussion>Passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission. Application servers have the capability to utilize LDAP directories for authentication. If LDAP connections are not protected during transmission, sensitive authentication credentials can be stolen. When the application server utilizes LDAP, the LDAP traffic must be encrypted.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission. Application servers have the capability to utilize LDAP directories for authentication. If LDAP connections are not protected during transmission, sensitive authentication credentials can be stolen. When the application server utilizes LDAP, the LDAP traffic must be encrypted.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "In a browser, log in with Tenant admin privileges, and navigate to the Administration page.\n\nSelect Directories Management >> Directories.\n\nClick on the configured Directory to review the configuration. \n\nIf the SSL checkbox is not selected, this is a finding.\n\nNote: The checkbox is labeled, \"This Directory requires all connections to use SSL\".",
            "FixText": "In a browser, log in with Tenant admin privileges, and navigate to the Administration page.\n\nSelect Directories Management >> Directories.\n\nClick on the configured Directory to review the configuration. \n\nCheck the checkbox that is labeled, \"This Directory requires all connections to use SSL\". \n\nClick \"Save\".",
            "CCI": "CCI-000197"
        },
        {
            "VulnID": "V-90289",
            "RuleID": "SV-100939r1_rule",
            "StigID": "VRAU-VI-000315",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000225-AS-000154",
            "RuleTitle": "vIDM must be configured to provide clustering.",
            "Description": "<VulnDiscussion>This requirement is dependent upon system MAC and confidentiality. If the system MAC and confidentiality levels do not specify redundancy requirements, this requirement is NA. Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. When application failure is encountered, preserving application state facilitates application restart and return to the operational mode of the organization with less disruption of mission/business processes. Clustering of multiple application servers is a common approach to providing fail-safe application availability when system MAC and confidentiality levels require redundancy.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "This requirement is dependent upon system MAC and confidentiality. If the system MAC and confidentiality levels do not specify redundancy requirements, this requirement is NA. Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. When application failure is encountered, preserving application state facilitates application restart and return to the operational mode of the organization with less disruption of mission/business processes. Clustering of multiple application servers is a common approach to providing fail-safe application availability when system MAC and confidentiality levels require redundancy.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Interview the ISSO. Obtain the correct configuration for clustering used by the site.\n\nReview the vRealize Automation appliance's installation, environment, and configuration. Determine if vRA clustering has been correctly implemented.\n\nIf vRA is not correctly implementing clustering, this is a finding.",
            "FixText": "Interview the ISSO. Obtain the correct configuration for clustering used by the site.\n\nConfigure vRealize Automation to be in compliance with the clustering design provided by the ISSO.",
            "CCI": "CCI-001190"
        },
        {
            "VulnID": "V-90291",
            "RuleID": "SV-100941r1_rule",
            "StigID": "VRAU-VI-000340",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000266-AS-000168",
            "RuleTitle": "vIDM must be configured to log activity to the horizon.log file.",
            "Description": "<VulnDiscussion>The structure and content of error messages need to be carefully considered by the organization and development team. Any application providing too much information in error logs and in administrative messages to the screen risks compromising the data and security of the application and system. The extent to which the application server is able to identify and handle error conditions is guided by organizational policy and operational requirements. Adequate logging levels and system performance capabilities need to be balanced with data protection requirements. The structure and content of error messages needs to be carefully considered by the organization and development team. Application servers must have the capability to log at various levels, which can provide log entries for potential security-related error events. An example is the capability for the application server to assign a criticality level to a failed logon attempt error message, a security-related error message being of a higher criticality.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "The structure and content of error messages need to be carefully considered by the organization and development team. Any application providing too much information in error logs and in administrative messages to the screen risks compromising the data and security of the application and system. The extent to which the application server is able to identify and handle error conditions is guided by organizational policy and operational requirements. Adequate logging levels and system performance capabilities need to be balanced with data protection requirements. The structure and content of error messages needs to be carefully considered by the organization and development team. Application servers must have the capability to log at various levels, which can provide log entries for potential security-related error events. An example is the capability for the application server to assign a criticality level to a failed logon attempt error message, a security-related error message being of a higher criticality.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "At the command prompt, execute the following command:\n\ngrep log4j.appender.rollingFile.file /usr/local/horizon/conf/saas-log4j.properties\n\nIf the \"log4j.appender.rollingFile.file\" is not set to \"/opt/vmware/horizon/workspace/logs/horizon.log\" or is commented out or is missing, this is a finding.",
            "FixText": "Navigate to and open /usr/local/horizon/conf/saas-log4j.properties.\n\nConfigure the vIDM policy log file with the following lines:\n\nlog4j.appender.rollingFile=org.apache.log4j.RollingFileAppender\nlog4j.appender.rollingFile.MaxFileSize=50MB\nlog4j.appender.rollingFile.MaxBackupIndex=7\nlog4j.appender.rollingFile.Encoding=UTF-8\nlog4j.appender.rollingFile.file=/opt/vmware/horizon/workspace/logs/horizon.log\nlog4j.appender.rollingFile.append=true\nlog4j.appender.rollingFile.layout=org.apache.log4j.PatternLayout\nlog4j.appender.rollingFile.layout.ConversionPattern=%d{ISO8601} %-5p (%t) [%X{orgId};%X{userId};%X{ip}] %c - %m%n",
            "CCI": "CCI-001312"
        },
        {
            "VulnID": "V-90293",
            "RuleID": "SV-100943r1_rule",
            "StigID": "VRAU-VI-000550",
            "Severity": "high",
            "Cat": "CAT I",
            "Classification": "",
            "GroupTitle": "SRG-APP-000435-AS-000069",
            "RuleTitle": "vIDM, when installed in a MAC I system, must be in a high-availability (HA) cluster.",
            "Description": "<VulnDiscussion>A MAC I system is a system that handles data vital to the organization's operational readiness or effectiveness of deployed or contingency forces. A MAC I system must maintain the highest level of integrity and availability. By HA clustering the application server, the hosted application and data are given a platform that is load-balanced and provided high-availability.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "A MAC I system is a system that handles data vital to the organization's operational readiness or effectiveness of deployed or contingency forces. A MAC I system must maintain the highest level of integrity and availability. By HA clustering the application server, the hosted application and data are given a platform that is load-balanced and provided high-availability.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "If vRA is not installed in a MAC I system, this is Not Applicable.\n\nInterview the ISSO. Obtain the correct configuration for clustering used by the site.\n\nReview the vRealize Automation appliance's installation, environment, and configuration. Determine if vRA clustering has been correctly implemented.\n\nIf vRA is not correctly implementing clustering, this is a finding.",
            "FixText": "If vRA is not installed in a MAC I system, this is Not Applicable.\n\nInterview the ISSO. Obtain the correct configuration for clustering used by the site.\n\nConfigure vRealize Automation to be in compliance with the clustering design provided by the ISSO.",
            "CCI": "CCI-002385"
        },
        {
            "VulnID": "V-90295",
            "RuleID": "SV-100945r1_rule",
            "StigID": "VRAU-VI-000655",
            "Severity": "medium",
            "Cat": "CAT II",
            "Classification": "",
            "GroupTitle": "SRG-APP-000516-AS-000237",
            "RuleTitle": "The vRealize Automation appliance must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.",
            "Description": "<VulnDiscussion>Configuring the vRealize Automation application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. \n\nThe vRA product is continually under refinement, and patches are regularly released to address vulnerabilities. As a result, the vRA STIG is also subject to a release cycle on a quarterly basis.\n\nAssessors should ensure that they are reviewing the vRealize Automation appliance with the most current STIG.</VulnDiscussion><FalsePositives></FalsePositives><FalseNegatives></FalseNegatives><Documentable>false</Documentable><Mitigations></Mitigations><SeverityOverrideGuidance></SeverityOverrideGuidance><PotentialImpacts></PotentialImpacts><ThirdPartyTools></ThirdPartyTools><MitigationControl></MitigationControl><Responsibility></Responsibility><IAControls></IAControls>",
            "VulnDiscussion": "Configuring the vRealize Automation application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. \n\nThe vRA product is continually under refinement, and patches are regularly released to address vulnerabilities. As a result, the vRA STIG is also subject to a release cycle on a quarterly basis.\n\nAssessors should ensure that they are reviewing the vRealize Automation appliance with the most current STIG.",
            "FalsePositives": "",
            "FalseNegatives": "",
            "Documentable": "false",
            "Mitigations": "",
            "SeverityOverrideGuidance": "",
            "PotentialImpacts": "",
            "ThirdPartyTools": "",
            "MitigationControl": "",
            "Responsibility": "",
            "IAControls": "",
            "CheckText": "Obtain the current vRealize Automation STIGs from the ISSO.\n\nVerify that this STIG is the most current STIG available for vRealize Automation. Assess all of the organization's vRA installations to ensure that they are fully compliant with the most current STIG.\n\nIf the most current version of the vRA STIG was not used, or if the vRA appliance configuration is not compliant with the most current STIG, this is a finding.",
            "FixText": "Obtain the most current vRealize Automation STIG. Verify that this vRA appliance is configured with all current requirements.",
            "CCI": "CCI-000366"
        }
    ]
}